{"ast":null,"code":"/*\n * LeapJS Playback - v0.2.1 - 2014-05-14\n * http://github.com/leapmotion/leapjs-playback/\n *\n * Copyright 2014 LeapMotion, Inc\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n;\n\n(function (window, undefined) {\n  'use strict'; // see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions_and_function_scope/Strict_mode\n  // Copyright (c) 2013 Pieroxy <pieroxy@pieroxy.net>\n  // This work is free. You can redistribute it and/or modify it\n  // under the terms of the WTFPL, Version 2\n  // For more information see LICENSE.txt or http://www.wtfpl.net/\n  //\n  // For more information, the home page:\n  // http://pieroxy.net/blog/pages/lz-string/testing.html\n  //\n  // LZ-based compression algorithm, version 1.3.3\n\n  var LZString = {\n    // private property\n    _keyStr: \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\",\n    _f: String.fromCharCode,\n    compressToBase64: function (input) {\n      if (input == null) return \"\";\n      var output = \"\";\n      var chr1, chr2, chr3, enc1, enc2, enc3, enc4;\n      var i = 0;\n      input = LZString.compress(input);\n\n      while (i < input.length * 2) {\n        if (i % 2 == 0) {\n          chr1 = input.charCodeAt(i / 2) >> 8;\n          chr2 = input.charCodeAt(i / 2) & 255;\n          if (i / 2 + 1 < input.length) chr3 = input.charCodeAt(i / 2 + 1) >> 8;else chr3 = NaN;\n        } else {\n          chr1 = input.charCodeAt((i - 1) / 2) & 255;\n\n          if ((i + 1) / 2 < input.length) {\n            chr2 = input.charCodeAt((i + 1) / 2) >> 8;\n            chr3 = input.charCodeAt((i + 1) / 2) & 255;\n          } else chr2 = chr3 = NaN;\n        }\n\n        i += 3;\n        enc1 = chr1 >> 2;\n        enc2 = (chr1 & 3) << 4 | chr2 >> 4;\n        enc3 = (chr2 & 15) << 2 | chr3 >> 6;\n        enc4 = chr3 & 63;\n\n        if (isNaN(chr2)) {\n          enc3 = enc4 = 64;\n        } else if (isNaN(chr3)) {\n          enc4 = 64;\n        }\n\n        output = output + LZString._keyStr.charAt(enc1) + LZString._keyStr.charAt(enc2) + LZString._keyStr.charAt(enc3) + LZString._keyStr.charAt(enc4);\n      }\n\n      return output;\n    },\n    decompressFromBase64: function (input) {\n      if (input == null) return \"\";\n      var output = \"\",\n          ol = 0,\n          output_,\n          chr1,\n          chr2,\n          chr3,\n          enc1,\n          enc2,\n          enc3,\n          enc4,\n          i = 0,\n          f = LZString._f;\n      input = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, \"\");\n\n      while (i < input.length) {\n        enc1 = LZString._keyStr.indexOf(input.charAt(i++));\n        enc2 = LZString._keyStr.indexOf(input.charAt(i++));\n        enc3 = LZString._keyStr.indexOf(input.charAt(i++));\n        enc4 = LZString._keyStr.indexOf(input.charAt(i++));\n        chr1 = enc1 << 2 | enc2 >> 4;\n        chr2 = (enc2 & 15) << 4 | enc3 >> 2;\n        chr3 = (enc3 & 3) << 6 | enc4;\n\n        if (ol % 2 == 0) {\n          output_ = chr1 << 8;\n\n          if (enc3 != 64) {\n            output += f(output_ | chr2);\n          }\n\n          if (enc4 != 64) {\n            output_ = chr3 << 8;\n          }\n        } else {\n          output = output + f(output_ | chr1);\n\n          if (enc3 != 64) {\n            output_ = chr2 << 8;\n          }\n\n          if (enc4 != 64) {\n            output += f(output_ | chr3);\n          }\n        }\n\n        ol += 3;\n      }\n\n      return LZString.decompress(output);\n    },\n    compressToUTF16: function (input) {\n      if (input == null) return \"\";\n      var output = \"\",\n          i,\n          c,\n          current,\n          status = 0,\n          f = LZString._f;\n      input = LZString.compress(input);\n\n      for (i = 0; i < input.length; i++) {\n        c = input.charCodeAt(i);\n\n        switch (status++) {\n          case 0:\n            output += f((c >> 1) + 32);\n            current = (c & 1) << 14;\n            break;\n\n          case 1:\n            output += f(current + (c >> 2) + 32);\n            current = (c & 3) << 13;\n            break;\n\n          case 2:\n            output += f(current + (c >> 3) + 32);\n            current = (c & 7) << 12;\n            break;\n\n          case 3:\n            output += f(current + (c >> 4) + 32);\n            current = (c & 15) << 11;\n            break;\n\n          case 4:\n            output += f(current + (c >> 5) + 32);\n            current = (c & 31) << 10;\n            break;\n\n          case 5:\n            output += f(current + (c >> 6) + 32);\n            current = (c & 63) << 9;\n            break;\n\n          case 6:\n            output += f(current + (c >> 7) + 32);\n            current = (c & 127) << 8;\n            break;\n\n          case 7:\n            output += f(current + (c >> 8) + 32);\n            current = (c & 255) << 7;\n            break;\n\n          case 8:\n            output += f(current + (c >> 9) + 32);\n            current = (c & 511) << 6;\n            break;\n\n          case 9:\n            output += f(current + (c >> 10) + 32);\n            current = (c & 1023) << 5;\n            break;\n\n          case 10:\n            output += f(current + (c >> 11) + 32);\n            current = (c & 2047) << 4;\n            break;\n\n          case 11:\n            output += f(current + (c >> 12) + 32);\n            current = (c & 4095) << 3;\n            break;\n\n          case 12:\n            output += f(current + (c >> 13) + 32);\n            current = (c & 8191) << 2;\n            break;\n\n          case 13:\n            output += f(current + (c >> 14) + 32);\n            current = (c & 16383) << 1;\n            break;\n\n          case 14:\n            output += f(current + (c >> 15) + 32, (c & 32767) + 32);\n            status = 0;\n            break;\n        }\n      }\n\n      return output + f(current + 32);\n    },\n    decompressFromUTF16: function (input) {\n      if (input == null) return \"\";\n      var output = \"\",\n          current,\n          c,\n          status = 0,\n          i = 0,\n          f = LZString._f;\n\n      while (i < input.length) {\n        c = input.charCodeAt(i) - 32;\n\n        switch (status++) {\n          case 0:\n            current = c << 1;\n            break;\n\n          case 1:\n            output += f(current | c >> 14);\n            current = (c & 16383) << 2;\n            break;\n\n          case 2:\n            output += f(current | c >> 13);\n            current = (c & 8191) << 3;\n            break;\n\n          case 3:\n            output += f(current | c >> 12);\n            current = (c & 4095) << 4;\n            break;\n\n          case 4:\n            output += f(current | c >> 11);\n            current = (c & 2047) << 5;\n            break;\n\n          case 5:\n            output += f(current | c >> 10);\n            current = (c & 1023) << 6;\n            break;\n\n          case 6:\n            output += f(current | c >> 9);\n            current = (c & 511) << 7;\n            break;\n\n          case 7:\n            output += f(current | c >> 8);\n            current = (c & 255) << 8;\n            break;\n\n          case 8:\n            output += f(current | c >> 7);\n            current = (c & 127) << 9;\n            break;\n\n          case 9:\n            output += f(current | c >> 6);\n            current = (c & 63) << 10;\n            break;\n\n          case 10:\n            output += f(current | c >> 5);\n            current = (c & 31) << 11;\n            break;\n\n          case 11:\n            output += f(current | c >> 4);\n            current = (c & 15) << 12;\n            break;\n\n          case 12:\n            output += f(current | c >> 3);\n            current = (c & 7) << 13;\n            break;\n\n          case 13:\n            output += f(current | c >> 2);\n            current = (c & 3) << 14;\n            break;\n\n          case 14:\n            output += f(current | c >> 1);\n            current = (c & 1) << 15;\n            break;\n\n          case 15:\n            output += f(current | c);\n            status = 0;\n            break;\n        }\n\n        i++;\n      }\n\n      return LZString.decompress(output); //return output;\n    },\n    compress: function (uncompressed) {\n      if (uncompressed == null) return \"\";\n      var i,\n          value,\n          context_dictionary = {},\n          context_dictionaryToCreate = {},\n          context_c = \"\",\n          context_wc = \"\",\n          context_w = \"\",\n          context_enlargeIn = 2,\n          // Compensate for the first entry which should not count\n      context_dictSize = 3,\n          context_numBits = 2,\n          context_data_string = \"\",\n          context_data_val = 0,\n          context_data_position = 0,\n          ii,\n          f = LZString._f;\n\n      for (ii = 0; ii < uncompressed.length; ii += 1) {\n        context_c = uncompressed.charAt(ii);\n\n        if (!Object.prototype.hasOwnProperty.call(context_dictionary, context_c)) {\n          context_dictionary[context_c] = context_dictSize++;\n          context_dictionaryToCreate[context_c] = true;\n        }\n\n        context_wc = context_w + context_c;\n\n        if (Object.prototype.hasOwnProperty.call(context_dictionary, context_wc)) {\n          context_w = context_wc;\n        } else {\n          if (Object.prototype.hasOwnProperty.call(context_dictionaryToCreate, context_w)) {\n            if (context_w.charCodeAt(0) < 256) {\n              for (i = 0; i < context_numBits; i++) {\n                context_data_val = context_data_val << 1;\n\n                if (context_data_position == 15) {\n                  context_data_position = 0;\n                  context_data_string += f(context_data_val);\n                  context_data_val = 0;\n                } else {\n                  context_data_position++;\n                }\n              }\n\n              value = context_w.charCodeAt(0);\n\n              for (i = 0; i < 8; i++) {\n                context_data_val = context_data_val << 1 | value & 1;\n\n                if (context_data_position == 15) {\n                  context_data_position = 0;\n                  context_data_string += f(context_data_val);\n                  context_data_val = 0;\n                } else {\n                  context_data_position++;\n                }\n\n                value = value >> 1;\n              }\n            } else {\n              value = 1;\n\n              for (i = 0; i < context_numBits; i++) {\n                context_data_val = context_data_val << 1 | value;\n\n                if (context_data_position == 15) {\n                  context_data_position = 0;\n                  context_data_string += f(context_data_val);\n                  context_data_val = 0;\n                } else {\n                  context_data_position++;\n                }\n\n                value = 0;\n              }\n\n              value = context_w.charCodeAt(0);\n\n              for (i = 0; i < 16; i++) {\n                context_data_val = context_data_val << 1 | value & 1;\n\n                if (context_data_position == 15) {\n                  context_data_position = 0;\n                  context_data_string += f(context_data_val);\n                  context_data_val = 0;\n                } else {\n                  context_data_position++;\n                }\n\n                value = value >> 1;\n              }\n            }\n\n            context_enlargeIn--;\n\n            if (context_enlargeIn == 0) {\n              context_enlargeIn = Math.pow(2, context_numBits);\n              context_numBits++;\n            }\n\n            delete context_dictionaryToCreate[context_w];\n          } else {\n            value = context_dictionary[context_w];\n\n            for (i = 0; i < context_numBits; i++) {\n              context_data_val = context_data_val << 1 | value & 1;\n\n              if (context_data_position == 15) {\n                context_data_position = 0;\n                context_data_string += f(context_data_val);\n                context_data_val = 0;\n              } else {\n                context_data_position++;\n              }\n\n              value = value >> 1;\n            }\n          }\n\n          context_enlargeIn--;\n\n          if (context_enlargeIn == 0) {\n            context_enlargeIn = Math.pow(2, context_numBits);\n            context_numBits++;\n          } // Add wc to the dictionary.\n\n\n          context_dictionary[context_wc] = context_dictSize++;\n          context_w = String(context_c);\n        }\n      } // Output the code for w.\n\n\n      if (context_w !== \"\") {\n        if (Object.prototype.hasOwnProperty.call(context_dictionaryToCreate, context_w)) {\n          if (context_w.charCodeAt(0) < 256) {\n            for (i = 0; i < context_numBits; i++) {\n              context_data_val = context_data_val << 1;\n\n              if (context_data_position == 15) {\n                context_data_position = 0;\n                context_data_string += f(context_data_val);\n                context_data_val = 0;\n              } else {\n                context_data_position++;\n              }\n            }\n\n            value = context_w.charCodeAt(0);\n\n            for (i = 0; i < 8; i++) {\n              context_data_val = context_data_val << 1 | value & 1;\n\n              if (context_data_position == 15) {\n                context_data_position = 0;\n                context_data_string += f(context_data_val);\n                context_data_val = 0;\n              } else {\n                context_data_position++;\n              }\n\n              value = value >> 1;\n            }\n          } else {\n            value = 1;\n\n            for (i = 0; i < context_numBits; i++) {\n              context_data_val = context_data_val << 1 | value;\n\n              if (context_data_position == 15) {\n                context_data_position = 0;\n                context_data_string += f(context_data_val);\n                context_data_val = 0;\n              } else {\n                context_data_position++;\n              }\n\n              value = 0;\n            }\n\n            value = context_w.charCodeAt(0);\n\n            for (i = 0; i < 16; i++) {\n              context_data_val = context_data_val << 1 | value & 1;\n\n              if (context_data_position == 15) {\n                context_data_position = 0;\n                context_data_string += f(context_data_val);\n                context_data_val = 0;\n              } else {\n                context_data_position++;\n              }\n\n              value = value >> 1;\n            }\n          }\n\n          context_enlargeIn--;\n\n          if (context_enlargeIn == 0) {\n            context_enlargeIn = Math.pow(2, context_numBits);\n            context_numBits++;\n          }\n\n          delete context_dictionaryToCreate[context_w];\n        } else {\n          value = context_dictionary[context_w];\n\n          for (i = 0; i < context_numBits; i++) {\n            context_data_val = context_data_val << 1 | value & 1;\n\n            if (context_data_position == 15) {\n              context_data_position = 0;\n              context_data_string += f(context_data_val);\n              context_data_val = 0;\n            } else {\n              context_data_position++;\n            }\n\n            value = value >> 1;\n          }\n        }\n\n        context_enlargeIn--;\n\n        if (context_enlargeIn == 0) {\n          context_enlargeIn = Math.pow(2, context_numBits);\n          context_numBits++;\n        }\n      } // Mark the end of the stream\n\n\n      value = 2;\n\n      for (i = 0; i < context_numBits; i++) {\n        context_data_val = context_data_val << 1 | value & 1;\n\n        if (context_data_position == 15) {\n          context_data_position = 0;\n          context_data_string += f(context_data_val);\n          context_data_val = 0;\n        } else {\n          context_data_position++;\n        }\n\n        value = value >> 1;\n      } // Flush the last char\n\n\n      while (true) {\n        context_data_val = context_data_val << 1;\n\n        if (context_data_position == 15) {\n          context_data_string += f(context_data_val);\n          break;\n        } else context_data_position++;\n      }\n\n      return context_data_string;\n    },\n    decompress: function (compressed) {\n      if (compressed == null) return \"\";\n      if (compressed == \"\") return null;\n      var dictionary = [],\n          next,\n          enlargeIn = 4,\n          dictSize = 4,\n          numBits = 3,\n          entry = \"\",\n          result = \"\",\n          i,\n          w,\n          bits,\n          resb,\n          maxpower,\n          power,\n          c,\n          f = LZString._f,\n          data = {\n        string: compressed,\n        val: compressed.charCodeAt(0),\n        position: 32768,\n        index: 1\n      };\n\n      for (i = 0; i < 3; i += 1) {\n        dictionary[i] = i;\n      }\n\n      bits = 0;\n      maxpower = Math.pow(2, 2);\n      power = 1;\n\n      while (power != maxpower) {\n        resb = data.val & data.position;\n        data.position >>= 1;\n\n        if (data.position == 0) {\n          data.position = 32768;\n          data.val = data.string.charCodeAt(data.index++);\n        }\n\n        bits |= (resb > 0 ? 1 : 0) * power;\n        power <<= 1;\n      }\n\n      switch (next = bits) {\n        case 0:\n          bits = 0;\n          maxpower = Math.pow(2, 8);\n          power = 1;\n\n          while (power != maxpower) {\n            resb = data.val & data.position;\n            data.position >>= 1;\n\n            if (data.position == 0) {\n              data.position = 32768;\n              data.val = data.string.charCodeAt(data.index++);\n            }\n\n            bits |= (resb > 0 ? 1 : 0) * power;\n            power <<= 1;\n          }\n\n          c = f(bits);\n          break;\n\n        case 1:\n          bits = 0;\n          maxpower = Math.pow(2, 16);\n          power = 1;\n\n          while (power != maxpower) {\n            resb = data.val & data.position;\n            data.position >>= 1;\n\n            if (data.position == 0) {\n              data.position = 32768;\n              data.val = data.string.charCodeAt(data.index++);\n            }\n\n            bits |= (resb > 0 ? 1 : 0) * power;\n            power <<= 1;\n          }\n\n          c = f(bits);\n          break;\n\n        case 2:\n          return \"\";\n      }\n\n      dictionary[3] = c;\n      w = result = c;\n\n      while (true) {\n        if (data.index > data.string.length) {\n          return \"\";\n        }\n\n        bits = 0;\n        maxpower = Math.pow(2, numBits);\n        power = 1;\n\n        while (power != maxpower) {\n          resb = data.val & data.position;\n          data.position >>= 1;\n\n          if (data.position == 0) {\n            data.position = 32768;\n            data.val = data.string.charCodeAt(data.index++);\n          }\n\n          bits |= (resb > 0 ? 1 : 0) * power;\n          power <<= 1;\n        }\n\n        switch (c = bits) {\n          case 0:\n            bits = 0;\n            maxpower = Math.pow(2, 8);\n            power = 1;\n\n            while (power != maxpower) {\n              resb = data.val & data.position;\n              data.position >>= 1;\n\n              if (data.position == 0) {\n                data.position = 32768;\n                data.val = data.string.charCodeAt(data.index++);\n              }\n\n              bits |= (resb > 0 ? 1 : 0) * power;\n              power <<= 1;\n            }\n\n            dictionary[dictSize++] = f(bits);\n            c = dictSize - 1;\n            enlargeIn--;\n            break;\n\n          case 1:\n            bits = 0;\n            maxpower = Math.pow(2, 16);\n            power = 1;\n\n            while (power != maxpower) {\n              resb = data.val & data.position;\n              data.position >>= 1;\n\n              if (data.position == 0) {\n                data.position = 32768;\n                data.val = data.string.charCodeAt(data.index++);\n              }\n\n              bits |= (resb > 0 ? 1 : 0) * power;\n              power <<= 1;\n            }\n\n            dictionary[dictSize++] = f(bits);\n            c = dictSize - 1;\n            enlargeIn--;\n            break;\n\n          case 2:\n            return result;\n        }\n\n        if (enlargeIn == 0) {\n          enlargeIn = Math.pow(2, numBits);\n          numBits++;\n        }\n\n        if (dictionary[c]) {\n          entry = dictionary[c];\n        } else {\n          if (c === dictSize) {\n            entry = w + w.charAt(0);\n          } else {\n            return null;\n          }\n        }\n\n        result += entry; // Add w+entry[0] to the dictionary.\n\n        dictionary[dictSize++] = w + entry.charAt(0);\n        enlargeIn--;\n        w = entry;\n\n        if (enlargeIn == 0) {\n          enlargeIn = Math.pow(2, numBits);\n          numBits++;\n        }\n      }\n    }\n  };\n\n  if (typeof module !== 'undefined' && module != null) {\n    module.exports = LZString;\n  } // https://gist.github.com/paulirish/5438650\n  // relies on Date.now() which has been supported everywhere modern for years.\n  // as Safari 6 doesn't have support for NavigationTiming, we use a Date.now() timestamp for relative values\n  // if you want values similar to what you'd get with real perf.now, place this towards the head of the page\n  // but in reality, you're just getting the delta between now() calls, so it's not terribly important where it's placed\n\n\n  (function () {\n    // prepare base perf object\n    if (typeof window.performance === 'undefined') {\n      window.performance = {};\n    }\n\n    if (!window.performance.now) {\n      var nowOffset = Date.now();\n\n      if (performance.timing && performance.timing.navigationStart) {\n        nowOffset = performance.timing.navigationStart;\n      }\n\n      window.performance.now = function now() {\n        return Date.now() - nowOffset;\n      };\n    }\n  })();\n\n  function Recording(options) {\n    this.options = options || (options = {});\n    this.loading = false;\n    this.timeBetweenLoops = options.timeBetweenLoops || 50; // see https://github.com/leapmotion/leapjs/blob/master/Leap_JSON.rst\n\n    this.packingStructure = ['id', 'timestamp', // this should be replace/upgraded with a whitelist instead of a blacklist.\n    // leaving out r,s,y, and gestures\n    {\n      hands: [['id', 'type', 'direction', 'palmNormal', 'palmPosition', 'palmVelocity', 'stabilizedPalmPosition', 'pinchStrength', 'grabStrength', 'confidence', 'armBasis', 'armWidth', 'elbow', 'wrist' // leaving out r, s, t, sphereCenter, sphereRadius\n      ]]\n    }, {\n      pointables: [['id', 'direction', 'handId', 'length', 'stabilizedTipPosition', 'tipPosition', 'tipVelocity', 'tool', 'carpPosition', 'mcpPosition', 'pipPosition', 'dipPosition', 'btipPosition', 'bases', 'type' // leaving out touchDistance, touchZone\n      ]]\n    }, {\n      interactionBox: ['center', 'size']\n    }];\n    this.setFrames(options.frames || []);\n  }\n\n  Recording.prototype = {\n    setFrames: function (frames) {\n      this.frameData = frames;\n      this.frameIndex = 0;\n      this.frameCount = frames.length;\n      this.leftCropPosition = 0;\n      this.rightCropPosition = this.frameCount;\n      this.setMetaData();\n    },\n    addFrame: function (frameData) {\n      this.frameData.push(frameData);\n    },\n    currentFrame: function () {\n      return this.frameData[this.frameIndex];\n    },\n    nextFrame: function () {\n      var frameIndex = this.frameIndex + 1; // || 1 to prevent `mod 0` error when finishing recording before setFrames has been called.\n\n      frameIndex = frameIndex % (this.rightCropPosition || 1);\n\n      if (frameIndex < this.leftCropPosition) {\n        frameIndex = this.leftCropPosition;\n      }\n\n      return this.frameData[frameIndex];\n    },\n    advanceFrame: function () {\n      this.frameIndex++;\n\n      if (this.frameIndex >= this.rightCropPosition && !this.options.loop) {\n        this.frameIndex--; // there is currently an issue where angular watching the right handle position\n        // will cause this to fire prematurely\n        // when switching to an earlier recording\n\n        return false;\n      }\n\n      this.frameIndex = this.frameIndex % (this.rightCropPosition || 1);\n\n      if (this.frameIndex < this.leftCropPosition) {\n        this.frameIndex = this.leftCropPosition;\n      }\n\n      return true;\n    },\n    // resets to beginning if at end\n    readyPlay: function () {\n      this.frameIndex++;\n\n      if (this.frameIndex >= this.rightCropPosition) {\n        this.frameIndex = this.frameIndex % (this.rightCropPosition || 1);\n\n        if (this.frameIndex < this.leftCropPosition) {\n          this.frameIndex = this.leftCropPosition;\n        }\n      } else {\n        this.frameIndex--;\n      }\n    },\n    cloneCurrentFrame: function () {\n      return JSON.parse(JSON.stringify(this.currentFrame()));\n    },\n    // this method would be well-moved to its own object/class -.-\n    // for every point, lerp as appropriate\n    // note: currently hand and finger props are hard coded, but things like stabilizedPalmPosition should be optional\n    // should have this be set from the packingStructure or some such, but only for vec3s.\n    createLerpFrameData: function (t) {\n      // http://stackoverflow.com/a/5344074/478354\n      var currentFrame = this.currentFrame(),\n          nextFrame = this.nextFrame(),\n          handProps = ['palmPosition', 'stabilizedPalmPosition', 'sphereCenter', 'direction', 'palmNormal', 'palmVelocity'],\n          fingerProps = ['mcpPosition', 'pipPosition', 'dipPosition', 'tipPosition', 'direction'],\n          frameData = this.cloneCurrentFrame(),\n          numHands = frameData.hands.length,\n          numPointables = frameData.pointables.length,\n          len1 = handProps.length,\n          len2 = fingerProps.length,\n          prop,\n          hand,\n          pointable;\n\n      for (var i = 0; i < numHands; i++) {\n        hand = frameData.hands[i];\n\n        for (var j = 0; j < len1; j++) {\n          prop = handProps[j];\n\n          if (!currentFrame.hands[i][prop]) {\n            continue;\n          }\n\n          if (!nextFrame.hands[i]) {\n            continue;\n          }\n\n          Leap.vec3.lerp(hand[prop], currentFrame.hands[i][prop], nextFrame.hands[i][prop], t); //        console.assert(hand[prop]);\n        }\n      }\n\n      for (i = 0; i < numPointables; i++) {\n        pointable = frameData.pointables[i];\n\n        for (j = 0; j < len2; j++) {\n          prop = fingerProps[j];\n\n          if (!currentFrame.pointables[i][prop]) {\n            continue;\n          }\n\n          if (!nextFrame.hands[i]) {\n            continue;\n          }\n\n          Leap.vec3.lerp(pointable[prop], currentFrame.pointables[i][prop], nextFrame.pointables[i][prop], 0); //          console.assert(t >= 0 && t <= 1);\n          //          if (t > 0) debugger;\n        }\n      }\n\n      return frameData;\n    },\n    // returns ms\n    timeToNextFrame: function () {\n      var elapsedTime = (this.nextFrame().timestamp - this.currentFrame().timestamp) / 1000;\n\n      if (elapsedTime < 0) {\n        elapsedTime = this.timeBetweenLoops; //arbitrary pause at slightly less than 30 fps.\n      } //    console.assert(!isNaN(elapsedTime));\n\n\n      return elapsedTime;\n    },\n    blank: function () {\n      return this.frameData.length === 0;\n    },\n    // sets the crop-point of the current recording to the current position.\n    leftCrop: function () {\n      this.leftCropPosition = this.frameIndex;\n    },\n    // sets the crop-point of the current recording to the current position.\n    rightCrop: function () {\n      this.rightCropPosition = this.frameIndex;\n    },\n    // removes every other frame from the array\n    // Accepts an optional `factor` integer, which is the number of frames\n    // discarded for every frame kept.\n    cullFrames: function (factor) {\n      console.log('cull frames', factor);\n      factor || (factor = 1);\n\n      for (var i = 0; i < this.frameData.length; i++) {\n        this.frameData.splice(i, factor);\n      }\n\n      this.setMetaData();\n    },\n    // Returns the average frames per second of the recording\n    frameRate: function () {\n      if (this.frameData.length == 0) {\n        return 0;\n      }\n\n      return this.frameData.length / (this.frameData[this.frameData.length - 1].timestamp - this.frameData[0].timestamp) * 1000000;\n    },\n    // returns frames without any circular references\n    croppedFrameData: function () {\n      return this.frameData.slice(this.leftCropPosition, this.rightCropPosition);\n    },\n    setMetaData: function () {\n      var newMetaData = {\n        formatVersion: 2,\n        generatedBy: 'LeapJS Playback 0.2.0',\n        frames: this.rightCropPosition - this.leftCropPosition,\n        protocolVersion: this.options.requestProtocolVersion,\n        serviceVersion: this.options.serviceVersion,\n        frameRate: this.frameRate().toPrecision(2),\n        modified: new Date().toString()\n      };\n      this.metadata || (this.metadata = {});\n\n      for (var key in newMetaData) {\n        this.metadata[key] = newMetaData[key];\n      }\n    },\n    // returns an array\n    // the first item is the keys of the following items\n    // nested arrays are expected to have idententical siblings\n    packedFrameData: function () {\n      var frameData = this.croppedFrameData(),\n          packedFrames = [],\n          frameDatum;\n      packedFrames.push(this.packingStructure);\n\n      for (var i = 0, len = frameData.length; i < len; i++) {\n        frameDatum = frameData[i];\n        packedFrames.push(this.packArray(this.packingStructure, frameDatum));\n      }\n\n      return packedFrames;\n    },\n    // recursive method\n    // creates a structure of frame data matching packing structure\n    // there may be an issue here where hands/pointables are wrapped in one more array than necessary\n    packArray: function (structure, data) {\n      var out = [],\n          nameOrHash;\n\n      for (var i = 0, len1 = structure.length; i < len1; i++) {\n        // e.g., nameOrHash is either 'id' or {hand: [...]}\n        nameOrHash = structure[i];\n\n        if (typeof nameOrHash === 'string') {\n          out.push(data[nameOrHash]);\n        } else if (Object.prototype.toString.call(nameOrHash) == \"[object Array]\") {\n          // nested array, such as hands or fingers\n          for (var j = 0, len2 = data.length; j < len2; j++) {\n            out.push(this.packArray(nameOrHash, data[j]));\n          }\n        } else {\n          // key-value (nested object) such as interactionBox\n          //        console.assert(nameOrHash);\n          for (var key in nameOrHash) break; //        console.assert(key);\n          //        console.assert(nameOrHash[key]);\n          //        console.assert(data[key]);\n\n\n          out.push(this.packArray(nameOrHash[key], data[key]));\n        }\n      }\n\n      return out;\n    },\n    // expects the first array element to describe the following arrays\n    // this algorithm copies frames to a new array\n    // could there be merit in something which would do an in-place substitution?\n    unPackFrameData: function (packedFrames) {\n      var packingStructure = packedFrames[0];\n      var frameData = [],\n          frameDatum;\n\n      for (var i = 1, len = packedFrames.length; i < len; i++) {\n        frameDatum = packedFrames[i];\n        frameData.push(this.unPackArray(packingStructure, frameDatum));\n      }\n\n      return frameData;\n    },\n    // data is a frame or subset of frame\n    // returns a frame object\n    // this is the structure of the array\n    // gets unfolded to key-value pairs\n    // e.g.:\n    //  this.packingStructure = [\n    //    'id',\n    //    'timestamp',\n    //    {hands: [[\n    //      'id',\n    //      'direction',\n    //      'palmNormal',\n    //      'palmPosition',\n    //      'palmVelocity'\n    //    ]]},\n    //    {pointables: [[\n    //      'direction',\n    //      'handId',\n    //      'length',\n    //      'stabilizedTipPosition',\n    //      'tipPosition',\n    //      'tipVelocity',\n    //      'tool'\n    //    ]]},\n    //    {interactionBox: [\n    //      'center', 'size'\n    //    ]}\n    //  ];\n    unPackArray: function (structure, data) {\n      var out = {},\n          nameOrHash;\n\n      for (var i = 0, len1 = structure.length; i < len1; i++) {\n        // e.g., nameOrHash is either 'id' or {hand: [...]}\n        nameOrHash = structure[i];\n\n        if (typeof nameOrHash === 'string') {\n          out[nameOrHash] = data[i];\n        } else if (Object.prototype.toString.call(nameOrHash) == \"[object Array]\") {\n          // nested array, such as hands or fingers\n          // nameOrHash [\"id\", \"direction\", \"palmNormal\", \"palmPosition\", \"palmVelocity\"]\n          // data [ [ 31, [vec3], [vec3], ...] ]\n          var subArray = [];\n\n          for (var j = 0, len2 = data.length; j < len2; j++) {\n            subArray.push(this.unPackArray(nameOrHash, data[j]));\n          }\n\n          return subArray;\n        } else {\n          // key-value (nested object) such as interactionBox\n          for (var key in nameOrHash) break;\n\n          out[key] = this.unPackArray(nameOrHash[key], data[i]);\n        }\n      }\n\n      return out;\n    },\n    toHash: function () {\n      this.setMetaData();\n      return {\n        metadata: this.metadata,\n        frames: this.packedFrameData()\n      };\n    },\n    // Returns the cropped data as JSON or compressed\n    // http://pieroxy.net/blog/pages/lz-string/index.html\n    export: function (format) {\n      var json = JSON.stringify(this.toHash());\n      if (format == 'json') return json;\n      return LZString.compressToBase64(json);\n    },\n    save: function (format) {\n      var filename;\n      filename = this.metadata.title ? this.metadata.title.replace(/\\s/g, '') : 'leap-playback-recording';\n\n      if (this.metadata.frameRate) {\n        filename += \"-\" + Math.round(this.metadata.frameRate) + \"fps\";\n      }\n\n      if (format === 'json') {\n        saveAs(new Blob([this.export('json')], {\n          type: \"text/JSON;charset=utf-8\"\n        }), filename + \".json\");\n      } else {\n        saveAs(new Blob([this.export('lz')], {\n          type: \"application/x-gzip;charset=utf-8\"\n        }), filename + \".json.lz\");\n      }\n    },\n    decompress: function (data) {\n      return LZString.decompressFromBase64(data);\n    },\n    loaded: function () {\n      return !!(this.frameData && this.frameData.length);\n    },\n    // optional callback once frames are loaded, will have a context of player\n    loadFrameData: function (callback) {\n      var xhr = new XMLHttpRequest(),\n          url = this.url,\n          recording = this,\n          contentLength = 0;\n\n      xhr.onreadystatechange = function () {\n        if (xhr.readyState === xhr.DONE) {\n          if (xhr.status === 200 || xhr.status === 0) {\n            if (xhr.responseText) {\n              recording.finishLoad(xhr.responseText, callback);\n            } else {\n              console.error('Leap Playback: \"' + url + '\" seems to be unreachable or the file is empty.');\n            }\n          } else {\n            console.error('Leap Playback: Couldn\\'t load \"' + url + '\" (' + xhr.status + ')');\n          }\n        }\n      };\n\n      xhr.addEventListener('progress', function (oEvent) {\n        if (recording.options.loadProgress) {\n          if (oEvent.lengthComputable) {\n            var percentComplete = oEvent.loaded / oEvent.total;\n            recording.options.loadProgress(recording, percentComplete, oEvent);\n          }\n        }\n      });\n      this.loading = true;\n      xhr.open(\"GET\", url, true);\n      xhr.send(null);\n    },\n    finishLoad: function (responseData, callback) {\n      var url = this.url;\n\n      if (url.split('.')[url.split('.').length - 1] == 'lz') {\n        responseData = this.decompress(responseData);\n      }\n\n      responseData = JSON.parse(responseData);\n\n      if (responseData.metadata.formatVersion == 2) {\n        responseData.frames = this.unPackFrameData(responseData.frames);\n      }\n\n      this.metadata = responseData.metadata;\n      console.log('Recording loaded:', this.metadata);\n      this.loading = false;\n\n      if (callback) {\n        callback.call(this, responseData.frames);\n      }\n    },\n    loadCompressedRecording: function (compressedData, callback) {\n      var decompressedData = this.decompress(compressedData);\n      decompressedData = JSON.parse(decompressedData);\n\n      if (decompressedData.metadata.formatVersion == 2) {\n        decompressedData.frames = this.unPackFrameData(decompressedData.frames);\n      }\n\n      this.metadata = decompressedData.metadata;\n      console.log('Recording loaded:', this.metadata);\n      this.loading = false;\n\n      if (callback) {\n        callback.call(this, decompressedData.frames);\n      }\n    }\n  };\n  (function () {\n    var CONNECT_LEAP_ICON = '<img class=\"playback-connect-leap\" style=\"margin: 0px 2px -2px 0px; max-width: 100%;\" src=\"data:image/gif;base64,R0lGODlh9AHmAPf/AOnxtbS0tc3eVTMzNM3NztvnhtbX1/Hy86ioqezs7Z6entzd3r7UJdHhZcnKzOjo6sXZO319fkJCQurq6xMTFPj65q2treHh4vT42uXl5/Lz9JCQkfP09FxcXebm54yMjsvMzSgoKdfleLGxsUtLTPDx8cHCwlNTVSIiI6CgoYSEhAUFBpmZmtHS1Li5ucHDxNHR0err7HZ2duDrl8XFxvP09vv98/Dx8trb3MjIyN7e3x4eHmZmZj4+PrzTHtDQ0uvs7dra2uzt7ZWVldfY2cPExtbX2AsLDImJiff4+MbHysjIyoCBgsXGyHp6er6+vsDVKm5ucOTk5XFxc83O0MbGx2FhYm1tbsDWLKWlpu70xRkZGkVFRtPU1pydoM/Q0bKztKamqCQkJeLi5O/w8Glpab/AwtjY2f7+/WtrbcfIytjZ26qrrDc4OdHS0nBxc7/VJ5KTlI6Oj9LS0/v8/b7UI3JzdMPDxIqKi5aWl7y9vi4uL8fHx3BwcNvc3pKSk62usCsrLN/f4Ly8vZydnp2dndXV1snJycXGym5vcefn6IuMjYWFhYODhiMjJCYmJ+fo6UhISR8fH/7+/hsbHP39/ejo6cHWLu/v8Lq7vPv7++nq6+3u7q+wsby9wL6/wvj4+Pz8/Pr6+vLy8+bn6O7u7vj4+e3u7/f3+PT19fn5+ff39/T09Pb29+jo6MHWL/b29vLy8vT09e7v8L2+v/Pz9O7u7/39/vHy9L2+wbi6ve/v7+no6fz9/fn6+vj5+fv7/Pr7+////v7//8XGx/X19vX29vb39+7v7/z8/enp6uPk5fr6+/n5+g8PENTU1Hh4eYeHh05OT+fo6JGSk0BAQOTl6CAgIS8vML+/wHNzc5eYmLa3t+Xm54OEhfn4+Y+PkFdXV1hZWv3++IiIiJGRkZubm3t8ff7+/35/gOjp6ru8vmRkZMTFyLO0tWJiY6eoqycnKGxsbkNDQ77TIl5eX6Kjo+Xm6QcHBwgICZSUlvLz8y0tLv///wAAAP///yH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4zLWMwMTEgNjYuMTQ1NjYxLCAyMDEyLzAyLzA2LTE0OjU2OjI3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M2IChNYWNpbnRvc2gpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjQyMUExNDAzQjE2NzExRTNBMUE1RTA3Qjc0NDg0NDMxIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjQyMUExNDA0QjE2NzExRTNBMUE1RTA3Qjc0NDg0NDMxIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NDIxQTE0MDFCMTY3MTFFM0ExQTVFMDdCNzQ0ODQ0MzEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NDIxQTE0MDJCMTY3MTFFM0ExQTVFMDdCNzQ0ODQ0MzEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4B//79/Pv6+fj39vX08/Lx8O/u7ezr6uno5+bl5OPi4eDf3t3c29rZ2NfW1dTT0tHQz87NzMvKycjHxsXEw8LBwL++vby7urm4t7a1tLOysbCvrq2sq6qpqKempaSjoqGgn56dnJuamZiXlpWUk5KRkI+OjYyLiomIh4aFhIOCgYB/fn18e3p5eHd2dXRzcnFwb25tbGtqaWhnZmVkY2JhYF9eXVxbWllYV1ZVVFNSUVBPTk1MS0pJSEdGRURDQkFAPz49PDs6OTg3NjU0MzIxMC8uLSwrKikoJyYlJCMi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\">';\n    var MOVE_HAND_OVER_LEAP_ICON = '<img class=\"playback-move-hand\" style=\"margin: 0px 2px -2px 0px; max-width: 100%;\" src=\"data:image/gif;base64,R0lGODlh9AHtAPf/AJ2dnfT09KWlpZWVlejo6bGxsRwcHHl5eYmJiRMTFOrq66GhoYWFhcHCxObm54GBgdjY2GFhYcXGydPT0+Dg4OPj4319fQsLC0ZGRuTk5GlpaVVVVV5eXpGRkXFxcd7e3kFBQXV1ddbW1lJSUsDAwNvb221tbk1OTgMDAykpKaurqzw9PdTU1FlZWdzc3JiYmMjKzLu7u8jIyJubnPLy9M7Ozr2/wUlJSTo6OsLCwmRkZDY2NtDQ0DIyMr29vaytsKysrC4uLra2ttHS1CUlJtXX2MrKy6+vr5qamiEhIczMzM3O0LS0tMTExMbGxsbIyt7e4I2Njby8vOTl5qioqMPEx+rr7KqqrOjo6np6fNTV17i4uMzNzo+Pj3Z3ePHx8rm7veDh4uzt7r/AwoeHh8PDxM/Q0sTFx42OkMDBw+fo6bW3utjZ2vHy8tHR0sjJyru8v+Xl5d3d3dzc3mNjZJ+fn2pra+np6t/f4OLj5NPT1V9fYFdXV8HCxsDBxbO0tq6vsqqsrk9PT0tLS5KTlGdnZ4uMjn1+gHd4e1JTUzs7PEJCQzMzMysrK+fn6P7+/v////39/fPz8+7u7/z8/Pv7+/f39/b29vr6+vj4+Pn5+e7u7vLy8u/v7+3t7ezs7PDw8Ozs7fHx8fDw8fb29/Ly8/X19fr6+/z8/fn5+tvc3e/v8HNzdKmpqvf3+CMjJPDx8fP09OPk5ZmZmvj5+Xt8flBQUP39/mtsbvLz8+/w8Nra3NXW15+govr7+x8fH7m5uicnJ+fn6ezt7Zqcn7Kzs7S0s1hYWLe4uvz9/aanqq2trf3+/ouLi2NkZqOjo5aXmqKkppeYmmBgYPv7/JSVl4ODg4eHihcXFw8PD/7//9HS0kBAQOHh4mhoa0RERDAwMPf4+AcHB+vr7NfX11xcXKenp5manJqameXm6ExMTcjHyfv8/G9vb/j4+UdHRywsLHN0dj4+PsrLzTQ0NObm6Obn6efm6Ly9v39/fzc4OL2+v+3s7fb39wAAAP///yH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4zLWMwMTEgNjYuMTQ1NjYxLCAyMDEyLzAyLzA2LTE0OjU2OjI3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M2IChNYWNpbnRvc2gpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjQyMUExNDA3QjE2NzExRTNBMUE1RTA3Qjc0NDg0NDMxIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjQyMUExNDA4QjE2NzExRTNBMUE1RTA3Qjc0NDg0NDMxIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NDIxQTE0MDVCMTY3MTFFM0ExQTVFMDdCNzQ0ODQ0MzEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NDIxQTE0MDZCMTY3MTFFM0ExQTVFMDdCNzQ0ODQ0MzEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4B//79/Pv6+fj39vX08/Lx8O/u7ezr6uno5+bl5OPi4eDf3t3c29rZ2NfW1dTT0tHQz87NzMvKycjHxsXEw8LBwL++vby7urm4t7a1tLOysbCvrq2sq6qpqKempaSjoqGgn56dnJuamZiXlpWUk5KRkI+OjYyLiomIh4aFhIOCgYB/fn18e3p5eHd2dXRzcnFwb25tbGtqaWhnZmVkY2JhYF9eXVxbWllYV1ZVVFNSUVBPTk1MS0pJSEdGRURDQkFAPz49PDs6OTg3NjU0MzIxMC8uLSwrKikoJyYlJCMi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\" />';\n\n    function Player(controller, options) {\n      var player = this;\n      options || (options = {}); //    this.frameData = [];\n\n      this.options = options;\n      this.recording = options.recording;\n      this.controller = controller;\n      this.resetTimers();\n      this.setupLoops();\n      this.controller.connection.on('ready', function () {\n        player.setupProtocols();\n      });\n      this.userHasControl = false;\n\n      if (options.recording) {\n        if (Object.prototype.toString.call(options.recording) == '[object String]') {\n          options.recording = {\n            url: options.recording\n          };\n        }\n\n        this.setRecording(options.recording);\n      }\n\n      document.addEventListener(\"DOMContentLoaded\", function (event) {\n        document.body.addEventListener('keydown', function (e) {\n          if (e.which === player.options.pauseHotkey) {\n            player.toggle();\n          }\n        }, false);\n      });\n    }\n\n    Player.prototype = {\n      resetTimers: function () {\n        this.timeSinceLastFrame = 0;\n        this.lastFrameTime = null;\n      },\n      setupLoops: function () {\n        var player = this; // Loop with explicit frame timing\n\n        this.stepFrameLoop = function (timestamp) {\n          if (player.state != 'playing') return;\n          player.sendFrameAt(timestamp || performance.now());\n          requestAnimationFrame(player.stepFrameLoop);\n        };\n      },\n      // This is how we intercept frame data early\n      // By hooking in before Frame creation, we get data exactly as the frame sends it.\n      setupProtocols: function () {\n        var player = this; // This is the original normal protocol, used while in record mode but not recording.\n\n        this.stopProtocol = this.controller.connection.protocol; // This consumes all frame data, making the device act as if not streaming\n\n        this.playbackProtocol = function (data) {\n          // The old protocol still needs to emit events, so we use it, but intercept Frames\n          var eventOrFrame = player.stopProtocol(data);\n\n          if (eventOrFrame instanceof Leap.Frame) {\n            if (player.pauseOnHand) {\n              if (data.hands.length > 0) {\n                player.userHasControl = true;\n                player.controller.emit('playback.userTakeControl');\n                player.setGraphic();\n                player.idle();\n              } else if (data.hands.length == 0) {\n                if (player.userHasControl && player.resumeOnHandLost) {\n                  player.userHasControl = false;\n                  player.controller.emit('playback.userReleaseControl');\n                  player.setGraphic('wave');\n                }\n              }\n            } // prevent the actual frame from getting through\n\n\n            return {\n              type: 'playback'\n            };\n          } else {\n            return eventOrFrame;\n          }\n        }; // This pushes frame data, and watches for hands to auto change state.\n        // Returns the eventOrFrame without modifying it.\n\n\n        this.recordProtocol = function (data) {\n          var eventOrFrame = player.stopProtocol(data);\n\n          if (eventOrFrame instanceof Leap.Frame) {\n            player.recordFrameHandler(data);\n          }\n\n          return eventOrFrame;\n        }; // Copy methods/properties from the default protocol over\n\n\n        for (var property in this.stopProtocol) {\n          if (this.stopProtocol.hasOwnProperty(property)) {\n            this.playbackProtocol[property] = this.stopProtocol[property];\n            this.recordProtocol[property] = this.stopProtocol[property];\n          }\n        } // todo: this is messy. Should cover all cases, not just active playback!\n\n\n        if (this.state == 'playing') {\n          this.controller.connection.protocol = this.playbackProtocol;\n        }\n      },\n      // Adds playback = true to artificial frames\n      sendFrameAt: function (now) {\n        if (this.lastFrameTime) {\n          // chrome bug, see: https://code.google.com/p/chromium/issues/detail?id=268213\n          // http://jsfiddle.net/pehrlich/35pTx/\n          // console.assert(this.lastFrameTime < now);\n          if (now < this.lastFrameTime) {\n            // this fix will cause an extra animation frame before the lerp frame advances. no big.\n            this.lastFrameTime = now;\n          } else {\n            this.timeSinceLastFrame += now - this.lastFrameTime;\n          }\n        }\n\n        this.lastFrameTime = now; //      console.assert(!isNaN(this.timeSinceLastFrame));\n\n        var timeToNextFrame; // handle frame dropping, etc\n\n        while (this.timeSinceLastFrame > (timeToNextFrame = this.recording.timeToNextFrame())) {\n          this.timeSinceLastFrame -= timeToNextFrame;\n\n          if (!this.recording.advanceFrame()) {\n            this.pause();\n            this.controller.emit('playback.playbackFinished', this);\n            return;\n          }\n        }\n\n        this.sendFrame(this.recording.createLerpFrameData(this.timeSinceLastFrame / timeToNextFrame));\n      },\n      sendFrame: function (frameData) {\n        if (!frameData) throw \"Frame data not provided\";\n        var frame = new Leap.Frame(frameData); // send a deviceFrame to the controller:\n        // this frame gets picked up by the controllers own animation loop.\n\n        this.controller.processFrame(frame);\n        return true;\n      },\n      sendImmediateFrame: function (frameData) {\n        if (!frameData) throw \"Frame data not provided\";\n        var frame = new Leap.Frame(frameData); // sends an animation frame to the controller\n\n        this.controller.processFinishedFrame(frame);\n        return true;\n      },\n      setFrameIndex: function (frameIndex) {\n        if (frameIndex != this.recording.frameIndex) {\n          this.recording.frameIndex = frameIndex % this.recording.frameCount;\n          this.sendFrame(this.recording.currentFrame());\n        }\n      },\n      // used after record\n      stop: function () {\n        this.idle();\n        delete this.recording;\n        this.recording = new Recording({\n          timeBetweenLoops: this.options.timeBetweenLoops,\n          loop: this.options.loop,\n          requestProtocolVersion: this.controller.connection.opts.requestProtocolVersion,\n          serviceVersion: this.controller.connection.protocol.serviceVersion\n        });\n        this.controller.emit('playback.stop', this);\n      },\n      // used after play\n      pause: function () {\n        // todo: we should change this idle state to paused or leave it as playback with a pause flag\n        // state should correspond always to protocol handler (through a setter)?\n        this.state = 'idle';\n        this.hideOverlay();\n        this.controller.emit('playback.pause', this);\n      },\n      idle: function () {\n        this.state = 'idle';\n        this.controller.connection.protocol = this.stopProtocol;\n      },\n      toggle: function () {\n        if (this.state == 'idle') {\n          this.play();\n        } else if (this.state == 'playing') {\n          this.pause();\n        }\n      },\n      // switches to record mode, which will be begin capturing data when a hand enters the frame,\n      // and stop when a hand leaves\n      // Todo: replace frameData with a full fledged recording, including metadata.\n      record: function () {\n        this.clear();\n        this.stop();\n        this.state = 'recording';\n        this.controller.connection.protocol = this.recordProtocol;\n        this.setGraphic('connect');\n        this.controller.emit('playback.record', this);\n      },\n      // if there is existing frame data, sends a frame with nothing in it\n      clear: function () {\n        if (!this.recording || this.recording.blank()) return;\n        var finalFrame = this.recording.cloneCurrentFrame();\n        finalFrame.hands = [];\n        finalFrame.fingers = [];\n        finalFrame.pointables = [];\n        finalFrame.tools = [];\n        this.sendImmediateFrame(finalFrame);\n      },\n      recordPending: function () {\n        return this.state == 'recording' && this.recording.blank();\n      },\n      isRecording: function () {\n        return this.state == 'recording' && !this.recording.blank();\n      },\n      finishRecording: function () {\n        // change to the playbackHandler which suppresses frames:\n        this.controller.connection.protocol = this.playbackProtocol;\n        this.recording.setFrames(this.recording.frameData);\n        this.controller.emit('playback.recordingFinished', this);\n      },\n      loaded: function () {\n        return this.recording.loaded();\n      },\n      loading: function () {\n        return this.recording.loading;\n      },\n\n      /* Plays back the provided frame data\n       * Params {object|boolean}:\n       *  - frames: previously recorded frame json\n       * - loop: whether or not to loop playback.  Defaults to true.\n       */\n      play: function () {\n        if (this.state === 'playing') return;\n        if (this.loading() || this.recording.blank()) return;\n        this.state = 'playing';\n        this.controller.connection.protocol = this.playbackProtocol;\n        var player = this; // prevent the normal controller response while playing\n\n        this.controller.connection.removeAllListeners('frame');\n        this.controller.connection.on('frame', function (frame) {\n          // resume play when hands are removed:\n          if (player.resumeOnHandLost && player.autoPlay && player.state == 'idle' && frame.hands.length == 0) {\n            player.play();\n          } // The default LeapJS callback processes the frame, which is what we do now:\n\n\n          player.controller.processFrame(frame);\n        }); // Kick off\n\n        this.resetTimers();\n        this.recording.readyPlay();\n        this.stepFrameLoop();\n        this.controller.emit('playback.play', this);\n      },\n      // this method replaces connection.handleData when in record mode\n      // It accepts the raw connection data which is used to make a frame.\n      recordFrameHandler: function (frameData) {\n        // Would be better to check controller.streaming() in showOverlay, but that method doesn't exist, yet.\n        this.setGraphic('wave');\n\n        if (frameData.hands.length > 0) {\n          this.recording.addFrame(frameData);\n          this.hideOverlay();\n        } else if (!this.recording.blank()) {\n          this.finishRecording();\n        }\n      },\n      // Accepts a hash with any of\n      // URL, recording, metadata, compressedRecording\n      // once loaded, the recording is immediately activated\n      setRecording: function (options) {\n        var player = this; // otherwise, the animation loop may try and play non-existant frames:\n\n        this.pause(); // this is called on the context of the recording\n\n        var loadComplete = function (frames) {\n          this.setFrames(frames);\n\n          if (player.recording != this) {\n            console.log('recordings changed during load');\n            return;\n          }\n\n          if (player.autoPlay) {\n            player.play();\n\n            if (player.pauseOnHand && !player.controller.streaming()) {\n              player.setGraphic('connect');\n            }\n          }\n\n          player.controller.emit('playback.recordingSet', this);\n        };\n\n        this.recording = options; // Here we turn the existing argument in to a recording\n        // this allows frames to be added to the existing object via ajax\n        // saving ajax requests\n\n        if (!(options instanceof Recording)) {\n          this.recording.__proto__ = Recording.prototype;\n          Recording.call(this.recording, {\n            timeBetweenLoops: this.options.timeBetweenLoops,\n            loop: this.options.loop,\n            loadProgress: function (recording, percentage, oEvent) {\n              player.controller.emit('playback.ajax:progress', recording, percentage, oEvent);\n            }\n          });\n        }\n\n        if (this.recording.loaded()) {\n          loadComplete.call(this.recording, this.recording.frameData);\n        } else if (options.url) {\n          this.controller.emit('playback.ajax:begin', this, this.recording); // called in the context of the recording\n\n          this.recording.loadFrameData(function (frames) {\n            loadComplete.call(this, frames);\n            player.controller.emit('playback.ajax:complete', player, this);\n          });\n        } else if (options.compressedRecording) {\n          this.recording.loadCompressedRecording(options.compressedRecording, function (frames) {\n            loadComplete.call(this, frames);\n          });\n        }\n\n        return this;\n      },\n      hideOverlay: function () {\n        if (!this.overlay) return;\n        this.overlay.style.display = 'none';\n      },\n      // Accepts either \"connect\", \"wave\", or undefined.\n      setGraphic: function (graphicName) {\n        if (!this.overlay) return;\n        if (this.graphicName == graphicName) return;\n        this.graphicName = graphicName;\n\n        switch (graphicName) {\n          case 'connect':\n            this.overlay.style.display = 'block';\n            this.overlay.innerHTML = CONNECT_LEAP_ICON;\n            break;\n\n          case 'wave':\n            this.overlay.style.display = 'block';\n            this.overlay.innerHTML = MOVE_HAND_OVER_LEAP_ICON;\n            break;\n\n          case undefined:\n            this.overlay.innerHTML = '';\n            break;\n        }\n      }\n    }; // will only play back if device is disconnected\n    // Accepts options:\n    // - frames: [string] URL of .json frame data\n    // - autoPlay: [boolean true] Whether to turn on and off playback based off of connection state\n    // - overlay: [boolean or DOM element] Whether or not to show the overlay: \"Connect your Leap Motion Controller\"\n    //            if a DOM element is passed, that will be shown/hidden instead of the default message.\n    // - pauseOnHand: [boolean true] Whether to stop playback when a hand is in field of view\n    // - resumeOnHandLost: [boolean true] Whether to resume playback after the hand leaves the frame\n    // - requiredProtocolVersion: clients connected with a lower protocol number will not be able to take control of the\n    // - timeBetweenLoops: [number, ms] delay between looping playback\n    // controller with their device.  This option, if set, ovverrides autoPlay\n    // - pauseHotkey: [number or false, default: 32 (spacebar)] - keycode for pause, bound to body\n\n    var playback = function (scope) {\n      var controller = this;\n      var autoPlay = scope.autoPlay;\n      if (autoPlay === undefined) autoPlay = true;\n      var pauseOnHand = scope.pauseOnHand;\n      if (pauseOnHand === undefined) pauseOnHand = true;\n      var resumeOnHandLost = scope.resumeOnHandLost;\n      if (resumeOnHandLost === undefined) resumeOnHandLost = true;\n      var timeBetweenLoops = scope.timeBetweenLoops;\n      if (timeBetweenLoops === undefined) timeBetweenLoops = 50;\n      var requiredProtocolVersion = scope.requiredProtocolVersion;\n      var pauseHotkey = scope.pauseHotkey;\n      if (pauseHotkey === undefined) pauseHotkey = 32; // spacebar\n\n      var loop = scope.loop;\n      if (loop === undefined) loop = true;\n      var overlay = scope.overlay; // A better fix would be to set an onload handler for this, rather than disable the overlay.\n\n      if (overlay === undefined && document.body) {\n        overlay = document.createElement('div');\n        document.body.appendChild(overlay);\n        overlay.style.width = '100%';\n        overlay.style.position = 'absolute';\n        overlay.style.top = '0';\n        overlay.style.left = '-' + window.getComputedStyle(document.body).getPropertyValue('margin');\n        overlay.style.padding = '10px';\n        overlay.style.textAlign = 'center';\n        overlay.style.fontSize = '18px';\n        overlay.style.opacity = '0.8';\n        overlay.style.display = 'none';\n        overlay.style.zIndex = '10';\n        overlay.id = 'connect-leap';\n        overlay.style.cursor = 'pointer';\n        overlay.addEventListener(\"click\", function () {\n          this.style.display = 'none';\n          return false;\n        }, false);\n      }\n\n      scope.player = new Player(this, {\n        recording: scope.recording,\n        loop: loop,\n        pauseHotkey: pauseHotkey,\n        timeBetweenLoops: timeBetweenLoops\n      }); // By doing this, we allow player methods to be accessible on the scope\n      // this is the controller\n\n      scope.player.overlay = overlay;\n      scope.player.pauseOnHand = pauseOnHand;\n      scope.player.resumeOnHandLost = resumeOnHandLost;\n      scope.player.requiredProtocolVersion = requiredProtocolVersion;\n      scope.player.autoPlay = autoPlay;\n\n      var setupStreamingEvents = function () {\n        if (scope.player.pauseOnHand && controller.connection.opts.requestProtocolVersion < scope.requiredProtocolVersion) {\n          console.log('Protocol Version too old (' + controller.connection.opts.requestProtocolVersion + '), disabling device interaction.');\n          scope.player.pauseOnHand = false;\n          return;\n        }\n\n        if (autoPlay) {\n          controller.on('streamingStarted', function () {\n            if (scope.player.state == 'recording') {\n              scope.player.pause();\n              scope.player.setGraphic('wave');\n            } else {\n              if (pauseOnHand) {\n                scope.player.setGraphic('wave');\n              } else {\n                scope.player.setGraphic();\n              }\n            }\n          });\n          controller.on('streamingStopped', function () {\n            scope.player.play();\n          });\n        }\n\n        controller.on('streamingStopped', function () {\n          scope.player.setGraphic('connect');\n        });\n      }; // ready happens before streamingStarted, allowing us to check the version before responding to streamingStart/Stop\n      // we can't call this any earlier, or protcol version won't be available\n\n\n      if (!!this.connection.connected) {\n        setupStreamingEvents();\n      } else {\n        this.on('ready', setupStreamingEvents);\n      }\n\n      return {};\n    };\n\n    if (typeof Leap !== 'undefined' && Leap.Controller) {\n      Leap.Controller.plugin('playback', playback);\n    } else if (typeof module !== 'undefined') {\n      module.exports.playback = playback;\n    } else {\n      throw 'leap.js not included';\n    }\n  }).call(this);\n})(window);","map":{"version":3,"sources":["/Users/stevdiaz/Desktop/MIT SPRING 2021/6835/6835Final/pic/client/node_modules/leapjs-plugins/main/playback/leap.playback-0.2.1.js"],"names":["window","undefined","LZString","_keyStr","_f","String","fromCharCode","compressToBase64","input","output","chr1","chr2","chr3","enc1","enc2","enc3","enc4","i","compress","length","charCodeAt","NaN","isNaN","charAt","decompressFromBase64","ol","output_","f","replace","indexOf","decompress","compressToUTF16","c","current","status","decompressFromUTF16","uncompressed","value","context_dictionary","context_dictionaryToCreate","context_c","context_wc","context_w","context_enlargeIn","context_dictSize","context_numBits","context_data_string","context_data_val","context_data_position","ii","Object","prototype","hasOwnProperty","call","Math","pow","compressed","dictionary","next","enlargeIn","dictSize","numBits","entry","result","w","bits","resb","maxpower","power","data","string","val","position","index","module","exports","performance","now","nowOffset","Date","timing","navigationStart","Recording","options","loading","timeBetweenLoops","packingStructure","hands","pointables","interactionBox","setFrames","frames","frameData","frameIndex","frameCount","leftCropPosition","rightCropPosition","setMetaData","addFrame","push","currentFrame","nextFrame","advanceFrame","loop","readyPlay","cloneCurrentFrame","JSON","parse","stringify","createLerpFrameData","t","handProps","fingerProps","numHands","numPointables","len1","len2","prop","hand","pointable","j","Leap","vec3","lerp","timeToNextFrame","elapsedTime","timestamp","blank","leftCrop","rightCrop","cullFrames","factor","console","log","splice","frameRate","croppedFrameData","slice","newMetaData","formatVersion","generatedBy","protocolVersion","requestProtocolVersion","serviceVersion","toPrecision","modified","toString","metadata","key","packedFrameData","packedFrames","frameDatum","len","packArray","structure","out","nameOrHash","unPackFrameData","unPackArray","subArray","toHash","export","format","json","save","filename","title","round","saveAs","Blob","type","loaded","loadFrameData","callback","xhr","XMLHttpRequest","url","recording","contentLength","onreadystatechange","readyState","DONE","responseText","finishLoad","error","addEventListener","oEvent","loadProgress","lengthComputable","percentComplete","total","open","send","responseData","split","loadCompressedRecording","compressedData","decompressedData","CONNECT_LEAP_ICON","MOVE_HAND_OVER_LEAP_ICON","Player","controller","player","resetTimers","setupLoops","connection","on","setupProtocols","userHasControl","setRecording","document","event","body","e","which","pauseHotkey","toggle","timeSinceLastFrame","lastFrameTime","stepFrameLoop","state","sendFrameAt","requestAnimationFrame","stopProtocol","protocol","playbackProtocol","eventOrFrame","Frame","pauseOnHand","emit","setGraphic","idle","resumeOnHandLost","recordProtocol","recordFrameHandler","property","pause","sendFrame","frame","processFrame","sendImmediateFrame","processFinishedFrame","setFrameIndex","stop","opts","hideOverlay","play","record","clear","finalFrame","fingers","tools","recordPending","isRecording","finishRecording","removeAllListeners","autoPlay","loadComplete","streaming","__proto__","percentage","compressedRecording","overlay","style","display","graphicName","innerHTML","playback","scope","requiredProtocolVersion","createElement","appendChild","width","top","left","getComputedStyle","getPropertyValue","padding","textAlign","fontSize","opacity","zIndex","id","cursor","setupStreamingEvents","connected","Controller","plugin"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;AAAE,WAAUA,MAAV,EAAkBC,SAAlB,EAA6B;AAC9B,eAD8B,CAE7B;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,MAAIC,QAAQ,GAAG;AAGb;AACAC,IAAAA,OAAO,EAAG,mEAJG;AAKbC,IAAAA,EAAE,EAAGC,MAAM,CAACC,YALC;AAObC,IAAAA,gBAAgB,EAAG,UAAUC,KAAV,EAAiB;AAClC,UAAIA,KAAK,IAAI,IAAb,EAAmB,OAAO,EAAP;AACnB,UAAIC,MAAM,GAAG,EAAb;AACA,UAAIC,IAAJ,EAAUC,IAAV,EAAgBC,IAAhB,EAAsBC,IAAtB,EAA4BC,IAA5B,EAAkCC,IAAlC,EAAwCC,IAAxC;AACA,UAAIC,CAAC,GAAG,CAAR;AAEAT,MAAAA,KAAK,GAAGN,QAAQ,CAACgB,QAAT,CAAkBV,KAAlB,CAAR;;AAEA,aAAOS,CAAC,GAAGT,KAAK,CAACW,MAAN,GAAa,CAAxB,EAA2B;AAEzB,YAAIF,CAAC,GAAC,CAAF,IAAK,CAAT,EAAY;AACVP,UAAAA,IAAI,GAAGF,KAAK,CAACY,UAAN,CAAiBH,CAAC,GAAC,CAAnB,KAAyB,CAAhC;AACAN,UAAAA,IAAI,GAAGH,KAAK,CAACY,UAAN,CAAiBH,CAAC,GAAC,CAAnB,IAAwB,GAA/B;AACA,cAAIA,CAAC,GAAC,CAAF,GAAI,CAAJ,GAAQT,KAAK,CAACW,MAAlB,EACEP,IAAI,GAAGJ,KAAK,CAACY,UAAN,CAAiBH,CAAC,GAAC,CAAF,GAAI,CAArB,KAA2B,CAAlC,CADF,KAGEL,IAAI,GAAGS,GAAP;AACH,SAPD,MAOO;AACLX,UAAAA,IAAI,GAAGF,KAAK,CAACY,UAAN,CAAiB,CAACH,CAAC,GAAC,CAAH,IAAM,CAAvB,IAA4B,GAAnC;;AACA,cAAI,CAACA,CAAC,GAAC,CAAH,IAAM,CAAN,GAAUT,KAAK,CAACW,MAApB,EAA4B;AAC1BR,YAAAA,IAAI,GAAGH,KAAK,CAACY,UAAN,CAAiB,CAACH,CAAC,GAAC,CAAH,IAAM,CAAvB,KAA6B,CAApC;AACAL,YAAAA,IAAI,GAAGJ,KAAK,CAACY,UAAN,CAAiB,CAACH,CAAC,GAAC,CAAH,IAAM,CAAvB,IAA4B,GAAnC;AACD,WAHD,MAIEN,IAAI,GAACC,IAAI,GAACS,GAAV;AACH;;AACDJ,QAAAA,CAAC,IAAE,CAAH;AAEAJ,QAAAA,IAAI,GAAGH,IAAI,IAAI,CAAf;AACAI,QAAAA,IAAI,GAAI,CAACJ,IAAI,GAAG,CAAR,KAAc,CAAf,GAAqBC,IAAI,IAAI,CAApC;AACAI,QAAAA,IAAI,GAAI,CAACJ,IAAI,GAAG,EAAR,KAAe,CAAhB,GAAsBC,IAAI,IAAI,CAArC;AACAI,QAAAA,IAAI,GAAGJ,IAAI,GAAG,EAAd;;AAEA,YAAIU,KAAK,CAACX,IAAD,CAAT,EAAiB;AACfI,UAAAA,IAAI,GAAGC,IAAI,GAAG,EAAd;AACD,SAFD,MAEO,IAAIM,KAAK,CAACV,IAAD,CAAT,EAAiB;AACtBI,UAAAA,IAAI,GAAG,EAAP;AACD;;AAEDP,QAAAA,MAAM,GAAGA,MAAM,GACbP,QAAQ,CAACC,OAAT,CAAiBoB,MAAjB,CAAwBV,IAAxB,CADO,GACyBX,QAAQ,CAACC,OAAT,CAAiBoB,MAAjB,CAAwBT,IAAxB,CADzB,GAELZ,QAAQ,CAACC,OAAT,CAAiBoB,MAAjB,CAAwBR,IAAxB,CAFK,GAE2Bb,QAAQ,CAACC,OAAT,CAAiBoB,MAAjB,CAAwBP,IAAxB,CAFpC;AAID;;AAED,aAAOP,MAAP;AACD,KApDY;AAsDbe,IAAAA,oBAAoB,EAAG,UAAUhB,KAAV,EAAiB;AACtC,UAAIA,KAAK,IAAI,IAAb,EAAmB,OAAO,EAAP;AACnB,UAAIC,MAAM,GAAG,EAAb;AAAA,UACIgB,EAAE,GAAG,CADT;AAAA,UAEIC,OAFJ;AAAA,UAGIhB,IAHJ;AAAA,UAGUC,IAHV;AAAA,UAGgBC,IAHhB;AAAA,UAIIC,IAJJ;AAAA,UAIUC,IAJV;AAAA,UAIgBC,IAJhB;AAAA,UAIsBC,IAJtB;AAAA,UAKIC,CAAC,GAAG,CALR;AAAA,UAKWU,CAAC,GAACzB,QAAQ,CAACE,EALtB;AAOAI,MAAAA,KAAK,GAAGA,KAAK,CAACoB,OAAN,CAAc,qBAAd,EAAqC,EAArC,CAAR;;AAEA,aAAOX,CAAC,GAAGT,KAAK,CAACW,MAAjB,EAAyB;AAEvBN,QAAAA,IAAI,GAAGX,QAAQ,CAACC,OAAT,CAAiB0B,OAAjB,CAAyBrB,KAAK,CAACe,MAAN,CAAaN,CAAC,EAAd,CAAzB,CAAP;AACAH,QAAAA,IAAI,GAAGZ,QAAQ,CAACC,OAAT,CAAiB0B,OAAjB,CAAyBrB,KAAK,CAACe,MAAN,CAAaN,CAAC,EAAd,CAAzB,CAAP;AACAF,QAAAA,IAAI,GAAGb,QAAQ,CAACC,OAAT,CAAiB0B,OAAjB,CAAyBrB,KAAK,CAACe,MAAN,CAAaN,CAAC,EAAd,CAAzB,CAAP;AACAD,QAAAA,IAAI,GAAGd,QAAQ,CAACC,OAAT,CAAiB0B,OAAjB,CAAyBrB,KAAK,CAACe,MAAN,CAAaN,CAAC,EAAd,CAAzB,CAAP;AAEAP,QAAAA,IAAI,GAAIG,IAAI,IAAI,CAAT,GAAeC,IAAI,IAAI,CAA9B;AACAH,QAAAA,IAAI,GAAI,CAACG,IAAI,GAAG,EAAR,KAAe,CAAhB,GAAsBC,IAAI,IAAI,CAArC;AACAH,QAAAA,IAAI,GAAI,CAACG,IAAI,GAAG,CAAR,KAAc,CAAf,GAAoBC,IAA3B;;AAEA,YAAIS,EAAE,GAAC,CAAH,IAAM,CAAV,EAAa;AACXC,UAAAA,OAAO,GAAGhB,IAAI,IAAI,CAAlB;;AAEA,cAAIK,IAAI,IAAI,EAAZ,EAAgB;AACdN,YAAAA,MAAM,IAAIkB,CAAC,CAACD,OAAO,GAAGf,IAAX,CAAX;AACD;;AACD,cAAIK,IAAI,IAAI,EAAZ,EAAgB;AACdU,YAAAA,OAAO,GAAGd,IAAI,IAAI,CAAlB;AACD;AACF,SATD,MASO;AACLH,UAAAA,MAAM,GAAGA,MAAM,GAAGkB,CAAC,CAACD,OAAO,GAAGhB,IAAX,CAAnB;;AAEA,cAAIK,IAAI,IAAI,EAAZ,EAAgB;AACdW,YAAAA,OAAO,GAAGf,IAAI,IAAI,CAAlB;AACD;;AACD,cAAIK,IAAI,IAAI,EAAZ,EAAgB;AACdP,YAAAA,MAAM,IAAIkB,CAAC,CAACD,OAAO,GAAGd,IAAX,CAAX;AACD;AACF;;AACDa,QAAAA,EAAE,IAAE,CAAJ;AACD;;AAED,aAAOvB,QAAQ,CAAC4B,UAAT,CAAoBrB,MAApB,CAAP;AAED,KApGY;AAsGbsB,IAAAA,eAAe,EAAG,UAAUvB,KAAV,EAAiB;AACjC,UAAIA,KAAK,IAAI,IAAb,EAAmB,OAAO,EAAP;AACnB,UAAIC,MAAM,GAAG,EAAb;AAAA,UACIQ,CADJ;AAAA,UACMe,CADN;AAAA,UAEIC,OAFJ;AAAA,UAGIC,MAAM,GAAG,CAHb;AAAA,UAIIP,CAAC,GAAGzB,QAAQ,CAACE,EAJjB;AAMAI,MAAAA,KAAK,GAAGN,QAAQ,CAACgB,QAAT,CAAkBV,KAAlB,CAAR;;AAEA,WAAKS,CAAC,GAAC,CAAP,EAAWA,CAAC,GAACT,KAAK,CAACW,MAAnB,EAA4BF,CAAC,EAA7B,EAAiC;AAC/Be,QAAAA,CAAC,GAAGxB,KAAK,CAACY,UAAN,CAAiBH,CAAjB,CAAJ;;AACA,gBAAQiB,MAAM,EAAd;AACE,eAAK,CAAL;AACEzB,YAAAA,MAAM,IAAIkB,CAAC,CAAC,CAACK,CAAC,IAAI,CAAN,IAAS,EAAV,CAAX;AACAC,YAAAA,OAAO,GAAG,CAACD,CAAC,GAAG,CAAL,KAAW,EAArB;AACA;;AACF,eAAK,CAAL;AACEvB,YAAAA,MAAM,IAAIkB,CAAC,CAAEM,OAAO,IAAID,CAAC,IAAI,CAAT,CAAR,GAAqB,EAAtB,CAAX;AACAC,YAAAA,OAAO,GAAG,CAACD,CAAC,GAAG,CAAL,KAAW,EAArB;AACA;;AACF,eAAK,CAAL;AACEvB,YAAAA,MAAM,IAAIkB,CAAC,CAAEM,OAAO,IAAID,CAAC,IAAI,CAAT,CAAR,GAAqB,EAAtB,CAAX;AACAC,YAAAA,OAAO,GAAG,CAACD,CAAC,GAAG,CAAL,KAAW,EAArB;AACA;;AACF,eAAK,CAAL;AACEvB,YAAAA,MAAM,IAAIkB,CAAC,CAAEM,OAAO,IAAID,CAAC,IAAI,CAAT,CAAR,GAAqB,EAAtB,CAAX;AACAC,YAAAA,OAAO,GAAG,CAACD,CAAC,GAAG,EAAL,KAAY,EAAtB;AACA;;AACF,eAAK,CAAL;AACEvB,YAAAA,MAAM,IAAIkB,CAAC,CAAEM,OAAO,IAAID,CAAC,IAAI,CAAT,CAAR,GAAqB,EAAtB,CAAX;AACAC,YAAAA,OAAO,GAAG,CAACD,CAAC,GAAG,EAAL,KAAY,EAAtB;AACA;;AACF,eAAK,CAAL;AACEvB,YAAAA,MAAM,IAAIkB,CAAC,CAAEM,OAAO,IAAID,CAAC,IAAI,CAAT,CAAR,GAAqB,EAAtB,CAAX;AACAC,YAAAA,OAAO,GAAG,CAACD,CAAC,GAAG,EAAL,KAAY,CAAtB;AACA;;AACF,eAAK,CAAL;AACEvB,YAAAA,MAAM,IAAIkB,CAAC,CAAEM,OAAO,IAAID,CAAC,IAAI,CAAT,CAAR,GAAqB,EAAtB,CAAX;AACAC,YAAAA,OAAO,GAAG,CAACD,CAAC,GAAG,GAAL,KAAa,CAAvB;AACA;;AACF,eAAK,CAAL;AACEvB,YAAAA,MAAM,IAAIkB,CAAC,CAAEM,OAAO,IAAID,CAAC,IAAI,CAAT,CAAR,GAAqB,EAAtB,CAAX;AACAC,YAAAA,OAAO,GAAG,CAACD,CAAC,GAAG,GAAL,KAAa,CAAvB;AACA;;AACF,eAAK,CAAL;AACEvB,YAAAA,MAAM,IAAIkB,CAAC,CAAEM,OAAO,IAAID,CAAC,IAAI,CAAT,CAAR,GAAqB,EAAtB,CAAX;AACAC,YAAAA,OAAO,GAAG,CAACD,CAAC,GAAG,GAAL,KAAa,CAAvB;AACA;;AACF,eAAK,CAAL;AACEvB,YAAAA,MAAM,IAAIkB,CAAC,CAAEM,OAAO,IAAID,CAAC,IAAI,EAAT,CAAR,GAAsB,EAAvB,CAAX;AACAC,YAAAA,OAAO,GAAG,CAACD,CAAC,GAAG,IAAL,KAAc,CAAxB;AACA;;AACF,eAAK,EAAL;AACEvB,YAAAA,MAAM,IAAIkB,CAAC,CAAEM,OAAO,IAAID,CAAC,IAAI,EAAT,CAAR,GAAsB,EAAvB,CAAX;AACAC,YAAAA,OAAO,GAAG,CAACD,CAAC,GAAG,IAAL,KAAc,CAAxB;AACA;;AACF,eAAK,EAAL;AACEvB,YAAAA,MAAM,IAAIkB,CAAC,CAAEM,OAAO,IAAID,CAAC,IAAI,EAAT,CAAR,GAAsB,EAAvB,CAAX;AACAC,YAAAA,OAAO,GAAG,CAACD,CAAC,GAAG,IAAL,KAAc,CAAxB;AACA;;AACF,eAAK,EAAL;AACEvB,YAAAA,MAAM,IAAIkB,CAAC,CAAEM,OAAO,IAAID,CAAC,IAAI,EAAT,CAAR,GAAsB,EAAvB,CAAX;AACAC,YAAAA,OAAO,GAAG,CAACD,CAAC,GAAG,IAAL,KAAc,CAAxB;AACA;;AACF,eAAK,EAAL;AACEvB,YAAAA,MAAM,IAAIkB,CAAC,CAAEM,OAAO,IAAID,CAAC,IAAI,EAAT,CAAR,GAAsB,EAAvB,CAAX;AACAC,YAAAA,OAAO,GAAG,CAACD,CAAC,GAAG,KAAL,KAAe,CAAzB;AACA;;AACF,eAAK,EAAL;AACEvB,YAAAA,MAAM,IAAIkB,CAAC,CAAEM,OAAO,IAAID,CAAC,IAAI,EAAT,CAAR,GAAsB,EAAvB,EAA2B,CAACA,CAAC,GAAG,KAAL,IAAY,EAAvC,CAAX;AACAE,YAAAA,MAAM,GAAG,CAAT;AACA;AA5DJ;AA8DD;;AAED,aAAOzB,MAAM,GAAGkB,CAAC,CAACM,OAAO,GAAG,EAAX,CAAjB;AACD,KAnLY;AAsLbE,IAAAA,mBAAmB,EAAG,UAAU3B,KAAV,EAAiB;AACrC,UAAIA,KAAK,IAAI,IAAb,EAAmB,OAAO,EAAP;AACnB,UAAIC,MAAM,GAAG,EAAb;AAAA,UACIwB,OADJ;AAAA,UACYD,CADZ;AAAA,UAEIE,MAAM,GAAC,CAFX;AAAA,UAGIjB,CAAC,GAAG,CAHR;AAAA,UAIIU,CAAC,GAAGzB,QAAQ,CAACE,EAJjB;;AAMA,aAAOa,CAAC,GAAGT,KAAK,CAACW,MAAjB,EAAyB;AACvBa,QAAAA,CAAC,GAAGxB,KAAK,CAACY,UAAN,CAAiBH,CAAjB,IAAsB,EAA1B;;AAEA,gBAAQiB,MAAM,EAAd;AACE,eAAK,CAAL;AACED,YAAAA,OAAO,GAAGD,CAAC,IAAI,CAAf;AACA;;AACF,eAAK,CAAL;AACEvB,YAAAA,MAAM,IAAIkB,CAAC,CAACM,OAAO,GAAID,CAAC,IAAI,EAAjB,CAAX;AACAC,YAAAA,OAAO,GAAG,CAACD,CAAC,GAAC,KAAH,KAAa,CAAvB;AACA;;AACF,eAAK,CAAL;AACEvB,YAAAA,MAAM,IAAIkB,CAAC,CAACM,OAAO,GAAID,CAAC,IAAI,EAAjB,CAAX;AACAC,YAAAA,OAAO,GAAG,CAACD,CAAC,GAAC,IAAH,KAAY,CAAtB;AACA;;AACF,eAAK,CAAL;AACEvB,YAAAA,MAAM,IAAIkB,CAAC,CAACM,OAAO,GAAID,CAAC,IAAI,EAAjB,CAAX;AACAC,YAAAA,OAAO,GAAG,CAACD,CAAC,GAAC,IAAH,KAAY,CAAtB;AACA;;AACF,eAAK,CAAL;AACEvB,YAAAA,MAAM,IAAIkB,CAAC,CAACM,OAAO,GAAID,CAAC,IAAI,EAAjB,CAAX;AACAC,YAAAA,OAAO,GAAG,CAACD,CAAC,GAAC,IAAH,KAAY,CAAtB;AACA;;AACF,eAAK,CAAL;AACEvB,YAAAA,MAAM,IAAIkB,CAAC,CAACM,OAAO,GAAID,CAAC,IAAI,EAAjB,CAAX;AACAC,YAAAA,OAAO,GAAG,CAACD,CAAC,GAAC,IAAH,KAAY,CAAtB;AACA;;AACF,eAAK,CAAL;AACEvB,YAAAA,MAAM,IAAIkB,CAAC,CAACM,OAAO,GAAID,CAAC,IAAI,CAAjB,CAAX;AACAC,YAAAA,OAAO,GAAG,CAACD,CAAC,GAAC,GAAH,KAAW,CAArB;AACA;;AACF,eAAK,CAAL;AACEvB,YAAAA,MAAM,IAAIkB,CAAC,CAACM,OAAO,GAAID,CAAC,IAAI,CAAjB,CAAX;AACAC,YAAAA,OAAO,GAAG,CAACD,CAAC,GAAC,GAAH,KAAW,CAArB;AACA;;AACF,eAAK,CAAL;AACEvB,YAAAA,MAAM,IAAIkB,CAAC,CAACM,OAAO,GAAID,CAAC,IAAI,CAAjB,CAAX;AACAC,YAAAA,OAAO,GAAG,CAACD,CAAC,GAAC,GAAH,KAAW,CAArB;AACA;;AACF,eAAK,CAAL;AACEvB,YAAAA,MAAM,IAAIkB,CAAC,CAACM,OAAO,GAAID,CAAC,IAAI,CAAjB,CAAX;AACAC,YAAAA,OAAO,GAAG,CAACD,CAAC,GAAC,EAAH,KAAU,EAApB;AACA;;AACF,eAAK,EAAL;AACEvB,YAAAA,MAAM,IAAIkB,CAAC,CAACM,OAAO,GAAID,CAAC,IAAI,CAAjB,CAAX;AACAC,YAAAA,OAAO,GAAG,CAACD,CAAC,GAAC,EAAH,KAAU,EAApB;AACA;;AACF,eAAK,EAAL;AACEvB,YAAAA,MAAM,IAAIkB,CAAC,CAACM,OAAO,GAAID,CAAC,IAAI,CAAjB,CAAX;AACAC,YAAAA,OAAO,GAAG,CAACD,CAAC,GAAC,EAAH,KAAU,EAApB;AACA;;AACF,eAAK,EAAL;AACEvB,YAAAA,MAAM,IAAIkB,CAAC,CAACM,OAAO,GAAID,CAAC,IAAI,CAAjB,CAAX;AACAC,YAAAA,OAAO,GAAG,CAACD,CAAC,GAAC,CAAH,KAAS,EAAnB;AACA;;AACF,eAAK,EAAL;AACEvB,YAAAA,MAAM,IAAIkB,CAAC,CAACM,OAAO,GAAID,CAAC,IAAI,CAAjB,CAAX;AACAC,YAAAA,OAAO,GAAG,CAACD,CAAC,GAAC,CAAH,KAAS,EAAnB;AACA;;AACF,eAAK,EAAL;AACEvB,YAAAA,MAAM,IAAIkB,CAAC,CAACM,OAAO,GAAID,CAAC,IAAI,CAAjB,CAAX;AACAC,YAAAA,OAAO,GAAG,CAACD,CAAC,GAAC,CAAH,KAAS,EAAnB;AACA;;AACF,eAAK,EAAL;AACEvB,YAAAA,MAAM,IAAIkB,CAAC,CAACM,OAAO,GAAGD,CAAX,CAAX;AACAE,YAAAA,MAAM,GAAC,CAAP;AACA;AA/DJ;;AAmEAjB,QAAAA,CAAC;AACF;;AAED,aAAOf,QAAQ,CAAC4B,UAAT,CAAoBrB,MAApB,CAAP,CAjFqC,CAkFrC;AAED,KA1QY;AA8QbS,IAAAA,QAAQ,EAAE,UAAUkB,YAAV,EAAwB;AAChC,UAAIA,YAAY,IAAI,IAApB,EAA0B,OAAO,EAAP;AAC1B,UAAInB,CAAJ;AAAA,UAAOoB,KAAP;AAAA,UACIC,kBAAkB,GAAE,EADxB;AAAA,UAEIC,0BAA0B,GAAE,EAFhC;AAAA,UAGIC,SAAS,GAAC,EAHd;AAAA,UAIIC,UAAU,GAAC,EAJf;AAAA,UAKIC,SAAS,GAAC,EALd;AAAA,UAMIC,iBAAiB,GAAE,CANvB;AAAA,UAM0B;AACtBC,MAAAA,gBAAgB,GAAE,CAPtB;AAAA,UAQIC,eAAe,GAAE,CARrB;AAAA,UASIC,mBAAmB,GAAC,EATxB;AAAA,UAUIC,gBAAgB,GAAC,CAVrB;AAAA,UAWIC,qBAAqB,GAAC,CAX1B;AAAA,UAYIC,EAZJ;AAAA,UAaItB,CAAC,GAACzB,QAAQ,CAACE,EAbf;;AAeA,WAAK6C,EAAE,GAAG,CAAV,EAAaA,EAAE,GAAGb,YAAY,CAACjB,MAA/B,EAAuC8B,EAAE,IAAI,CAA7C,EAAgD;AAC9CT,QAAAA,SAAS,GAAGJ,YAAY,CAACb,MAAb,CAAoB0B,EAApB,CAAZ;;AACA,YAAI,CAACC,MAAM,CAACC,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCf,kBAArC,EAAwDE,SAAxD,CAAL,EAAyE;AACvEF,UAAAA,kBAAkB,CAACE,SAAD,CAAlB,GAAgCI,gBAAgB,EAAhD;AACAL,UAAAA,0BAA0B,CAACC,SAAD,CAA1B,GAAwC,IAAxC;AACD;;AAEDC,QAAAA,UAAU,GAAGC,SAAS,GAAGF,SAAzB;;AACA,YAAIU,MAAM,CAACC,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCf,kBAArC,EAAwDG,UAAxD,CAAJ,EAAyE;AACvEC,UAAAA,SAAS,GAAGD,UAAZ;AACD,SAFD,MAEO;AACL,cAAIS,MAAM,CAACC,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCd,0BAArC,EAAgEG,SAAhE,CAAJ,EAAgF;AAC9E,gBAAIA,SAAS,CAACtB,UAAV,CAAqB,CAArB,IAAwB,GAA5B,EAAiC;AAC/B,mBAAKH,CAAC,GAAC,CAAP,EAAWA,CAAC,GAAC4B,eAAb,EAA+B5B,CAAC,EAAhC,EAAoC;AAClC8B,gBAAAA,gBAAgB,GAAIA,gBAAgB,IAAI,CAAxC;;AACA,oBAAIC,qBAAqB,IAAI,EAA7B,EAAiC;AAC/BA,kBAAAA,qBAAqB,GAAG,CAAxB;AACAF,kBAAAA,mBAAmB,IAAInB,CAAC,CAACoB,gBAAD,CAAxB;AACAA,kBAAAA,gBAAgB,GAAG,CAAnB;AACD,iBAJD,MAIO;AACLC,kBAAAA,qBAAqB;AACtB;AACF;;AACDX,cAAAA,KAAK,GAAGK,SAAS,CAACtB,UAAV,CAAqB,CAArB,CAAR;;AACA,mBAAKH,CAAC,GAAC,CAAP,EAAWA,CAAC,GAAC,CAAb,EAAiBA,CAAC,EAAlB,EAAsB;AACpB8B,gBAAAA,gBAAgB,GAAIA,gBAAgB,IAAI,CAArB,GAA2BV,KAAK,GAAC,CAApD;;AACA,oBAAIW,qBAAqB,IAAI,EAA7B,EAAiC;AAC/BA,kBAAAA,qBAAqB,GAAG,CAAxB;AACAF,kBAAAA,mBAAmB,IAAInB,CAAC,CAACoB,gBAAD,CAAxB;AACAA,kBAAAA,gBAAgB,GAAG,CAAnB;AACD,iBAJD,MAIO;AACLC,kBAAAA,qBAAqB;AACtB;;AACDX,gBAAAA,KAAK,GAAGA,KAAK,IAAI,CAAjB;AACD;AACF,aAvBD,MAuBO;AACLA,cAAAA,KAAK,GAAG,CAAR;;AACA,mBAAKpB,CAAC,GAAC,CAAP,EAAWA,CAAC,GAAC4B,eAAb,EAA+B5B,CAAC,EAAhC,EAAoC;AAClC8B,gBAAAA,gBAAgB,GAAIA,gBAAgB,IAAI,CAArB,GAA0BV,KAA7C;;AACA,oBAAIW,qBAAqB,IAAI,EAA7B,EAAiC;AAC/BA,kBAAAA,qBAAqB,GAAG,CAAxB;AACAF,kBAAAA,mBAAmB,IAAInB,CAAC,CAACoB,gBAAD,CAAxB;AACAA,kBAAAA,gBAAgB,GAAG,CAAnB;AACD,iBAJD,MAIO;AACLC,kBAAAA,qBAAqB;AACtB;;AACDX,gBAAAA,KAAK,GAAG,CAAR;AACD;;AACDA,cAAAA,KAAK,GAAGK,SAAS,CAACtB,UAAV,CAAqB,CAArB,CAAR;;AACA,mBAAKH,CAAC,GAAC,CAAP,EAAWA,CAAC,GAAC,EAAb,EAAkBA,CAAC,EAAnB,EAAuB;AACrB8B,gBAAAA,gBAAgB,GAAIA,gBAAgB,IAAI,CAArB,GAA2BV,KAAK,GAAC,CAApD;;AACA,oBAAIW,qBAAqB,IAAI,EAA7B,EAAiC;AAC/BA,kBAAAA,qBAAqB,GAAG,CAAxB;AACAF,kBAAAA,mBAAmB,IAAInB,CAAC,CAACoB,gBAAD,CAAxB;AACAA,kBAAAA,gBAAgB,GAAG,CAAnB;AACD,iBAJD,MAIO;AACLC,kBAAAA,qBAAqB;AACtB;;AACDX,gBAAAA,KAAK,GAAGA,KAAK,IAAI,CAAjB;AACD;AACF;;AACDM,YAAAA,iBAAiB;;AACjB,gBAAIA,iBAAiB,IAAI,CAAzB,EAA4B;AAC1BA,cAAAA,iBAAiB,GAAGW,IAAI,CAACC,GAAL,CAAS,CAAT,EAAYV,eAAZ,CAApB;AACAA,cAAAA,eAAe;AAChB;;AACD,mBAAON,0BAA0B,CAACG,SAAD,CAAjC;AACD,WAxDD,MAwDO;AACLL,YAAAA,KAAK,GAAGC,kBAAkB,CAACI,SAAD,CAA1B;;AACA,iBAAKzB,CAAC,GAAC,CAAP,EAAWA,CAAC,GAAC4B,eAAb,EAA+B5B,CAAC,EAAhC,EAAoC;AAClC8B,cAAAA,gBAAgB,GAAIA,gBAAgB,IAAI,CAArB,GAA2BV,KAAK,GAAC,CAApD;;AACA,kBAAIW,qBAAqB,IAAI,EAA7B,EAAiC;AAC/BA,gBAAAA,qBAAqB,GAAG,CAAxB;AACAF,gBAAAA,mBAAmB,IAAInB,CAAC,CAACoB,gBAAD,CAAxB;AACAA,gBAAAA,gBAAgB,GAAG,CAAnB;AACD,eAJD,MAIO;AACLC,gBAAAA,qBAAqB;AACtB;;AACDX,cAAAA,KAAK,GAAGA,KAAK,IAAI,CAAjB;AACD;AAGF;;AACDM,UAAAA,iBAAiB;;AACjB,cAAIA,iBAAiB,IAAI,CAAzB,EAA4B;AAC1BA,YAAAA,iBAAiB,GAAGW,IAAI,CAACC,GAAL,CAAS,CAAT,EAAYV,eAAZ,CAApB;AACAA,YAAAA,eAAe;AAChB,WA7EI,CA8EL;;;AACAP,UAAAA,kBAAkB,CAACG,UAAD,CAAlB,GAAiCG,gBAAgB,EAAjD;AACAF,UAAAA,SAAS,GAAGrC,MAAM,CAACmC,SAAD,CAAlB;AACD;AACF,OA7G+B,CA+GhC;;;AACA,UAAIE,SAAS,KAAK,EAAlB,EAAsB;AACpB,YAAIQ,MAAM,CAACC,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCd,0BAArC,EAAgEG,SAAhE,CAAJ,EAAgF;AAC9E,cAAIA,SAAS,CAACtB,UAAV,CAAqB,CAArB,IAAwB,GAA5B,EAAiC;AAC/B,iBAAKH,CAAC,GAAC,CAAP,EAAWA,CAAC,GAAC4B,eAAb,EAA+B5B,CAAC,EAAhC,EAAoC;AAClC8B,cAAAA,gBAAgB,GAAIA,gBAAgB,IAAI,CAAxC;;AACA,kBAAIC,qBAAqB,IAAI,EAA7B,EAAiC;AAC/BA,gBAAAA,qBAAqB,GAAG,CAAxB;AACAF,gBAAAA,mBAAmB,IAAInB,CAAC,CAACoB,gBAAD,CAAxB;AACAA,gBAAAA,gBAAgB,GAAG,CAAnB;AACD,eAJD,MAIO;AACLC,gBAAAA,qBAAqB;AACtB;AACF;;AACDX,YAAAA,KAAK,GAAGK,SAAS,CAACtB,UAAV,CAAqB,CAArB,CAAR;;AACA,iBAAKH,CAAC,GAAC,CAAP,EAAWA,CAAC,GAAC,CAAb,EAAiBA,CAAC,EAAlB,EAAsB;AACpB8B,cAAAA,gBAAgB,GAAIA,gBAAgB,IAAI,CAArB,GAA2BV,KAAK,GAAC,CAApD;;AACA,kBAAIW,qBAAqB,IAAI,EAA7B,EAAiC;AAC/BA,gBAAAA,qBAAqB,GAAG,CAAxB;AACAF,gBAAAA,mBAAmB,IAAInB,CAAC,CAACoB,gBAAD,CAAxB;AACAA,gBAAAA,gBAAgB,GAAG,CAAnB;AACD,eAJD,MAIO;AACLC,gBAAAA,qBAAqB;AACtB;;AACDX,cAAAA,KAAK,GAAGA,KAAK,IAAI,CAAjB;AACD;AACF,WAvBD,MAuBO;AACLA,YAAAA,KAAK,GAAG,CAAR;;AACA,iBAAKpB,CAAC,GAAC,CAAP,EAAWA,CAAC,GAAC4B,eAAb,EAA+B5B,CAAC,EAAhC,EAAoC;AAClC8B,cAAAA,gBAAgB,GAAIA,gBAAgB,IAAI,CAArB,GAA0BV,KAA7C;;AACA,kBAAIW,qBAAqB,IAAI,EAA7B,EAAiC;AAC/BA,gBAAAA,qBAAqB,GAAG,CAAxB;AACAF,gBAAAA,mBAAmB,IAAInB,CAAC,CAACoB,gBAAD,CAAxB;AACAA,gBAAAA,gBAAgB,GAAG,CAAnB;AACD,eAJD,MAIO;AACLC,gBAAAA,qBAAqB;AACtB;;AACDX,cAAAA,KAAK,GAAG,CAAR;AACD;;AACDA,YAAAA,KAAK,GAAGK,SAAS,CAACtB,UAAV,CAAqB,CAArB,CAAR;;AACA,iBAAKH,CAAC,GAAC,CAAP,EAAWA,CAAC,GAAC,EAAb,EAAkBA,CAAC,EAAnB,EAAuB;AACrB8B,cAAAA,gBAAgB,GAAIA,gBAAgB,IAAI,CAArB,GAA2BV,KAAK,GAAC,CAApD;;AACA,kBAAIW,qBAAqB,IAAI,EAA7B,EAAiC;AAC/BA,gBAAAA,qBAAqB,GAAG,CAAxB;AACAF,gBAAAA,mBAAmB,IAAInB,CAAC,CAACoB,gBAAD,CAAxB;AACAA,gBAAAA,gBAAgB,GAAG,CAAnB;AACD,eAJD,MAIO;AACLC,gBAAAA,qBAAqB;AACtB;;AACDX,cAAAA,KAAK,GAAGA,KAAK,IAAI,CAAjB;AACD;AACF;;AACDM,UAAAA,iBAAiB;;AACjB,cAAIA,iBAAiB,IAAI,CAAzB,EAA4B;AAC1BA,YAAAA,iBAAiB,GAAGW,IAAI,CAACC,GAAL,CAAS,CAAT,EAAYV,eAAZ,CAApB;AACAA,YAAAA,eAAe;AAChB;;AACD,iBAAON,0BAA0B,CAACG,SAAD,CAAjC;AACD,SAxDD,MAwDO;AACLL,UAAAA,KAAK,GAAGC,kBAAkB,CAACI,SAAD,CAA1B;;AACA,eAAKzB,CAAC,GAAC,CAAP,EAAWA,CAAC,GAAC4B,eAAb,EAA+B5B,CAAC,EAAhC,EAAoC;AAClC8B,YAAAA,gBAAgB,GAAIA,gBAAgB,IAAI,CAArB,GAA2BV,KAAK,GAAC,CAApD;;AACA,gBAAIW,qBAAqB,IAAI,EAA7B,EAAiC;AAC/BA,cAAAA,qBAAqB,GAAG,CAAxB;AACAF,cAAAA,mBAAmB,IAAInB,CAAC,CAACoB,gBAAD,CAAxB;AACAA,cAAAA,gBAAgB,GAAG,CAAnB;AACD,aAJD,MAIO;AACLC,cAAAA,qBAAqB;AACtB;;AACDX,YAAAA,KAAK,GAAGA,KAAK,IAAI,CAAjB;AACD;AAGF;;AACDM,QAAAA,iBAAiB;;AACjB,YAAIA,iBAAiB,IAAI,CAAzB,EAA4B;AAC1BA,UAAAA,iBAAiB,GAAGW,IAAI,CAACC,GAAL,CAAS,CAAT,EAAYV,eAAZ,CAApB;AACAA,UAAAA,eAAe;AAChB;AACF,OA9L+B,CAgMhC;;;AACAR,MAAAA,KAAK,GAAG,CAAR;;AACA,WAAKpB,CAAC,GAAC,CAAP,EAAWA,CAAC,GAAC4B,eAAb,EAA+B5B,CAAC,EAAhC,EAAoC;AAClC8B,QAAAA,gBAAgB,GAAIA,gBAAgB,IAAI,CAArB,GAA2BV,KAAK,GAAC,CAApD;;AACA,YAAIW,qBAAqB,IAAI,EAA7B,EAAiC;AAC/BA,UAAAA,qBAAqB,GAAG,CAAxB;AACAF,UAAAA,mBAAmB,IAAInB,CAAC,CAACoB,gBAAD,CAAxB;AACAA,UAAAA,gBAAgB,GAAG,CAAnB;AACD,SAJD,MAIO;AACLC,UAAAA,qBAAqB;AACtB;;AACDX,QAAAA,KAAK,GAAGA,KAAK,IAAI,CAAjB;AACD,OA5M+B,CA8MhC;;;AACA,aAAO,IAAP,EAAa;AACXU,QAAAA,gBAAgB,GAAIA,gBAAgB,IAAI,CAAxC;;AACA,YAAIC,qBAAqB,IAAI,EAA7B,EAAiC;AAC/BF,UAAAA,mBAAmB,IAAInB,CAAC,CAACoB,gBAAD,CAAxB;AACA;AACD,SAHD,MAIKC,qBAAqB;AAC3B;;AACD,aAAOF,mBAAP;AACD,KAteY;AAwebhB,IAAAA,UAAU,EAAE,UAAU0B,UAAV,EAAsB;AAChC,UAAIA,UAAU,IAAI,IAAlB,EAAwB,OAAO,EAAP;AACxB,UAAIA,UAAU,IAAI,EAAlB,EAAsB,OAAO,IAAP;AACtB,UAAIC,UAAU,GAAG,EAAjB;AAAA,UACIC,IADJ;AAAA,UAEIC,SAAS,GAAG,CAFhB;AAAA,UAGIC,QAAQ,GAAG,CAHf;AAAA,UAIIC,OAAO,GAAG,CAJd;AAAA,UAKIC,KAAK,GAAG,EALZ;AAAA,UAMIC,MAAM,GAAG,EANb;AAAA,UAOI9C,CAPJ;AAAA,UAQI+C,CARJ;AAAA,UASIC,IATJ;AAAA,UASUC,IATV;AAAA,UASgBC,QAThB;AAAA,UAS0BC,KAT1B;AAAA,UAUIpC,CAVJ;AAAA,UAWIL,CAAC,GAAGzB,QAAQ,CAACE,EAXjB;AAAA,UAYIiE,IAAI,GAAG;AAACC,QAAAA,MAAM,EAACd,UAAR;AAAoBe,QAAAA,GAAG,EAACf,UAAU,CAACpC,UAAX,CAAsB,CAAtB,CAAxB;AAAkDoD,QAAAA,QAAQ,EAAC,KAA3D;AAAkEC,QAAAA,KAAK,EAAC;AAAxE,OAZX;;AAcA,WAAKxD,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG,CAAhB,EAAmBA,CAAC,IAAI,CAAxB,EAA2B;AACzBwC,QAAAA,UAAU,CAACxC,CAAD,CAAV,GAAgBA,CAAhB;AACD;;AAEDgD,MAAAA,IAAI,GAAG,CAAP;AACAE,MAAAA,QAAQ,GAAGb,IAAI,CAACC,GAAL,CAAS,CAAT,EAAW,CAAX,CAAX;AACAa,MAAAA,KAAK,GAAC,CAAN;;AACA,aAAOA,KAAK,IAAED,QAAd,EAAwB;AACtBD,QAAAA,IAAI,GAAGG,IAAI,CAACE,GAAL,GAAWF,IAAI,CAACG,QAAvB;AACAH,QAAAA,IAAI,CAACG,QAAL,KAAkB,CAAlB;;AACA,YAAIH,IAAI,CAACG,QAAL,IAAiB,CAArB,EAAwB;AACtBH,UAAAA,IAAI,CAACG,QAAL,GAAgB,KAAhB;AACAH,UAAAA,IAAI,CAACE,GAAL,GAAWF,IAAI,CAACC,MAAL,CAAYlD,UAAZ,CAAuBiD,IAAI,CAACI,KAAL,EAAvB,CAAX;AACD;;AACDR,QAAAA,IAAI,IAAI,CAACC,IAAI,GAAC,CAAL,GAAS,CAAT,GAAa,CAAd,IAAmBE,KAA3B;AACAA,QAAAA,KAAK,KAAK,CAAV;AACD;;AAED,cAAQV,IAAI,GAAGO,IAAf;AACE,aAAK,CAAL;AACIA,UAAAA,IAAI,GAAG,CAAP;AACAE,UAAAA,QAAQ,GAAGb,IAAI,CAACC,GAAL,CAAS,CAAT,EAAW,CAAX,CAAX;AACAa,UAAAA,KAAK,GAAC,CAAN;;AACA,iBAAOA,KAAK,IAAED,QAAd,EAAwB;AACtBD,YAAAA,IAAI,GAAGG,IAAI,CAACE,GAAL,GAAWF,IAAI,CAACG,QAAvB;AACAH,YAAAA,IAAI,CAACG,QAAL,KAAkB,CAAlB;;AACA,gBAAIH,IAAI,CAACG,QAAL,IAAiB,CAArB,EAAwB;AACtBH,cAAAA,IAAI,CAACG,QAAL,GAAgB,KAAhB;AACAH,cAAAA,IAAI,CAACE,GAAL,GAAWF,IAAI,CAACC,MAAL,CAAYlD,UAAZ,CAAuBiD,IAAI,CAACI,KAAL,EAAvB,CAAX;AACD;;AACDR,YAAAA,IAAI,IAAI,CAACC,IAAI,GAAC,CAAL,GAAS,CAAT,GAAa,CAAd,IAAmBE,KAA3B;AACAA,YAAAA,KAAK,KAAK,CAAV;AACD;;AACHpC,UAAAA,CAAC,GAAGL,CAAC,CAACsC,IAAD,CAAL;AACA;;AACF,aAAK,CAAL;AACIA,UAAAA,IAAI,GAAG,CAAP;AACAE,UAAAA,QAAQ,GAAGb,IAAI,CAACC,GAAL,CAAS,CAAT,EAAW,EAAX,CAAX;AACAa,UAAAA,KAAK,GAAC,CAAN;;AACA,iBAAOA,KAAK,IAAED,QAAd,EAAwB;AACtBD,YAAAA,IAAI,GAAGG,IAAI,CAACE,GAAL,GAAWF,IAAI,CAACG,QAAvB;AACAH,YAAAA,IAAI,CAACG,QAAL,KAAkB,CAAlB;;AACA,gBAAIH,IAAI,CAACG,QAAL,IAAiB,CAArB,EAAwB;AACtBH,cAAAA,IAAI,CAACG,QAAL,GAAgB,KAAhB;AACAH,cAAAA,IAAI,CAACE,GAAL,GAAWF,IAAI,CAACC,MAAL,CAAYlD,UAAZ,CAAuBiD,IAAI,CAACI,KAAL,EAAvB,CAAX;AACD;;AACDR,YAAAA,IAAI,IAAI,CAACC,IAAI,GAAC,CAAL,GAAS,CAAT,GAAa,CAAd,IAAmBE,KAA3B;AACAA,YAAAA,KAAK,KAAK,CAAV;AACD;;AACHpC,UAAAA,CAAC,GAAGL,CAAC,CAACsC,IAAD,CAAL;AACA;;AACF,aAAK,CAAL;AACE,iBAAO,EAAP;AAlCJ;;AAoCAR,MAAAA,UAAU,CAAC,CAAD,CAAV,GAAgBzB,CAAhB;AACAgC,MAAAA,CAAC,GAAGD,MAAM,GAAG/B,CAAb;;AACA,aAAO,IAAP,EAAa;AACX,YAAIqC,IAAI,CAACI,KAAL,GAAaJ,IAAI,CAACC,MAAL,CAAYnD,MAA7B,EAAqC;AACnC,iBAAO,EAAP;AACD;;AAED8C,QAAAA,IAAI,GAAG,CAAP;AACAE,QAAAA,QAAQ,GAAGb,IAAI,CAACC,GAAL,CAAS,CAAT,EAAWM,OAAX,CAAX;AACAO,QAAAA,KAAK,GAAC,CAAN;;AACA,eAAOA,KAAK,IAAED,QAAd,EAAwB;AACtBD,UAAAA,IAAI,GAAGG,IAAI,CAACE,GAAL,GAAWF,IAAI,CAACG,QAAvB;AACAH,UAAAA,IAAI,CAACG,QAAL,KAAkB,CAAlB;;AACA,cAAIH,IAAI,CAACG,QAAL,IAAiB,CAArB,EAAwB;AACtBH,YAAAA,IAAI,CAACG,QAAL,GAAgB,KAAhB;AACAH,YAAAA,IAAI,CAACE,GAAL,GAAWF,IAAI,CAACC,MAAL,CAAYlD,UAAZ,CAAuBiD,IAAI,CAACI,KAAL,EAAvB,CAAX;AACD;;AACDR,UAAAA,IAAI,IAAI,CAACC,IAAI,GAAC,CAAL,GAAS,CAAT,GAAa,CAAd,IAAmBE,KAA3B;AACAA,UAAAA,KAAK,KAAK,CAAV;AACD;;AAED,gBAAQpC,CAAC,GAAGiC,IAAZ;AACE,eAAK,CAAL;AACEA,YAAAA,IAAI,GAAG,CAAP;AACAE,YAAAA,QAAQ,GAAGb,IAAI,CAACC,GAAL,CAAS,CAAT,EAAW,CAAX,CAAX;AACAa,YAAAA,KAAK,GAAC,CAAN;;AACA,mBAAOA,KAAK,IAAED,QAAd,EAAwB;AACtBD,cAAAA,IAAI,GAAGG,IAAI,CAACE,GAAL,GAAWF,IAAI,CAACG,QAAvB;AACAH,cAAAA,IAAI,CAACG,QAAL,KAAkB,CAAlB;;AACA,kBAAIH,IAAI,CAACG,QAAL,IAAiB,CAArB,EAAwB;AACtBH,gBAAAA,IAAI,CAACG,QAAL,GAAgB,KAAhB;AACAH,gBAAAA,IAAI,CAACE,GAAL,GAAWF,IAAI,CAACC,MAAL,CAAYlD,UAAZ,CAAuBiD,IAAI,CAACI,KAAL,EAAvB,CAAX;AACD;;AACDR,cAAAA,IAAI,IAAI,CAACC,IAAI,GAAC,CAAL,GAAS,CAAT,GAAa,CAAd,IAAmBE,KAA3B;AACAA,cAAAA,KAAK,KAAK,CAAV;AACD;;AAEDX,YAAAA,UAAU,CAACG,QAAQ,EAAT,CAAV,GAAyBjC,CAAC,CAACsC,IAAD,CAA1B;AACAjC,YAAAA,CAAC,GAAG4B,QAAQ,GAAC,CAAb;AACAD,YAAAA,SAAS;AACT;;AACF,eAAK,CAAL;AACEM,YAAAA,IAAI,GAAG,CAAP;AACAE,YAAAA,QAAQ,GAAGb,IAAI,CAACC,GAAL,CAAS,CAAT,EAAW,EAAX,CAAX;AACAa,YAAAA,KAAK,GAAC,CAAN;;AACA,mBAAOA,KAAK,IAAED,QAAd,EAAwB;AACtBD,cAAAA,IAAI,GAAGG,IAAI,CAACE,GAAL,GAAWF,IAAI,CAACG,QAAvB;AACAH,cAAAA,IAAI,CAACG,QAAL,KAAkB,CAAlB;;AACA,kBAAIH,IAAI,CAACG,QAAL,IAAiB,CAArB,EAAwB;AACtBH,gBAAAA,IAAI,CAACG,QAAL,GAAgB,KAAhB;AACAH,gBAAAA,IAAI,CAACE,GAAL,GAAWF,IAAI,CAACC,MAAL,CAAYlD,UAAZ,CAAuBiD,IAAI,CAACI,KAAL,EAAvB,CAAX;AACD;;AACDR,cAAAA,IAAI,IAAI,CAACC,IAAI,GAAC,CAAL,GAAS,CAAT,GAAa,CAAd,IAAmBE,KAA3B;AACAA,cAAAA,KAAK,KAAK,CAAV;AACD;;AACDX,YAAAA,UAAU,CAACG,QAAQ,EAAT,CAAV,GAAyBjC,CAAC,CAACsC,IAAD,CAA1B;AACAjC,YAAAA,CAAC,GAAG4B,QAAQ,GAAC,CAAb;AACAD,YAAAA,SAAS;AACT;;AACF,eAAK,CAAL;AACE,mBAAOI,MAAP;AAvCJ;;AA0CA,YAAIJ,SAAS,IAAI,CAAjB,EAAoB;AAClBA,UAAAA,SAAS,GAAGL,IAAI,CAACC,GAAL,CAAS,CAAT,EAAYM,OAAZ,CAAZ;AACAA,UAAAA,OAAO;AACR;;AAED,YAAIJ,UAAU,CAACzB,CAAD,CAAd,EAAmB;AACjB8B,UAAAA,KAAK,GAAGL,UAAU,CAACzB,CAAD,CAAlB;AACD,SAFD,MAEO;AACL,cAAIA,CAAC,KAAK4B,QAAV,EAAoB;AAClBE,YAAAA,KAAK,GAAGE,CAAC,GAAGA,CAAC,CAACzC,MAAF,CAAS,CAAT,CAAZ;AACD,WAFD,MAEO;AACL,mBAAO,IAAP;AACD;AACF;;AACDwC,QAAAA,MAAM,IAAID,KAAV,CA3EW,CA6EX;;AACAL,QAAAA,UAAU,CAACG,QAAQ,EAAT,CAAV,GAAyBI,CAAC,GAAGF,KAAK,CAACvC,MAAN,CAAa,CAAb,CAA7B;AACAoC,QAAAA,SAAS;AAETK,QAAAA,CAAC,GAAGF,KAAJ;;AAEA,YAAIH,SAAS,IAAI,CAAjB,EAAoB;AAClBA,UAAAA,SAAS,GAAGL,IAAI,CAACC,GAAL,CAAS,CAAT,EAAYM,OAAZ,CAAZ;AACAA,UAAAA,OAAO;AACR;AAEF;AACF;AA1oBY,GAAf;;AA6oBA,MAAI,OAAOa,MAAP,KAAkB,WAAlB,IAAiCA,MAAM,IAAI,IAA/C,EAAsD;AACpDA,IAAAA,MAAM,CAACC,OAAP,GAAiBzE,QAAjB;AACD,GA5pB8B,CA8pB/B;AAEA;AACA;AAEA;AACA;;;AAGA,GAAC,YAAU;AAET;AACA,QAAI,OAAOF,MAAM,CAAC4E,WAAd,KAA8B,WAAlC,EAA+C;AAC3C5E,MAAAA,MAAM,CAAC4E,WAAP,GAAqB,EAArB;AACH;;AAED,QAAI,CAAC5E,MAAM,CAAC4E,WAAP,CAAmBC,GAAxB,EAA4B;AAE1B,UAAIC,SAAS,GAAGC,IAAI,CAACF,GAAL,EAAhB;;AAEA,UAAID,WAAW,CAACI,MAAZ,IAAsBJ,WAAW,CAACI,MAAZ,CAAmBC,eAA7C,EAA6D;AAC3DH,QAAAA,SAAS,GAAGF,WAAW,CAACI,MAAZ,CAAmBC,eAA/B;AACD;;AAGDjF,MAAAA,MAAM,CAAC4E,WAAP,CAAmBC,GAAnB,GAAyB,SAASA,GAAT,GAAc;AACrC,eAAOE,IAAI,CAACF,GAAL,KAAaC,SAApB;AACD,OAFD;AAID;AAEF,GAtBD;;AAuBA,WAASI,SAAT,CAAoBC,OAApB,EAA4B;AAC1B,SAAKA,OAAL,GAAeA,OAAO,KAAKA,OAAO,GAAG,EAAf,CAAtB;AACA,SAAKC,OAAL,GAAe,KAAf;AACA,SAAKC,gBAAL,GAAwBF,OAAO,CAACE,gBAAR,IAA4B,EAApD,CAH0B,CAK1B;;AACA,SAAKC,gBAAL,GAAwB,CACtB,IADsB,EAEtB,WAFsB,EAGtB;AACA;AACA;AAACC,MAAAA,KAAK,EAAE,CAAC,CACP,IADO,EAEP,MAFO,EAGP,WAHO,EAIP,YAJO,EAKP,cALO,EAMP,cANO,EAOP,wBAPO,EAQP,eARO,EASP,cATO,EAUP,YAVO,EAWP,UAXO,EAYP,UAZO,EAaP,OAbO,EAcP,OAdO,CAeP;AAfO,OAAD;AAAR,KALsB,EAsBtB;AAACC,MAAAA,UAAU,EAAE,CAAC,CACZ,IADY,EAEZ,WAFY,EAGZ,QAHY,EAIZ,QAJY,EAKZ,uBALY,EAMZ,aANY,EAOZ,aAPY,EAQZ,MARY,EASZ,cATY,EAUZ,aAVY,EAWZ,aAXY,EAYZ,aAZY,EAaZ,cAbY,EAcZ,OAdY,EAeZ,MAfY,CAgBZ;AAhBY,OAAD;AAAb,KAtBsB,EAwCtB;AAACC,MAAAA,cAAc,EAAE,CACf,QADe,EACL,MADK;AAAjB,KAxCsB,CAAxB;AA6CA,SAAKC,SAAL,CAAeP,OAAO,CAACQ,MAAR,IAAkB,EAAjC;AACD;;AAGDT,EAAAA,SAAS,CAAC/B,SAAV,GAAsB;AAEpBuC,IAAAA,SAAS,EAAE,UAAUC,MAAV,EAAkB;AAC3B,WAAKC,SAAL,GAAiBD,MAAjB;AACA,WAAKE,UAAL,GAAkB,CAAlB;AACA,WAAKC,UAAL,GAAkBH,MAAM,CAACxE,MAAzB;AACA,WAAK4E,gBAAL,GAAwB,CAAxB;AACA,WAAKC,iBAAL,GAAyB,KAAKF,UAA9B;AACA,WAAKG,WAAL;AACD,KATmB;AAWpBC,IAAAA,QAAQ,EAAE,UAASN,SAAT,EAAmB;AAC3B,WAAKA,SAAL,CAAeO,IAAf,CAAoBP,SAApB;AACD,KAbmB;AAepBQ,IAAAA,YAAY,EAAE,YAAY;AACxB,aAAO,KAAKR,SAAL,CAAe,KAAKC,UAApB,CAAP;AACD,KAjBmB;AAmBpBQ,IAAAA,SAAS,EAAE,YAAY;AACrB,UAAIR,UAAU,GAAG,KAAKA,UAAL,GAAkB,CAAnC,CADqB,CAErB;;AACAA,MAAAA,UAAU,GAAGA,UAAU,IAAI,KAAKG,iBAAL,IAA0B,CAA9B,CAAvB;;AACA,UAAKH,UAAU,GAAG,KAAKE,gBAAvB,EAA0C;AACxCF,QAAAA,UAAU,GAAG,KAAKE,gBAAlB;AACD;;AACD,aAAO,KAAKH,SAAL,CAAeC,UAAf,CAAP;AACD,KA3BmB;AA8BpBS,IAAAA,YAAY,EAAE,YAAY;AACxB,WAAKT,UAAL;;AAEA,UAAI,KAAKA,UAAL,IAAmB,KAAKG,iBAAxB,IAA6C,CAAC,KAAKb,OAAL,CAAaoB,IAA/D,EAAqE;AACnE,aAAKV,UAAL,GADmE,CAEnE;AACA;AACA;;AACA,eAAO,KAAP;AACD;;AAGD,WAAKA,UAAL,GAAkB,KAAKA,UAAL,IAAmB,KAAKG,iBAAL,IAA0B,CAA7C,CAAlB;;AAEA,UAAK,KAAKH,UAAL,GAAkB,KAAKE,gBAA5B,EAA+C;AAC7C,aAAKF,UAAL,GAAkB,KAAKE,gBAAvB;AACD;;AAED,aAAO,IAAP;AACD,KAjDmB;AAmDpB;AACAS,IAAAA,SAAS,EAAE,YAAU;AACnB,WAAKX,UAAL;;AACA,UAAI,KAAKA,UAAL,IAAmB,KAAKG,iBAA5B,EAA+C;AAC7C,aAAKH,UAAL,GAAkB,KAAKA,UAAL,IAAmB,KAAKG,iBAAL,IAA0B,CAA7C,CAAlB;;AAEA,YAAK,KAAKH,UAAL,GAAkB,KAAKE,gBAA5B,EAA+C;AAC7C,eAAKF,UAAL,GAAkB,KAAKE,gBAAvB;AACD;AACF,OAND,MAMK;AACH,aAAKF,UAAL;AACD;AACF,KA/DmB;AAiEpBY,IAAAA,iBAAiB,EAAE,YAAU;AAC3B,aAAOC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAe,KAAKR,YAAL,EAAf,CAAX,CAAP;AACD,KAnEmB;AAsEpB;AACA;AACA;AACA;AACAS,IAAAA,mBAAmB,EAAE,UAASC,CAAT,EAAW;AAC9B;AACA,UAAIV,YAAY,GAAG,KAAKA,YAAL,EAAnB;AAAA,UACIC,SAAS,GAAG,KAAKA,SAAL,EADhB;AAAA,UAEIU,SAAS,GAAK,CAAC,cAAD,EAAiB,wBAAjB,EAA2C,cAA3C,EAA2D,WAA3D,EAAwE,YAAxE,EAAsF,cAAtF,CAFlB;AAAA,UAGIC,WAAW,GAAG,CAAC,aAAD,EAAgB,aAAhB,EAA+B,aAA/B,EAA8C,aAA9C,EAA6D,WAA7D,CAHlB;AAAA,UAIIpB,SAAS,GAAG,KAAKa,iBAAL,EAJhB;AAAA,UAKIQ,QAAQ,GAAGrB,SAAS,CAACL,KAAV,CAAgBpE,MAL/B;AAAA,UAMI+F,aAAa,GAAGtB,SAAS,CAACJ,UAAV,CAAqBrE,MANzC;AAAA,UAOIgG,IAAI,GAAGJ,SAAS,CAAC5F,MAPrB;AAAA,UAQIiG,IAAI,GAAGJ,WAAW,CAAC7F,MARvB;AAAA,UASIkG,IATJ;AAAA,UASUC,IATV;AAAA,UASgBC,SAThB;;AAWA,WAAK,IAAItG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGgG,QAApB,EAA8BhG,CAAC,EAA/B,EAAkC;AAChCqG,QAAAA,IAAI,GAAG1B,SAAS,CAACL,KAAV,CAAgBtE,CAAhB,CAAP;;AAEA,aAAK,IAAIuG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGL,IAApB,EAA0BK,CAAC,EAA3B,EAA8B;AAC5BH,UAAAA,IAAI,GAAGN,SAAS,CAACS,CAAD,CAAhB;;AAEA,cAAI,CAACpB,YAAY,CAACb,KAAb,CAAmBtE,CAAnB,EAAsBoG,IAAtB,CAAL,EAAiC;AAC/B;AACD;;AAED,cAAI,CAAChB,SAAS,CAACd,KAAV,CAAgBtE,CAAhB,CAAL,EAAwB;AACtB;AACD;;AAEDwG,UAAAA,IAAI,CAACC,IAAL,CAAUC,IAAV,CACEL,IAAI,CAACD,IAAD,CADN,EAEEjB,YAAY,CAACb,KAAb,CAAmBtE,CAAnB,EAAsBoG,IAAtB,CAFF,EAGEhB,SAAS,CAACd,KAAV,CAAgBtE,CAAhB,EAAmBoG,IAAnB,CAHF,EAIEP,CAJF,EAX4B,CAkBpC;AACO;AAEF;;AAED,WAAM7F,CAAC,GAAG,CAAV,EAAaA,CAAC,GAAGiG,aAAjB,EAAgCjG,CAAC,EAAjC,EAAoC;AAClCsG,QAAAA,SAAS,GAAG3B,SAAS,CAACJ,UAAV,CAAqBvE,CAArB,CAAZ;;AAEA,aAAMuG,CAAC,GAAG,CAAV,EAAaA,CAAC,GAAGJ,IAAjB,EAAuBI,CAAC,EAAxB,EAA2B;AACzBH,UAAAA,IAAI,GAAGL,WAAW,CAACQ,CAAD,CAAlB;;AAEA,cAAI,CAACpB,YAAY,CAACZ,UAAb,CAAwBvE,CAAxB,EAA2BoG,IAA3B,CAAL,EAAsC;AACpC;AACD;;AAED,cAAI,CAAChB,SAAS,CAACd,KAAV,CAAgBtE,CAAhB,CAAL,EAAwB;AACtB;AACD;;AAEDwG,UAAAA,IAAI,CAACC,IAAL,CAAUC,IAAV,CACEJ,SAAS,CAACF,IAAD,CADX,EAEEjB,YAAY,CAACZ,UAAb,CAAwBvE,CAAxB,EAA2BoG,IAA3B,CAFF,EAGEhB,SAAS,CAACb,UAAV,CAAqBvE,CAArB,EAAwBoG,IAAxB,CAHF,EAIE,CAJF,EAXyB,CAiBjC;AACA;AAEO;AAEF;;AAED,aAAOzB,SAAP;AACD,KA7ImB;AA+IpB;AACAgC,IAAAA,eAAe,EAAE,YAAY;AAC3B,UAAIC,WAAW,GAAG,CAAC,KAAKxB,SAAL,GAAiByB,SAAjB,GAA6B,KAAK1B,YAAL,GAAoB0B,SAAlD,IAA+D,IAAjF;;AACA,UAAID,WAAW,GAAG,CAAlB,EAAqB;AACnBA,QAAAA,WAAW,GAAG,KAAKxC,gBAAnB,CADmB,CACkB;AACtC,OAJ0B,CAK/B;;;AACI,aAAOwC,WAAP;AACD,KAvJmB;AA0JpBE,IAAAA,KAAK,EAAE,YAAU;AACf,aAAO,KAAKnC,SAAL,CAAezE,MAAf,KAA0B,CAAjC;AACD,KA5JmB;AA8JpB;AACA6G,IAAAA,QAAQ,EAAE,YAAY;AACpB,WAAKjC,gBAAL,GAAwB,KAAKF,UAA7B;AACD,KAjKmB;AAmKpB;AACAoC,IAAAA,SAAS,EAAE,YAAY;AACrB,WAAKjC,iBAAL,GAAyB,KAAKH,UAA9B;AACD,KAtKmB;AAwKpB;AACA;AACA;AACAqC,IAAAA,UAAU,EAAE,UAAUC,MAAV,EAAkB;AAC5BC,MAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ,EAA2BF,MAA3B;AACAA,MAAAA,MAAM,KAAKA,MAAM,GAAG,CAAd,CAAN;;AACA,WAAK,IAAIlH,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAK2E,SAAL,CAAezE,MAAnC,EAA2CF,CAAC,EAA5C,EAAgD;AAC9C,aAAK2E,SAAL,CAAe0C,MAAf,CAAsBrH,CAAtB,EAAyBkH,MAAzB;AACD;;AACD,WAAKlC,WAAL;AACD,KAlLmB;AAoLpB;AACAsC,IAAAA,SAAS,EAAE,YAAY;AACrB,UAAI,KAAK3C,SAAL,CAAezE,MAAf,IAAyB,CAA7B,EAAgC;AAC9B,eAAO,CAAP;AACD;;AACD,aAAO,KAAKyE,SAAL,CAAezE,MAAf,IAAyB,KAAKyE,SAAL,CAAe,KAAKA,SAAL,CAAezE,MAAf,GAAwB,CAAvC,EAA0C2G,SAA1C,GAAsD,KAAKlC,SAAL,CAAe,CAAf,EAAkBkC,SAAjG,IAA8G,OAArH;AACD,KA1LmB;AA4LpB;AACAU,IAAAA,gBAAgB,EAAE,YAAY;AAC5B,aAAO,KAAK5C,SAAL,CAAe6C,KAAf,CAAqB,KAAK1C,gBAA1B,EAA4C,KAAKC,iBAAjD,CAAP;AACD,KA/LmB;AAkMpBC,IAAAA,WAAW,EAAE,YAAY;AAEvB,UAAIyC,WAAW,GAAG;AAChBC,QAAAA,aAAa,EAAE,CADC;AAEhBC,QAAAA,WAAW,EAAE,uBAFG;AAGhBjD,QAAAA,MAAM,EAAE,KAAKK,iBAAL,GAAyB,KAAKD,gBAHtB;AAIhB8C,QAAAA,eAAe,EAAE,KAAK1D,OAAL,CAAa2D,sBAJd;AAKhBC,QAAAA,cAAc,EAAE,KAAK5D,OAAL,CAAa4D,cALb;AAMhBR,QAAAA,SAAS,EAAE,KAAKA,SAAL,GAAiBS,WAAjB,CAA6B,CAA7B,CANK;AAOhBC,QAAAA,QAAQ,EAAG,IAAIlE,IAAJ,EAAD,CAAWmE,QAAX;AAPM,OAAlB;AAUA,WAAKC,QAAL,KAAkB,KAAKA,QAAL,GAAgB,EAAlC;;AAEA,WAAK,IAAIC,GAAT,IAAgBV,WAAhB,EAA6B;AAC3B,aAAKS,QAAL,CAAcC,GAAd,IAAqBV,WAAW,CAACU,GAAD,CAAhC;AACD;AACF,KAnNmB;AAqNpB;AACA;AACA;AACAC,IAAAA,eAAe,EAAE,YAAU;AACzB,UAAIzD,SAAS,GAAG,KAAK4C,gBAAL,EAAhB;AAAA,UACEc,YAAY,GAAG,EADjB;AAAA,UAEEC,UAFF;AAIAD,MAAAA,YAAY,CAACnD,IAAb,CAAkB,KAAKb,gBAAvB;;AAEA,WAAK,IAAIrE,CAAC,GAAG,CAAR,EAAWuI,GAAG,GAAG5D,SAAS,CAACzE,MAAhC,EAAwCF,CAAC,GAAGuI,GAA5C,EAAiDvI,CAAC,EAAlD,EAAqD;AACnDsI,QAAAA,UAAU,GAAG3D,SAAS,CAAC3E,CAAD,CAAtB;AAEAqI,QAAAA,YAAY,CAACnD,IAAb,CACE,KAAKsD,SAAL,CACE,KAAKnE,gBADP,EAEEiE,UAFF,CADF;AAOD;;AAED,aAAOD,YAAP;AACD,KA5OmB;AA8OpB;AACA;AACA;AACAG,IAAAA,SAAS,EAAE,UAASC,SAAT,EAAoBrF,IAApB,EAAyB;AAClC,UAAIsF,GAAG,GAAG,EAAV;AAAA,UAAcC,UAAd;;AAEA,WAAK,IAAI3I,CAAC,GAAG,CAAR,EAAWkG,IAAI,GAAGuC,SAAS,CAACvI,MAAjC,EAAyCF,CAAC,GAAGkG,IAA7C,EAAmDlG,CAAC,EAApD,EAAuD;AAErD;AACA2I,QAAAA,UAAU,GAAGF,SAAS,CAACzI,CAAD,CAAtB;;AAEA,YAAK,OAAQ2I,UAAR,KAAuB,QAA5B,EAAqC;AAEnCD,UAAAA,GAAG,CAACxD,IAAJ,CACE9B,IAAI,CAACuF,UAAD,CADN;AAID,SAND,MAMM,IAAI1G,MAAM,CAACC,SAAP,CAAiB+F,QAAjB,CAA0B7F,IAA1B,CAA+BuG,UAA/B,KAA8C,gBAAlD,EAAoE;AACxE;AAEA,eAAK,IAAIpC,CAAC,GAAG,CAAR,EAAWJ,IAAI,GAAG/C,IAAI,CAAClD,MAA5B,EAAoCqG,CAAC,GAAGJ,IAAxC,EAA8CI,CAAC,EAA/C,EAAkD;AAChDmC,YAAAA,GAAG,CAACxD,IAAJ,CACE,KAAKsD,SAAL,CACEG,UADF,EAEEvF,IAAI,CAACmD,CAAD,CAFN,CADF;AAMD;AAEF,SAZK,MAYC;AAAE;AAEf;AAEQ,eAAK,IAAI4B,GAAT,IAAgBQ,UAAhB,EAA4B,MAJvB,CAMb;AACA;AACA;;;AAEQD,UAAAA,GAAG,CAACxD,IAAJ,CAAS,KAAKsD,SAAL,CACPG,UAAU,CAACR,GAAD,CADH,EAEP/E,IAAI,CAAC+E,GAAD,CAFG,CAAT;AAKD;AAEF;;AAED,aAAOO,GAAP;AACD,KA/RmB;AAiSpB;AACA;AACA;AACAE,IAAAA,eAAe,EAAE,UAASP,YAAT,EAAsB;AACrC,UAAIhE,gBAAgB,GAAGgE,YAAY,CAAC,CAAD,CAAnC;AACA,UAAI1D,SAAS,GAAG,EAAhB;AAAA,UACI2D,UADJ;;AAGA,WAAK,IAAItI,CAAC,GAAG,CAAR,EAAWuI,GAAG,GAAGF,YAAY,CAACnI,MAAnC,EAA2CF,CAAC,GAAGuI,GAA/C,EAAoDvI,CAAC,EAArD,EAAyD;AACvDsI,QAAAA,UAAU,GAAGD,YAAY,CAACrI,CAAD,CAAzB;AACA2E,QAAAA,SAAS,CAACO,IAAV,CACE,KAAK2D,WAAL,CACExE,gBADF,EAEEiE,UAFF,CADF;AAOD;;AAED,aAAO3D,SAAP;AACD,KArTmB;AAuTpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAkE,IAAAA,WAAW,EAAE,UAASJ,SAAT,EAAoBrF,IAApB,EAAyB;AACpC,UAAIsF,GAAG,GAAG,EAAV;AAAA,UAAcC,UAAd;;AAEA,WAAK,IAAI3I,CAAC,GAAG,CAAR,EAAWkG,IAAI,GAAGuC,SAAS,CAACvI,MAAjC,EAAyCF,CAAC,GAAGkG,IAA7C,EAAmDlG,CAAC,EAApD,EAAuD;AAEtD;AACA2I,QAAAA,UAAU,GAAGF,SAAS,CAACzI,CAAD,CAAtB;;AAEA,YAAK,OAAQ2I,UAAR,KAAuB,QAA5B,EAAqC;AAEnCD,UAAAA,GAAG,CAACC,UAAD,CAAH,GAAkBvF,IAAI,CAACpD,CAAD,CAAtB;AAED,SAJD,MAIM,IAAIiC,MAAM,CAACC,SAAP,CAAiB+F,QAAjB,CAA0B7F,IAA1B,CAA+BuG,UAA/B,KAA8C,gBAAlD,EAAoE;AACxE;AACA;AACA;AAEA,cAAIG,QAAQ,GAAG,EAAf;;AAEA,eAAK,IAAIvC,CAAC,GAAG,CAAR,EAAWJ,IAAI,GAAG/C,IAAI,CAAClD,MAA5B,EAAoCqG,CAAC,GAAGJ,IAAxC,EAA8CI,CAAC,EAA/C,EAAkD;AAChDuC,YAAAA,QAAQ,CAAC5D,IAAT,CACE,KAAK2D,WAAL,CACEF,UADF,EAEEvF,IAAI,CAACmD,CAAD,CAFN,CADF;AAMD;;AACD,iBAAOuC,QAAP;AAED,SAjBK,MAiBC;AAAE;AAEP,eAAK,IAAIX,GAAT,IAAgBQ,UAAhB,EAA4B;;AAE5BD,UAAAA,GAAG,CAACP,GAAD,CAAH,GAAW,KAAKU,WAAL,CACTF,UAAU,CAACR,GAAD,CADD,EAET/E,IAAI,CAACpD,CAAD,CAFK,CAAX;AAKD;AAED;;AAED,aAAO0I,GAAP;AACD,KA9XmB;AAgYpBK,IAAAA,MAAM,EAAE,YAAY;AAClB,WAAK/D,WAAL;AACA,aAAO;AACLkD,QAAAA,QAAQ,EAAE,KAAKA,QADV;AAELxD,QAAAA,MAAM,EAAE,KAAK0D,eAAL;AAFH,OAAP;AAID,KAtYmB;AAwYpB;AACA;AACAY,IAAAA,MAAM,EAAE,UAAUC,MAAV,EAAkB;AACxB,UAAIC,IAAI,GAAGzD,IAAI,CAACE,SAAL,CAAe,KAAKoD,MAAL,EAAf,CAAX;AAEA,UAAIE,MAAM,IAAI,MAAd,EAAsB,OAAOC,IAAP;AAEtB,aAAOjK,QAAQ,CAACK,gBAAT,CAA0B4J,IAA1B,CAAP;AACD,KAhZmB;AAkZpBC,IAAAA,IAAI,EAAE,UAASF,MAAT,EAAgB;AACpB,UAAIG,QAAJ;AAEAA,MAAAA,QAAQ,GAAG,KAAKlB,QAAL,CAAcmB,KAAd,GAAsB,KAAKnB,QAAL,CAAcmB,KAAd,CAAoB1I,OAApB,CAA4B,KAA5B,EAAmC,EAAnC,CAAtB,GAA+D,yBAA1E;;AAEA,UAAI,KAAKuH,QAAL,CAAcZ,SAAlB,EAA6B;AAC3B8B,QAAAA,QAAQ,IAAI,MAAO/G,IAAI,CAACiH,KAAL,CAAW,KAAKpB,QAAL,CAAcZ,SAAzB,CAAP,GAA8C,KAA1D;AACD;;AAED,UAAI2B,MAAM,KAAK,MAAf,EAAuB;AAErBM,QAAAA,MAAM,CAAC,IAAIC,IAAJ,CAAS,CAAC,KAAKR,MAAL,CAAY,MAAZ,CAAD,CAAT,EAAgC;AACrCS,UAAAA,IAAI,EAAE;AAD+B,SAAhC,CAAD,EAEFL,QAAQ,GAAG,OAFT,CAAN;AAID,OAND,MAMO;AAELG,QAAAA,MAAM,CAAC,IAAIC,IAAJ,CAAS,CAAC,KAAKR,MAAL,CAAY,IAAZ,CAAD,CAAT,EAA8B;AACnCS,UAAAA,IAAI,EAAE;AAD6B,SAA9B,CAAD,EAEDL,QAAQ,GAAG,UAFV,CAAN;AAID;AAEF,KAzamB;AA2apBvI,IAAAA,UAAU,EAAE,UAAUuC,IAAV,EAAgB;AAC1B,aAAOnE,QAAQ,CAACsB,oBAAT,CAA8B6C,IAA9B,CAAP;AACD,KA7amB;AA+apBsG,IAAAA,MAAM,EAAE,YAAU;AAChB,aAAO,CAAC,EAAE,KAAK/E,SAAL,IAAkB,KAAKA,SAAL,CAAezE,MAAnC,CAAR;AACD,KAjbmB;AAobpB;AACAyJ,IAAAA,aAAa,EAAE,UAAUC,QAAV,EAAoB;AACjC,UAAIC,GAAG,GAAG,IAAIC,cAAJ,EAAV;AAAA,UACIC,GAAG,GAAG,KAAKA,GADf;AAAA,UAEIC,SAAS,GAAG,IAFhB;AAAA,UAGIC,aAAa,GAAG,CAHpB;;AAKAJ,MAAAA,GAAG,CAACK,kBAAJ,GAAyB,YAAY;AACnC,YAAIL,GAAG,CAACM,UAAJ,KAAmBN,GAAG,CAACO,IAA3B,EAAiC;AAC/B,cAAIP,GAAG,CAAC5I,MAAJ,KAAe,GAAf,IAAsB4I,GAAG,CAAC5I,MAAJ,KAAe,CAAzC,EAA4C;AAC1C,gBAAI4I,GAAG,CAACQ,YAAR,EAAsB;AAEpBL,cAAAA,SAAS,CAACM,UAAV,CAAqBT,GAAG,CAACQ,YAAzB,EAAuCT,QAAvC;AAED,aAJD,MAIO;AACLzC,cAAAA,OAAO,CAACoD,KAAR,CAAc,qBAAqBR,GAArB,GAA2B,iDAAzC;AACD;AACF,WARD,MAQO;AACL5C,YAAAA,OAAO,CAACoD,KAAR,CAAc,oCAAoCR,GAApC,GAA0C,KAA1C,GAAkDF,GAAG,CAAC5I,MAAtD,GAA+D,GAA7E;AACD;AACF;AACF,OAdD;;AAgBA4I,MAAAA,GAAG,CAACW,gBAAJ,CAAqB,UAArB,EAAiC,UAASC,MAAT,EAAgB;AAE/C,YAAKT,SAAS,CAAC9F,OAAV,CAAkBwG,YAAvB,EAAsC;AAEpC,cAAID,MAAM,CAACE,gBAAX,EAA6B;AAC3B,gBAAIC,eAAe,GAAGH,MAAM,CAACf,MAAP,GAAgBe,MAAM,CAACI,KAA7C;AACAb,YAAAA,SAAS,CAAC9F,OAAV,CAAkBwG,YAAlB,CAAgCV,SAAhC,EAA2CY,eAA3C,EAA4DH,MAA5D;AACD;AAEF;AAEF,OAXD;AAaA,WAAKtG,OAAL,GAAe,IAAf;AAEA0F,MAAAA,GAAG,CAACiB,IAAJ,CAAS,KAAT,EAAgBf,GAAhB,EAAqB,IAArB;AACAF,MAAAA,GAAG,CAACkB,IAAJ,CAAS,IAAT;AACD,KA5dmB;AA8dpBT,IAAAA,UAAU,EAAE,UAASU,YAAT,EAAuBpB,QAAvB,EAAgC;AAE1C,UAAIG,GAAG,GAAG,KAAKA,GAAf;;AAEA,UAAIA,GAAG,CAACkB,KAAJ,CAAU,GAAV,EAAelB,GAAG,CAACkB,KAAJ,CAAU,GAAV,EAAe/K,MAAf,GAAwB,CAAvC,KAA6C,IAAjD,EAAuD;AACrD8K,QAAAA,YAAY,GAAG,KAAKnK,UAAL,CAAgBmK,YAAhB,CAAf;AACD;;AAEDA,MAAAA,YAAY,GAAGvF,IAAI,CAACC,KAAL,CAAWsF,YAAX,CAAf;;AAEA,UAAIA,YAAY,CAAC9C,QAAb,CAAsBR,aAAtB,IAAuC,CAA3C,EAA8C;AAC5CsD,QAAAA,YAAY,CAACtG,MAAb,GAAsB,KAAKkE,eAAL,CAAqBoC,YAAY,CAACtG,MAAlC,CAAtB;AACD;;AAED,WAAKwD,QAAL,GAAgB8C,YAAY,CAAC9C,QAA7B;AAEAf,MAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ,EAAiC,KAAKc,QAAtC;AAEA,WAAK/D,OAAL,GAAe,KAAf;;AAEA,UAAIyF,QAAJ,EAAc;AACZA,QAAAA,QAAQ,CAACxH,IAAT,CAAc,IAAd,EAAoB4I,YAAY,CAACtG,MAAjC;AACD;AAEF,KAtfmB;AAwfpBwG,IAAAA,uBAAuB,EAAE,UAASC,cAAT,EAAyBvB,QAAzB,EAAmC;AAC1D,UAAIwB,gBAAgB,GAAG,KAAKvK,UAAL,CAAgBsK,cAAhB,CAAvB;AACAC,MAAAA,gBAAgB,GAAG3F,IAAI,CAACC,KAAL,CAAW0F,gBAAX,CAAnB;;AACA,UAAIA,gBAAgB,CAAClD,QAAjB,CAA0BR,aAA1B,IAA2C,CAA/C,EAAkD;AAChD0D,QAAAA,gBAAgB,CAAC1G,MAAjB,GAA0B,KAAKkE,eAAL,CAAqBwC,gBAAgB,CAAC1G,MAAtC,CAA1B;AACD;;AAED,WAAKwD,QAAL,GAAgBkD,gBAAgB,CAAClD,QAAjC;AAEAf,MAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ,EAAiC,KAAKc,QAAtC;AAEA,WAAK/D,OAAL,GAAe,KAAf;;AAEA,UAAIyF,QAAJ,EAAc;AACZA,QAAAA,QAAQ,CAACxH,IAAT,CAAc,IAAd,EAAoBgJ,gBAAgB,CAAC1G,MAArC;AACD;AACF;AAxgBmB,GAAtB;AA2gBA,GAAC,YAAY;AACX,QAAI2G,iBAAiB,GAAG,q/SAAxB;AACA,QAAIC,wBAAwB,GAAG,4hTAA/B;;AAGA,aAASC,MAAT,CAAgBC,UAAhB,EAA4BtH,OAA5B,EAAqC;AACnC,UAAIuH,MAAM,GAAG,IAAb;AACAvH,MAAAA,OAAO,KAAKA,OAAO,GAAG,EAAf,CAAP,CAFmC,CAIvC;;AAEI,WAAKA,OAAL,GAAeA,OAAf;AACA,WAAK8F,SAAL,GAAiB9F,OAAO,CAAC8F,SAAzB;AAEA,WAAKwB,UAAL,GAAkBA,UAAlB;AACA,WAAKE,WAAL;AACA,WAAKC,UAAL;AACA,WAAKH,UAAL,CAAgBI,UAAhB,CAA2BC,EAA3B,CAA8B,OAA9B,EAAuC,YAAY;AACjDJ,QAAAA,MAAM,CAACK,cAAP;AACD,OAFD;AAIA,WAAKC,cAAL,GAAsB,KAAtB;;AAGA,UAAI7H,OAAO,CAAC8F,SAAZ,EAAuB;AACrB,YAAI/H,MAAM,CAACC,SAAP,CAAiB+F,QAAjB,CAA0B7F,IAA1B,CAA+B8B,OAAO,CAAC8F,SAAvC,KAAqD,iBAAzD,EAA4E;AAC1E9F,UAAAA,OAAO,CAAC8F,SAAR,GAAoB;AAClBD,YAAAA,GAAG,EAAE7F,OAAO,CAAC8F;AADK,WAApB;AAGD;;AACD,aAAKgC,YAAL,CAAkB9H,OAAO,CAAC8F,SAA1B;AACD;;AAEDiC,MAAAA,QAAQ,CAACzB,gBAAT,CAA0B,kBAA1B,EAA8C,UAAS0B,KAAT,EAAgB;AAC5DD,QAAAA,QAAQ,CAACE,IAAT,CAAc3B,gBAAd,CAA+B,SAA/B,EAA0C,UAAU4B,CAAV,EAAa;AACrD,cAAIA,CAAC,CAACC,KAAF,KAAYZ,MAAM,CAACvH,OAAP,CAAeoI,WAA/B,EAA4C;AAC1Cb,YAAAA,MAAM,CAACc,MAAP;AACD;AACF,SAJD,EAIG,KAJH;AAKD,OAND;AAQD;;AAEDhB,IAAAA,MAAM,CAACrJ,SAAP,GAAmB;AACjBwJ,MAAAA,WAAW,EAAE,YAAW;AACtB,aAAKc,kBAAL,GAA0B,CAA1B;AACA,aAAKC,aAAL,GAAqB,IAArB;AACD,OAJgB;AAMjBd,MAAAA,UAAU,EAAE,YAAY;AACtB,YAAIF,MAAM,GAAG,IAAb,CADsB,CAGtB;;AACA,aAAKiB,aAAL,GAAqB,UAAU7F,SAAV,EAAqB;AACxC,cAAI4E,MAAM,CAACkB,KAAP,IAAgB,SAApB,EAA+B;AAE/BlB,UAAAA,MAAM,CAACmB,WAAP,CAAmB/F,SAAS,IAAIlD,WAAW,CAACC,GAAZ,EAAhC;AAEAiJ,UAAAA,qBAAqB,CAACpB,MAAM,CAACiB,aAAR,CAArB;AACD,SAND;AASD,OAnBgB;AAqBjB;AACA;AACAZ,MAAAA,cAAc,EAAE,YAAY;AAC1B,YAAIL,MAAM,GAAG,IAAb,CAD0B,CAE1B;;AACA,aAAKqB,YAAL,GAAoB,KAAKtB,UAAL,CAAgBI,UAAhB,CAA2BmB,QAA/C,CAH0B,CAK1B;;AACA,aAAKC,gBAAL,GAAwB,UAAU5J,IAAV,EAAgB;AACtC;AACA,cAAI6J,YAAY,GAAGxB,MAAM,CAACqB,YAAP,CAAoB1J,IAApB,CAAnB;;AACA,cAAI6J,YAAY,YAAYzG,IAAI,CAAC0G,KAAjC,EAAwC;AAEtC,gBAAIzB,MAAM,CAAC0B,WAAX,EAAwB;AACtB,kBAAI/J,IAAI,CAACkB,KAAL,CAAWpE,MAAX,GAAoB,CAAxB,EAA2B;AACzBuL,gBAAAA,MAAM,CAACM,cAAP,GAAwB,IAAxB;AACAN,gBAAAA,MAAM,CAACD,UAAP,CAAkB4B,IAAlB,CAAuB,0BAAvB;AACA3B,gBAAAA,MAAM,CAAC4B,UAAP;AACA5B,gBAAAA,MAAM,CAAC6B,IAAP;AACD,eALD,MAKO,IAAIlK,IAAI,CAACkB,KAAL,CAAWpE,MAAX,IAAqB,CAAzB,EAA4B;AACjC,oBAAIuL,MAAM,CAACM,cAAP,IAAyBN,MAAM,CAAC8B,gBAApC,EAAsD;AACpD9B,kBAAAA,MAAM,CAACM,cAAP,GAAwB,KAAxB;AACAN,kBAAAA,MAAM,CAACD,UAAP,CAAkB4B,IAAlB,CAAuB,6BAAvB;AACA3B,kBAAAA,MAAM,CAAC4B,UAAP,CAAkB,MAAlB;AACD;AAEF;AACF,aAhBqC,CAkBtC;;;AACA,mBAAO;AAAC5D,cAAAA,IAAI,EAAE;AAAP,aAAP;AACD,WApBD,MAoBO;AACL,mBAAOwD,YAAP;AACD;AACF,SA1BD,CAN0B,CAkC1B;AACA;;;AACA,aAAKO,cAAL,GAAsB,UAAUpK,IAAV,EAAgB;AACpC,cAAI6J,YAAY,GAAGxB,MAAM,CAACqB,YAAP,CAAoB1J,IAApB,CAAnB;;AACA,cAAI6J,YAAY,YAAYzG,IAAI,CAAC0G,KAAjC,EAAwC;AACtCzB,YAAAA,MAAM,CAACgC,kBAAP,CAA0BrK,IAA1B;AACD;;AACD,iBAAO6J,YAAP;AACD,SAND,CApC0B,CA4C1B;;;AACA,aAAK,IAAIS,QAAT,IAAqB,KAAKZ,YAA1B,EAAwC;AACtC,cAAI,KAAKA,YAAL,CAAkB3K,cAAlB,CAAiCuL,QAAjC,CAAJ,EAAgD;AAC9C,iBAAKV,gBAAL,CAAsBU,QAAtB,IAAkC,KAAKZ,YAAL,CAAkBY,QAAlB,CAAlC;AACA,iBAAKF,cAAL,CAAoBE,QAApB,IAAgC,KAAKZ,YAAL,CAAkBY,QAAlB,CAAhC;AACD;AACF,SAlDyB,CAoD1B;;;AACA,YAAI,KAAKf,KAAL,IAAc,SAAlB,EAA6B;AAC3B,eAAKnB,UAAL,CAAgBI,UAAhB,CAA2BmB,QAA3B,GAAsC,KAAKC,gBAA3C;AACD;AACF,OA/EgB;AAmFjB;AACAJ,MAAAA,WAAW,EAAE,UAAUhJ,GAAV,EAAe;AAE1B,YAAI,KAAK6I,aAAT,EAAuB;AACrB;AACA;AACA;AACA,cAAI7I,GAAG,GAAG,KAAK6I,aAAf,EAA6B;AAC3B;AACA,iBAAKA,aAAL,GAAqB7I,GAArB;AACD,WAHD,MAGK;AACH,iBAAK4I,kBAAL,IAA4B5I,GAAG,GAAG,KAAK6I,aAAvC;AACD;AACF;;AAED,aAAKA,aAAL,GAAqB7I,GAArB,CAd0B,CAgBhC;;AAGM,YAAI+C,eAAJ,CAnB0B,CAqB1B;;AACA,eAAQ,KAAK6F,kBAAL,IAA4B7F,eAAe,GAAG,KAAKqD,SAAL,CAAerD,eAAf,EAA9C,CAAR,EAA0F;AACxF,eAAK6F,kBAAL,IAA2B7F,eAA3B;;AACA,cAAI,CAAC,KAAKqD,SAAL,CAAe3E,YAAf,EAAL,EAAmC;AACjC,iBAAKsI,KAAL;AACA,iBAAKnC,UAAL,CAAgB4B,IAAhB,CAAqB,2BAArB,EAAkD,IAAlD;AACA;AACD;AACF;;AAED,aAAKQ,SAAL,CACE,KAAK5D,SAAL,CAAepE,mBAAf,CAAmC,KAAK4G,kBAAL,GAA0B7F,eAA7D,CADF;AAID,OAvHgB;AAyHjBiH,MAAAA,SAAS,EAAE,UAASjJ,SAAT,EAAmB;AAC5B,YAAI,CAACA,SAAL,EAAgB,MAAM,yBAAN;AAEhB,YAAIkJ,KAAK,GAAG,IAAIrH,IAAI,CAAC0G,KAAT,CAAevI,SAAf,CAAZ,CAH4B,CAK5B;AACA;;AAEA,aAAK6G,UAAL,CAAgBsC,YAAhB,CAA6BD,KAA7B;AACA,eAAO,IAAP;AACD,OAnIgB;AAqIjBE,MAAAA,kBAAkB,EAAE,UAASpJ,SAAT,EAAmB;AACrC,YAAI,CAACA,SAAL,EAAgB,MAAM,yBAAN;AAEhB,YAAIkJ,KAAK,GAAG,IAAIrH,IAAI,CAAC0G,KAAT,CAAevI,SAAf,CAAZ,CAHqC,CAKrC;;AAEA,aAAK6G,UAAL,CAAgBwC,oBAAhB,CAAqCH,KAArC;AACA,eAAO,IAAP;AACD,OA9IgB;AAgJjBI,MAAAA,aAAa,EAAE,UAAUrJ,UAAV,EAAsB;AACnC,YAAIA,UAAU,IAAI,KAAKoF,SAAL,CAAepF,UAAjC,EAA6C;AAC3C,eAAKoF,SAAL,CAAepF,UAAf,GAA4BA,UAAU,GAAG,KAAKoF,SAAL,CAAenF,UAAxD;AACA,eAAK+I,SAAL,CAAe,KAAK5D,SAAL,CAAe7E,YAAf,EAAf;AACD;AACF,OArJgB;AAwJjB;AACA+I,MAAAA,IAAI,EAAE,YAAY;AAChB,aAAKZ,IAAL;AAEA,eAAO,KAAKtD,SAAZ;AAEA,aAAKA,SAAL,GAAiB,IAAI/F,SAAJ,CAAc;AAC7BG,UAAAA,gBAAgB,EAAQ,KAAKF,OAAL,CAAaE,gBADR;AAE7BkB,UAAAA,IAAI,EAAoB,KAAKpB,OAAL,CAAaoB,IAFR;AAG7BuC,UAAAA,sBAAsB,EAAE,KAAK2D,UAAL,CAAgBI,UAAhB,CAA2BuC,IAA3B,CAAgCtG,sBAH3B;AAI7BC,UAAAA,cAAc,EAAU,KAAK0D,UAAL,CAAgBI,UAAhB,CAA2BmB,QAA3B,CAAoCjF;AAJ/B,SAAd,CAAjB;AAOA,aAAK0D,UAAL,CAAgB4B,IAAhB,CAAqB,eAArB,EAAsC,IAAtC;AACD,OAtKgB;AAwKjB;AACAO,MAAAA,KAAK,EAAE,YAAY;AACjB;AACA;AACA,aAAKhB,KAAL,GAAa,MAAb;AACA,aAAKyB,WAAL;AACA,aAAK5C,UAAL,CAAgB4B,IAAhB,CAAqB,gBAArB,EAAuC,IAAvC;AACD,OA/KgB;AAiLjBE,MAAAA,IAAI,EAAE,YAAY;AAChB,aAAKX,KAAL,GAAa,MAAb;AACA,aAAKnB,UAAL,CAAgBI,UAAhB,CAA2BmB,QAA3B,GAAsC,KAAKD,YAA3C;AACD,OApLgB;AAsLjBP,MAAAA,MAAM,EAAE,YAAY;AAClB,YAAI,KAAKI,KAAL,IAAc,MAAlB,EAA0B;AACxB,eAAK0B,IAAL;AACD,SAFD,MAEO,IAAI,KAAK1B,KAAL,IAAc,SAAlB,EAA6B;AAClC,eAAKgB,KAAL;AACD;AACF,OA5LgB;AA8LjB;AACA;AACA;AACAW,MAAAA,MAAM,EAAE,YAAY;AAClB,aAAKC,KAAL;AACA,aAAKL,IAAL;AACA,aAAKvB,KAAL,GAAa,WAAb;AACA,aAAKnB,UAAL,CAAgBI,UAAhB,CAA2BmB,QAA3B,GAAsC,KAAKS,cAA3C;AACA,aAAKH,UAAL,CAAgB,SAAhB;AACA,aAAK7B,UAAL,CAAgB4B,IAAhB,CAAqB,iBAArB,EAAwC,IAAxC;AACD,OAxMgB;AA0MjB;AACAmB,MAAAA,KAAK,EAAE,YAAY;AACjB,YAAI,CAAC,KAAKvE,SAAN,IAAmB,KAAKA,SAAL,CAAelD,KAAf,EAAvB,EAA+C;AAC/C,YAAI0H,UAAU,GAAG,KAAKxE,SAAL,CAAexE,iBAAf,EAAjB;AACAgJ,QAAAA,UAAU,CAAClK,KAAX,GAAmB,EAAnB;AACAkK,QAAAA,UAAU,CAACC,OAAX,GAAqB,EAArB;AACAD,QAAAA,UAAU,CAACjK,UAAX,GAAwB,EAAxB;AACAiK,QAAAA,UAAU,CAACE,KAAX,GAAmB,EAAnB;AACA,aAAKX,kBAAL,CAAwBS,UAAxB;AACD,OAnNgB;AAqNjBG,MAAAA,aAAa,EAAE,YAAY;AACzB,eAAO,KAAKhC,KAAL,IAAc,WAAd,IAA6B,KAAK3C,SAAL,CAAelD,KAAf,EAApC;AACD,OAvNgB;AAyNjB8H,MAAAA,WAAW,EAAE,YAAY;AACvB,eAAO,KAAKjC,KAAL,IAAc,WAAd,IAA6B,CAAC,KAAK3C,SAAL,CAAelD,KAAf,EAArC;AACD,OA3NgB;AA6NjB+H,MAAAA,eAAe,EAAE,YAAY;AAC3B;AACA,aAAKrD,UAAL,CAAgBI,UAAhB,CAA2BmB,QAA3B,GAAsC,KAAKC,gBAA3C;AACA,aAAKhD,SAAL,CAAevF,SAAf,CAAyB,KAAKuF,SAAL,CAAerF,SAAxC;AACA,aAAK6G,UAAL,CAAgB4B,IAAhB,CAAqB,4BAArB,EAAmD,IAAnD;AACD,OAlOgB;AAqOjB1D,MAAAA,MAAM,EAAE,YAAY;AAClB,eAAO,KAAKM,SAAL,CAAeN,MAAf,EAAP;AACD,OAvOgB;AAyOjBvF,MAAAA,OAAO,EAAE,YAAU;AACjB,eAAO,KAAK6F,SAAL,CAAe7F,OAAtB;AACD,OA3OgB;;AA8OjB;AACJ;AACA;AACA;AACA;AACIkK,MAAAA,IAAI,EAAE,YAAY;AAChB,YAAI,KAAK1B,KAAL,KAAe,SAAnB,EAA8B;AAC9B,YAAK,KAAKxI,OAAL,MAAkB,KAAK6F,SAAL,CAAelD,KAAf,EAAvB,EAAgD;AAEhD,aAAK6F,KAAL,GAAa,SAAb;AACA,aAAKnB,UAAL,CAAgBI,UAAhB,CAA2BmB,QAA3B,GAAsC,KAAKC,gBAA3C;AAEA,YAAIvB,MAAM,GAAG,IAAb,CAPgB,CAShB;;AACA,aAAKD,UAAL,CAAgBI,UAAhB,CAA2BkD,kBAA3B,CAA8C,OAA9C;AACA,aAAKtD,UAAL,CAAgBI,UAAhB,CAA2BC,EAA3B,CAA8B,OAA9B,EAAuC,UAAUgC,KAAV,EAAiB;AACtD;AACA,cAAIpC,MAAM,CAAC8B,gBAAP,IAA2B9B,MAAM,CAACsD,QAAlC,IAA8CtD,MAAM,CAACkB,KAAP,IAAgB,MAA9D,IAAwEkB,KAAK,CAACvJ,KAAN,CAAYpE,MAAZ,IAAsB,CAAlG,EAAqG;AACnGuL,YAAAA,MAAM,CAAC4C,IAAP;AACD,WAJqD,CAMtD;;;AACA5C,UAAAA,MAAM,CAACD,UAAP,CAAkBsC,YAAlB,CAA+BD,KAA/B;AACD,SARD,EAXgB,CAqBhB;;AACA,aAAKnC,WAAL;AACA,aAAK1B,SAAL,CAAezE,SAAf;AACA,aAAKmH,aAAL;AAEA,aAAKlB,UAAL,CAAgB4B,IAAhB,CAAqB,eAArB,EAAsC,IAAtC;AACD,OA9QgB;AAgRjB;AACA;AACAK,MAAAA,kBAAkB,EAAE,UAAU9I,SAAV,EAAqB;AACvC;AACA,aAAK0I,UAAL,CAAgB,MAAhB;;AACA,YAAI1I,SAAS,CAACL,KAAV,CAAgBpE,MAAhB,GAAyB,CAA7B,EAAgC;AAC9B,eAAK8J,SAAL,CAAe/E,QAAf,CAAwBN,SAAxB;AACA,eAAKyJ,WAAL;AACD,SAHD,MAGO,IAAK,CAAC,KAAKpE,SAAL,CAAelD,KAAf,EAAN,EAA+B;AACpC,eAAK+H,eAAL;AACD;AACF,OA3RgB;AA8RjB;AACA;AACA;AACA7C,MAAAA,YAAY,EAAE,UAAU9H,OAAV,EAAmB;AAC/B,YAAIuH,MAAM,GAAG,IAAb,CAD+B,CAG/B;;AACA,aAAKkC,KAAL,GAJ+B,CAM/B;;AACA,YAAIqB,YAAY,GAAG,UAAUtK,MAAV,EAAkB;AAEnC,eAAKD,SAAL,CAAeC,MAAf;;AAEA,cAAI+G,MAAM,CAACzB,SAAP,IAAoB,IAAxB,EAA6B;AAC3B7C,YAAAA,OAAO,CAACC,GAAR,CAAY,gCAAZ;AACA;AACD;;AAED,cAAIqE,MAAM,CAACsD,QAAX,EAAqB;AACnBtD,YAAAA,MAAM,CAAC4C,IAAP;;AACA,gBAAI5C,MAAM,CAAC0B,WAAP,IAAsB,CAAC1B,MAAM,CAACD,UAAP,CAAkByD,SAAlB,EAA3B,EAA2D;AACzDxD,cAAAA,MAAM,CAAC4B,UAAP,CAAkB,SAAlB;AACD;AACF;;AAED5B,UAAAA,MAAM,CAACD,UAAP,CAAkB4B,IAAlB,CAAuB,uBAAvB,EAAgD,IAAhD;AACD,SAjBD;;AAmBA,aAAKpD,SAAL,GAAiB9F,OAAjB,CA1B+B,CA4B/B;AACA;AACA;;AACA,YAAI,EAAEA,OAAO,YAAYD,SAArB,CAAJ,EAAoC;AAElC,eAAK+F,SAAL,CAAekF,SAAf,GAA2BjL,SAAS,CAAC/B,SAArC;AACA+B,UAAAA,SAAS,CAAC7B,IAAV,CAAe,KAAK4H,SAApB,EAA+B;AAC7B5F,YAAAA,gBAAgB,EAAE,KAAKF,OAAL,CAAaE,gBADF;AAE7BkB,YAAAA,IAAI,EAAc,KAAKpB,OAAL,CAAaoB,IAFF;AAG7BoF,YAAAA,YAAY,EAAE,UAASV,SAAT,EAAoBmF,UAApB,EAAgC1E,MAAhC,EAAuC;AACnDgB,cAAAA,MAAM,CAACD,UAAP,CAAkB4B,IAAlB,CAAuB,wBAAvB,EAAiDpD,SAAjD,EAA4DmF,UAA5D,EAAwE1E,MAAxE;AACD;AAL4B,WAA/B;AAQD;;AAGD,YAAK,KAAKT,SAAL,CAAeN,MAAf,EAAL,EAA+B;AAE7BsF,UAAAA,YAAY,CAAC5M,IAAb,CAAkB,KAAK4H,SAAvB,EAAkC,KAAKA,SAAL,CAAerF,SAAjD;AAED,SAJD,MAIO,IAAIT,OAAO,CAAC6F,GAAZ,EAAiB;AAEtB,eAAKyB,UAAL,CAAgB4B,IAAhB,CAAqB,qBAArB,EAA4C,IAA5C,EAAkD,KAAKpD,SAAvD,EAFsB,CAItB;;AACA,eAAKA,SAAL,CAAeL,aAAf,CAA6B,UAASjF,MAAT,EAAgB;AAC3CsK,YAAAA,YAAY,CAAC5M,IAAb,CAAkB,IAAlB,EAAwBsC,MAAxB;AACA+G,YAAAA,MAAM,CAACD,UAAP,CAAkB4B,IAAlB,CAAuB,wBAAvB,EAAiD3B,MAAjD,EAAyD,IAAzD;AACD,WAHD;AAKD,SAVM,MAUA,IAAIvH,OAAO,CAACkL,mBAAZ,EAAiC;AACtC,eAAKpF,SAAL,CAAekB,uBAAf,CAAuChH,OAAO,CAACkL,mBAA/C,EAAoE,UAAS1K,MAAT,EAAgB;AAClFsK,YAAAA,YAAY,CAAC5M,IAAb,CAAkB,IAAlB,EAAwBsC,MAAxB;AACD,WAFD;AAGD;;AAGD,eAAO,IAAP;AACD,OApWgB;AAuWjB0J,MAAAA,WAAW,EAAE,YAAY;AACvB,YAAI,CAAC,KAAKiB,OAAV,EAAmB;AACnB,aAAKA,OAAL,CAAaC,KAAb,CAAmBC,OAAnB,GAA6B,MAA7B;AACD,OA1WgB;AA6WjB;AACAlC,MAAAA,UAAU,EAAE,UAAUmC,WAAV,EAAuB;AACjC,YAAI,CAAC,KAAKH,OAAV,EAAmB;AACnB,YAAI,KAAKG,WAAL,IAAoBA,WAAxB,EAAqC;AAErC,aAAKA,WAAL,GAAmBA,WAAnB;;AACA,gBAAQA,WAAR;AACE,eAAK,SAAL;AACE,iBAAKH,OAAL,CAAaC,KAAb,CAAmBC,OAAnB,GAA6B,OAA7B;AACA,iBAAKF,OAAL,CAAaI,SAAb,GAAyBpE,iBAAzB;AACA;;AACF,eAAK,MAAL;AACE,iBAAKgE,OAAL,CAAaC,KAAb,CAAmBC,OAAnB,GAA6B,OAA7B;AACA,iBAAKF,OAAL,CAAaI,SAAb,GAAyBnE,wBAAzB;AACA;;AACF,eAAKtM,SAAL;AACE,iBAAKqQ,OAAL,CAAaI,SAAb,GAAyB,EAAzB;AACA;AAXJ;AAaD;AAhYgB,KAAnB,CA3CW,CA+aX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,QAAIC,QAAQ,GAAG,UAAUC,KAAV,EAAiB;AAC9B,UAAInE,UAAU,GAAG,IAAjB;AACA,UAAIuD,QAAQ,GAAGY,KAAK,CAACZ,QAArB;AACA,UAAIA,QAAQ,KAAK/P,SAAjB,EAA4B+P,QAAQ,GAAG,IAAX;AAE5B,UAAI5B,WAAW,GAAGwC,KAAK,CAACxC,WAAxB;AACA,UAAIA,WAAW,KAAKnO,SAApB,EAA+BmO,WAAW,GAAG,IAAd;AAE/B,UAAII,gBAAgB,GAAGoC,KAAK,CAACpC,gBAA7B;AACA,UAAIA,gBAAgB,KAAKvO,SAAzB,EAAoCuO,gBAAgB,GAAG,IAAnB;AAEpC,UAAInJ,gBAAgB,GAAGuL,KAAK,CAACvL,gBAA7B;AACA,UAAIA,gBAAgB,KAAKpF,SAAzB,EAAoCoF,gBAAgB,GAAG,EAAnB;AAEpC,UAAIwL,uBAAuB,GAAGD,KAAK,CAACC,uBAApC;AAEA,UAAItD,WAAW,GAAGqD,KAAK,CAACrD,WAAxB;AACA,UAAIA,WAAW,KAAKtN,SAApB,EAA+BsN,WAAW,GAAG,EAAd,CAjBD,CAiBmB;;AAEjD,UAAIhH,IAAI,GAAGqK,KAAK,CAACrK,IAAjB;AACA,UAAIA,IAAI,KAAKtG,SAAb,EAAwBsG,IAAI,GAAG,IAAP;AAExB,UAAI+J,OAAO,GAAGM,KAAK,CAACN,OAApB,CAtB8B,CAuB9B;;AACA,UAAIA,OAAO,KAAKrQ,SAAZ,IAAyBiN,QAAQ,CAACE,IAAtC,EAA4C;AAC1CkD,QAAAA,OAAO,GAAGpD,QAAQ,CAAC4D,aAAT,CAAuB,KAAvB,CAAV;AACA5D,QAAAA,QAAQ,CAACE,IAAT,CAAc2D,WAAd,CAA0BT,OAA1B;AACAA,QAAAA,OAAO,CAACC,KAAR,CAAcS,KAAd,GAAsB,MAAtB;AACAV,QAAAA,OAAO,CAACC,KAAR,CAAc/L,QAAd,GAAyB,UAAzB;AACA8L,QAAAA,OAAO,CAACC,KAAR,CAAcU,GAAd,GAAoB,GAApB;AACAX,QAAAA,OAAO,CAACC,KAAR,CAAcW,IAAd,GAAqB,MAAMlR,MAAM,CAACmR,gBAAP,CAAwBjE,QAAQ,CAACE,IAAjC,EAAuCgE,gBAAvC,CAAwD,QAAxD,CAA3B;AACAd,QAAAA,OAAO,CAACC,KAAR,CAAcc,OAAd,GAAwB,MAAxB;AACAf,QAAAA,OAAO,CAACC,KAAR,CAAce,SAAd,GAA0B,QAA1B;AACAhB,QAAAA,OAAO,CAACC,KAAR,CAAcgB,QAAd,GAAyB,MAAzB;AACAjB,QAAAA,OAAO,CAACC,KAAR,CAAciB,OAAd,GAAwB,KAAxB;AACAlB,QAAAA,OAAO,CAACC,KAAR,CAAcC,OAAd,GAAwB,MAAxB;AACAF,QAAAA,OAAO,CAACC,KAAR,CAAckB,MAAd,GAAuB,IAAvB;AACAnB,QAAAA,OAAO,CAACoB,EAAR,GAAa,cAAb;AACApB,QAAAA,OAAO,CAACC,KAAR,CAAcoB,MAAd,GAAuB,SAAvB;AACArB,QAAAA,OAAO,CAAC7E,gBAAR,CAAyB,OAAzB,EAAkC,YAAY;AAC5C,eAAK8E,KAAL,CAAWC,OAAX,GAAqB,MAArB;AACA,iBAAO,KAAP;AACD,SAHD,EAGG,KAHH;AAKD;;AAGDI,MAAAA,KAAK,CAAClE,MAAN,GAAe,IAAIF,MAAJ,CAAW,IAAX,EAAiB;AAC9BvB,QAAAA,SAAS,EAAE2F,KAAK,CAAC3F,SADa;AAE9B1E,QAAAA,IAAI,EAAEA,IAFwB;AAG9BgH,QAAAA,WAAW,EAAEA,WAHiB;AAI9BlI,QAAAA,gBAAgB,EAAEA;AAJY,OAAjB,CAAf,CA/C8B,CAsD9B;AACA;;AACAuL,MAAAA,KAAK,CAAClE,MAAN,CAAa4D,OAAb,GAAuBA,OAAvB;AACAM,MAAAA,KAAK,CAAClE,MAAN,CAAa0B,WAAb,GAA2BA,WAA3B;AACAwC,MAAAA,KAAK,CAAClE,MAAN,CAAa8B,gBAAb,GAAgCA,gBAAhC;AACAoC,MAAAA,KAAK,CAAClE,MAAN,CAAamE,uBAAb,GAAuCA,uBAAvC;AACAD,MAAAA,KAAK,CAAClE,MAAN,CAAasD,QAAb,GAAwBA,QAAxB;;AAEA,UAAI4B,oBAAoB,GAAG,YAAY;AACrC,YAAIhB,KAAK,CAAClE,MAAN,CAAa0B,WAAb,IAA4B3B,UAAU,CAACI,UAAX,CAAsBuC,IAAtB,CAA2BtG,sBAA3B,GAAoD8H,KAAK,CAACC,uBAA1F,EAAmH;AACjHzI,UAAAA,OAAO,CAACC,GAAR,CAAY,+BAA+BoE,UAAU,CAACI,UAAX,CAAsBuC,IAAtB,CAA2BtG,sBAA1D,GAAmF,kCAA/F;AACA8H,UAAAA,KAAK,CAAClE,MAAN,CAAa0B,WAAb,GAA2B,KAA3B;AACA;AACD;;AAED,YAAI4B,QAAJ,EAAc;AACZvD,UAAAA,UAAU,CAACK,EAAX,CAAc,kBAAd,EAAkC,YAAY;AAC5C,gBAAI8D,KAAK,CAAClE,MAAN,CAAakB,KAAb,IAAsB,WAA1B,EAAuC;AACrCgD,cAAAA,KAAK,CAAClE,MAAN,CAAakC,KAAb;AACAgC,cAAAA,KAAK,CAAClE,MAAN,CAAa4B,UAAb,CAAwB,MAAxB;AACD,aAHD,MAGO;AACL,kBAAIF,WAAJ,EAAiB;AACfwC,gBAAAA,KAAK,CAAClE,MAAN,CAAa4B,UAAb,CAAwB,MAAxB;AACD,eAFD,MAEO;AACLsC,gBAAAA,KAAK,CAAClE,MAAN,CAAa4B,UAAb;AACD;AACF;AACF,WAXD;AAaA7B,UAAAA,UAAU,CAACK,EAAX,CAAc,kBAAd,EAAkC,YAAY;AAC5C8D,YAAAA,KAAK,CAAClE,MAAN,CAAa4C,IAAb;AACD,WAFD;AAGD;;AACD7C,QAAAA,UAAU,CAACK,EAAX,CAAc,kBAAd,EAAkC,YAAY;AAC5C8D,UAAAA,KAAK,CAAClE,MAAN,CAAa4B,UAAb,CAAwB,SAAxB;AACD,SAFD;AAGD,OA5BD,CA9D8B,CA4F9B;AACA;;;AACA,UAAI,CAAC,CAAC,KAAKzB,UAAL,CAAgBgF,SAAtB,EAAiC;AAC/BD,QAAAA,oBAAoB;AACrB,OAFD,MAEO;AACL,aAAK9E,EAAL,CAAQ,OAAR,EAAiB8E,oBAAjB;AACD;;AAED,aAAO,EAAP;AACD,KArGD;;AAwGA,QAAK,OAAOnK,IAAP,KAAgB,WAAjB,IAAiCA,IAAI,CAACqK,UAA1C,EAAsD;AACpDrK,MAAAA,IAAI,CAACqK,UAAL,CAAgBC,MAAhB,CAAuB,UAAvB,EAAmCpB,QAAnC;AACD,KAFD,MAEO,IAAI,OAAOjM,MAAP,KAAkB,WAAtB,EAAmC;AACxCA,MAAAA,MAAM,CAACC,OAAP,CAAegM,QAAf,GAA0BA,QAA1B;AACD,KAFM,MAEA;AACL,YAAM,sBAAN;AACD;AAEF,GA3iBD,EA2iBGtN,IA3iBH,CA2iBQ,IA3iBR;AA4iBC,CA5yDC,EA4yDCrD,MA5yDD,CAAD","sourcesContent":["/*\n * LeapJS Playback - v0.2.1 - 2014-05-14\n * http://github.com/leapmotion/leapjs-playback/\n *\n * Copyright 2014 LeapMotion, Inc\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n\n;(function( window, undefined ){\n 'use strict';\n  // see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions_and_function_scope/Strict_mode\n\n// Copyright (c) 2013 Pieroxy <pieroxy@pieroxy.net>\n// This work is free. You can redistribute it and/or modify it\n// under the terms of the WTFPL, Version 2\n// For more information see LICENSE.txt or http://www.wtfpl.net/\n//\n// For more information, the home page:\n// http://pieroxy.net/blog/pages/lz-string/testing.html\n//\n// LZ-based compression algorithm, version 1.3.3\nvar LZString = {\n\n\n  // private property\n  _keyStr : \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\",\n  _f : String.fromCharCode,\n\n  compressToBase64 : function (input) {\n    if (input == null) return \"\";\n    var output = \"\";\n    var chr1, chr2, chr3, enc1, enc2, enc3, enc4;\n    var i = 0;\n\n    input = LZString.compress(input);\n\n    while (i < input.length*2) {\n\n      if (i%2==0) {\n        chr1 = input.charCodeAt(i/2) >> 8;\n        chr2 = input.charCodeAt(i/2) & 255;\n        if (i/2+1 < input.length)\n          chr3 = input.charCodeAt(i/2+1) >> 8;\n        else\n          chr3 = NaN;\n      } else {\n        chr1 = input.charCodeAt((i-1)/2) & 255;\n        if ((i+1)/2 < input.length) {\n          chr2 = input.charCodeAt((i+1)/2) >> 8;\n          chr3 = input.charCodeAt((i+1)/2) & 255;\n        } else\n          chr2=chr3=NaN;\n      }\n      i+=3;\n\n      enc1 = chr1 >> 2;\n      enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);\n      enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);\n      enc4 = chr3 & 63;\n\n      if (isNaN(chr2)) {\n        enc3 = enc4 = 64;\n      } else if (isNaN(chr3)) {\n        enc4 = 64;\n      }\n\n      output = output +\n        LZString._keyStr.charAt(enc1) + LZString._keyStr.charAt(enc2) +\n          LZString._keyStr.charAt(enc3) + LZString._keyStr.charAt(enc4);\n\n    }\n\n    return output;\n  },\n\n  decompressFromBase64 : function (input) {\n    if (input == null) return \"\";\n    var output = \"\",\n        ol = 0,\n        output_,\n        chr1, chr2, chr3,\n        enc1, enc2, enc3, enc4,\n        i = 0, f=LZString._f;\n\n    input = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, \"\");\n\n    while (i < input.length) {\n\n      enc1 = LZString._keyStr.indexOf(input.charAt(i++));\n      enc2 = LZString._keyStr.indexOf(input.charAt(i++));\n      enc3 = LZString._keyStr.indexOf(input.charAt(i++));\n      enc4 = LZString._keyStr.indexOf(input.charAt(i++));\n\n      chr1 = (enc1 << 2) | (enc2 >> 4);\n      chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);\n      chr3 = ((enc3 & 3) << 6) | enc4;\n\n      if (ol%2==0) {\n        output_ = chr1 << 8;\n\n        if (enc3 != 64) {\n          output += f(output_ | chr2);\n        }\n        if (enc4 != 64) {\n          output_ = chr3 << 8;\n        }\n      } else {\n        output = output + f(output_ | chr1);\n\n        if (enc3 != 64) {\n          output_ = chr2 << 8;\n        }\n        if (enc4 != 64) {\n          output += f(output_ | chr3);\n        }\n      }\n      ol+=3;\n    }\n\n    return LZString.decompress(output);\n\n  },\n\n  compressToUTF16 : function (input) {\n    if (input == null) return \"\";\n    var output = \"\",\n        i,c,\n        current,\n        status = 0,\n        f = LZString._f;\n\n    input = LZString.compress(input);\n\n    for (i=0 ; i<input.length ; i++) {\n      c = input.charCodeAt(i);\n      switch (status++) {\n        case 0:\n          output += f((c >> 1)+32);\n          current = (c & 1) << 14;\n          break;\n        case 1:\n          output += f((current + (c >> 2))+32);\n          current = (c & 3) << 13;\n          break;\n        case 2:\n          output += f((current + (c >> 3))+32);\n          current = (c & 7) << 12;\n          break;\n        case 3:\n          output += f((current + (c >> 4))+32);\n          current = (c & 15) << 11;\n          break;\n        case 4:\n          output += f((current + (c >> 5))+32);\n          current = (c & 31) << 10;\n          break;\n        case 5:\n          output += f((current + (c >> 6))+32);\n          current = (c & 63) << 9;\n          break;\n        case 6:\n          output += f((current + (c >> 7))+32);\n          current = (c & 127) << 8;\n          break;\n        case 7:\n          output += f((current + (c >> 8))+32);\n          current = (c & 255) << 7;\n          break;\n        case 8:\n          output += f((current + (c >> 9))+32);\n          current = (c & 511) << 6;\n          break;\n        case 9:\n          output += f((current + (c >> 10))+32);\n          current = (c & 1023) << 5;\n          break;\n        case 10:\n          output += f((current + (c >> 11))+32);\n          current = (c & 2047) << 4;\n          break;\n        case 11:\n          output += f((current + (c >> 12))+32);\n          current = (c & 4095) << 3;\n          break;\n        case 12:\n          output += f((current + (c >> 13))+32);\n          current = (c & 8191) << 2;\n          break;\n        case 13:\n          output += f((current + (c >> 14))+32);\n          current = (c & 16383) << 1;\n          break;\n        case 14:\n          output += f((current + (c >> 15))+32, (c & 32767)+32);\n          status = 0;\n          break;\n      }\n    }\n\n    return output + f(current + 32);\n  },\n\n\n  decompressFromUTF16 : function (input) {\n    if (input == null) return \"\";\n    var output = \"\",\n        current,c,\n        status=0,\n        i = 0,\n        f = LZString._f;\n\n    while (i < input.length) {\n      c = input.charCodeAt(i) - 32;\n\n      switch (status++) {\n        case 0:\n          current = c << 1;\n          break;\n        case 1:\n          output += f(current | (c >> 14));\n          current = (c&16383) << 2;\n          break;\n        case 2:\n          output += f(current | (c >> 13));\n          current = (c&8191) << 3;\n          break;\n        case 3:\n          output += f(current | (c >> 12));\n          current = (c&4095) << 4;\n          break;\n        case 4:\n          output += f(current | (c >> 11));\n          current = (c&2047) << 5;\n          break;\n        case 5:\n          output += f(current | (c >> 10));\n          current = (c&1023) << 6;\n          break;\n        case 6:\n          output += f(current | (c >> 9));\n          current = (c&511) << 7;\n          break;\n        case 7:\n          output += f(current | (c >> 8));\n          current = (c&255) << 8;\n          break;\n        case 8:\n          output += f(current | (c >> 7));\n          current = (c&127) << 9;\n          break;\n        case 9:\n          output += f(current | (c >> 6));\n          current = (c&63) << 10;\n          break;\n        case 10:\n          output += f(current | (c >> 5));\n          current = (c&31) << 11;\n          break;\n        case 11:\n          output += f(current | (c >> 4));\n          current = (c&15) << 12;\n          break;\n        case 12:\n          output += f(current | (c >> 3));\n          current = (c&7) << 13;\n          break;\n        case 13:\n          output += f(current | (c >> 2));\n          current = (c&3) << 14;\n          break;\n        case 14:\n          output += f(current | (c >> 1));\n          current = (c&1) << 15;\n          break;\n        case 15:\n          output += f(current | c);\n          status=0;\n          break;\n      }\n\n\n      i++;\n    }\n\n    return LZString.decompress(output);\n    //return output;\n\n  },\n\n\n\n  compress: function (uncompressed) {\n    if (uncompressed == null) return \"\";\n    var i, value,\n        context_dictionary= {},\n        context_dictionaryToCreate= {},\n        context_c=\"\",\n        context_wc=\"\",\n        context_w=\"\",\n        context_enlargeIn= 2, // Compensate for the first entry which should not count\n        context_dictSize= 3,\n        context_numBits= 2,\n        context_data_string=\"\",\n        context_data_val=0,\n        context_data_position=0,\n        ii,\n        f=LZString._f;\n\n    for (ii = 0; ii < uncompressed.length; ii += 1) {\n      context_c = uncompressed.charAt(ii);\n      if (!Object.prototype.hasOwnProperty.call(context_dictionary,context_c)) {\n        context_dictionary[context_c] = context_dictSize++;\n        context_dictionaryToCreate[context_c] = true;\n      }\n\n      context_wc = context_w + context_c;\n      if (Object.prototype.hasOwnProperty.call(context_dictionary,context_wc)) {\n        context_w = context_wc;\n      } else {\n        if (Object.prototype.hasOwnProperty.call(context_dictionaryToCreate,context_w)) {\n          if (context_w.charCodeAt(0)<256) {\n            for (i=0 ; i<context_numBits ; i++) {\n              context_data_val = (context_data_val << 1);\n              if (context_data_position == 15) {\n                context_data_position = 0;\n                context_data_string += f(context_data_val);\n                context_data_val = 0;\n              } else {\n                context_data_position++;\n              }\n            }\n            value = context_w.charCodeAt(0);\n            for (i=0 ; i<8 ; i++) {\n              context_data_val = (context_data_val << 1) | (value&1);\n              if (context_data_position == 15) {\n                context_data_position = 0;\n                context_data_string += f(context_data_val);\n                context_data_val = 0;\n              } else {\n                context_data_position++;\n              }\n              value = value >> 1;\n            }\n          } else {\n            value = 1;\n            for (i=0 ; i<context_numBits ; i++) {\n              context_data_val = (context_data_val << 1) | value;\n              if (context_data_position == 15) {\n                context_data_position = 0;\n                context_data_string += f(context_data_val);\n                context_data_val = 0;\n              } else {\n                context_data_position++;\n              }\n              value = 0;\n            }\n            value = context_w.charCodeAt(0);\n            for (i=0 ; i<16 ; i++) {\n              context_data_val = (context_data_val << 1) | (value&1);\n              if (context_data_position == 15) {\n                context_data_position = 0;\n                context_data_string += f(context_data_val);\n                context_data_val = 0;\n              } else {\n                context_data_position++;\n              }\n              value = value >> 1;\n            }\n          }\n          context_enlargeIn--;\n          if (context_enlargeIn == 0) {\n            context_enlargeIn = Math.pow(2, context_numBits);\n            context_numBits++;\n          }\n          delete context_dictionaryToCreate[context_w];\n        } else {\n          value = context_dictionary[context_w];\n          for (i=0 ; i<context_numBits ; i++) {\n            context_data_val = (context_data_val << 1) | (value&1);\n            if (context_data_position == 15) {\n              context_data_position = 0;\n              context_data_string += f(context_data_val);\n              context_data_val = 0;\n            } else {\n              context_data_position++;\n            }\n            value = value >> 1;\n          }\n\n\n        }\n        context_enlargeIn--;\n        if (context_enlargeIn == 0) {\n          context_enlargeIn = Math.pow(2, context_numBits);\n          context_numBits++;\n        }\n        // Add wc to the dictionary.\n        context_dictionary[context_wc] = context_dictSize++;\n        context_w = String(context_c);\n      }\n    }\n\n    // Output the code for w.\n    if (context_w !== \"\") {\n      if (Object.prototype.hasOwnProperty.call(context_dictionaryToCreate,context_w)) {\n        if (context_w.charCodeAt(0)<256) {\n          for (i=0 ; i<context_numBits ; i++) {\n            context_data_val = (context_data_val << 1);\n            if (context_data_position == 15) {\n              context_data_position = 0;\n              context_data_string += f(context_data_val);\n              context_data_val = 0;\n            } else {\n              context_data_position++;\n            }\n          }\n          value = context_w.charCodeAt(0);\n          for (i=0 ; i<8 ; i++) {\n            context_data_val = (context_data_val << 1) | (value&1);\n            if (context_data_position == 15) {\n              context_data_position = 0;\n              context_data_string += f(context_data_val);\n              context_data_val = 0;\n            } else {\n              context_data_position++;\n            }\n            value = value >> 1;\n          }\n        } else {\n          value = 1;\n          for (i=0 ; i<context_numBits ; i++) {\n            context_data_val = (context_data_val << 1) | value;\n            if (context_data_position == 15) {\n              context_data_position = 0;\n              context_data_string += f(context_data_val);\n              context_data_val = 0;\n            } else {\n              context_data_position++;\n            }\n            value = 0;\n          }\n          value = context_w.charCodeAt(0);\n          for (i=0 ; i<16 ; i++) {\n            context_data_val = (context_data_val << 1) | (value&1);\n            if (context_data_position == 15) {\n              context_data_position = 0;\n              context_data_string += f(context_data_val);\n              context_data_val = 0;\n            } else {\n              context_data_position++;\n            }\n            value = value >> 1;\n          }\n        }\n        context_enlargeIn--;\n        if (context_enlargeIn == 0) {\n          context_enlargeIn = Math.pow(2, context_numBits);\n          context_numBits++;\n        }\n        delete context_dictionaryToCreate[context_w];\n      } else {\n        value = context_dictionary[context_w];\n        for (i=0 ; i<context_numBits ; i++) {\n          context_data_val = (context_data_val << 1) | (value&1);\n          if (context_data_position == 15) {\n            context_data_position = 0;\n            context_data_string += f(context_data_val);\n            context_data_val = 0;\n          } else {\n            context_data_position++;\n          }\n          value = value >> 1;\n        }\n\n\n      }\n      context_enlargeIn--;\n      if (context_enlargeIn == 0) {\n        context_enlargeIn = Math.pow(2, context_numBits);\n        context_numBits++;\n      }\n    }\n\n    // Mark the end of the stream\n    value = 2;\n    for (i=0 ; i<context_numBits ; i++) {\n      context_data_val = (context_data_val << 1) | (value&1);\n      if (context_data_position == 15) {\n        context_data_position = 0;\n        context_data_string += f(context_data_val);\n        context_data_val = 0;\n      } else {\n        context_data_position++;\n      }\n      value = value >> 1;\n    }\n\n    // Flush the last char\n    while (true) {\n      context_data_val = (context_data_val << 1);\n      if (context_data_position == 15) {\n        context_data_string += f(context_data_val);\n        break;\n      }\n      else context_data_position++;\n    }\n    return context_data_string;\n  },\n\n  decompress: function (compressed) {\n    if (compressed == null) return \"\";\n    if (compressed == \"\") return null;\n    var dictionary = [],\n        next,\n        enlargeIn = 4,\n        dictSize = 4,\n        numBits = 3,\n        entry = \"\",\n        result = \"\",\n        i,\n        w,\n        bits, resb, maxpower, power,\n        c,\n        f = LZString._f,\n        data = {string:compressed, val:compressed.charCodeAt(0), position:32768, index:1};\n\n    for (i = 0; i < 3; i += 1) {\n      dictionary[i] = i;\n    }\n\n    bits = 0;\n    maxpower = Math.pow(2,2);\n    power=1;\n    while (power!=maxpower) {\n      resb = data.val & data.position;\n      data.position >>= 1;\n      if (data.position == 0) {\n        data.position = 32768;\n        data.val = data.string.charCodeAt(data.index++);\n      }\n      bits |= (resb>0 ? 1 : 0) * power;\n      power <<= 1;\n    }\n\n    switch (next = bits) {\n      case 0:\n          bits = 0;\n          maxpower = Math.pow(2,8);\n          power=1;\n          while (power!=maxpower) {\n            resb = data.val & data.position;\n            data.position >>= 1;\n            if (data.position == 0) {\n              data.position = 32768;\n              data.val = data.string.charCodeAt(data.index++);\n            }\n            bits |= (resb>0 ? 1 : 0) * power;\n            power <<= 1;\n          }\n        c = f(bits);\n        break;\n      case 1:\n          bits = 0;\n          maxpower = Math.pow(2,16);\n          power=1;\n          while (power!=maxpower) {\n            resb = data.val & data.position;\n            data.position >>= 1;\n            if (data.position == 0) {\n              data.position = 32768;\n              data.val = data.string.charCodeAt(data.index++);\n            }\n            bits |= (resb>0 ? 1 : 0) * power;\n            power <<= 1;\n          }\n        c = f(bits);\n        break;\n      case 2:\n        return \"\";\n    }\n    dictionary[3] = c;\n    w = result = c;\n    while (true) {\n      if (data.index > data.string.length) {\n        return \"\";\n      }\n\n      bits = 0;\n      maxpower = Math.pow(2,numBits);\n      power=1;\n      while (power!=maxpower) {\n        resb = data.val & data.position;\n        data.position >>= 1;\n        if (data.position == 0) {\n          data.position = 32768;\n          data.val = data.string.charCodeAt(data.index++);\n        }\n        bits |= (resb>0 ? 1 : 0) * power;\n        power <<= 1;\n      }\n\n      switch (c = bits) {\n        case 0:\n          bits = 0;\n          maxpower = Math.pow(2,8);\n          power=1;\n          while (power!=maxpower) {\n            resb = data.val & data.position;\n            data.position >>= 1;\n            if (data.position == 0) {\n              data.position = 32768;\n              data.val = data.string.charCodeAt(data.index++);\n            }\n            bits |= (resb>0 ? 1 : 0) * power;\n            power <<= 1;\n          }\n\n          dictionary[dictSize++] = f(bits);\n          c = dictSize-1;\n          enlargeIn--;\n          break;\n        case 1:\n          bits = 0;\n          maxpower = Math.pow(2,16);\n          power=1;\n          while (power!=maxpower) {\n            resb = data.val & data.position;\n            data.position >>= 1;\n            if (data.position == 0) {\n              data.position = 32768;\n              data.val = data.string.charCodeAt(data.index++);\n            }\n            bits |= (resb>0 ? 1 : 0) * power;\n            power <<= 1;\n          }\n          dictionary[dictSize++] = f(bits);\n          c = dictSize-1;\n          enlargeIn--;\n          break;\n        case 2:\n          return result;\n      }\n\n      if (enlargeIn == 0) {\n        enlargeIn = Math.pow(2, numBits);\n        numBits++;\n      }\n\n      if (dictionary[c]) {\n        entry = dictionary[c];\n      } else {\n        if (c === dictSize) {\n          entry = w + w.charAt(0);\n        } else {\n          return null;\n        }\n      }\n      result += entry;\n\n      // Add w+entry[0] to the dictionary.\n      dictionary[dictSize++] = w + entry.charAt(0);\n      enlargeIn--;\n\n      w = entry;\n\n      if (enlargeIn == 0) {\n        enlargeIn = Math.pow(2, numBits);\n        numBits++;\n      }\n\n    }\n  }\n};\n\nif( typeof module !== 'undefined' && module != null ) {\n  module.exports = LZString\n}\n\n// https://gist.github.com/paulirish/5438650\n\n// relies on Date.now() which has been supported everywhere modern for years.\n// as Safari 6 doesn't have support for NavigationTiming, we use a Date.now() timestamp for relative values\n\n// if you want values similar to what you'd get with real perf.now, place this towards the head of the page\n// but in reality, you're just getting the delta between now() calls, so it's not terribly important where it's placed\n\n\n(function(){\n\n  // prepare base perf object\n  if (typeof window.performance === 'undefined') {\n      window.performance = {};\n  }\n\n  if (!window.performance.now){\n\n    var nowOffset = Date.now();\n\n    if (performance.timing && performance.timing.navigationStart){\n      nowOffset = performance.timing.navigationStart\n    }\n\n\n    window.performance.now = function now(){\n      return Date.now() - nowOffset;\n    }\n\n  }\n\n})();\nfunction Recording (options){\n  this.options = options || (options = {});\n  this.loading = false;\n  this.timeBetweenLoops = options.timeBetweenLoops || 50;\n\n  // see https://github.com/leapmotion/leapjs/blob/master/Leap_JSON.rst\n  this.packingStructure = [\n    'id',\n    'timestamp',\n    // this should be replace/upgraded with a whitelist instead of a blacklist.\n    // leaving out r,s,y, and gestures\n    {hands: [[\n      'id',\n      'type',\n      'direction',\n      'palmNormal',\n      'palmPosition',\n      'palmVelocity',\n      'stabilizedPalmPosition',\n      'pinchStrength',\n      'grabStrength',\n      'confidence',\n      'armBasis',\n      'armWidth',\n      'elbow',\n      'wrist'\n      // leaving out r, s, t, sphereCenter, sphereRadius\n    ]]},\n    {pointables: [[\n      'id',\n      'direction',\n      'handId',\n      'length',\n      'stabilizedTipPosition',\n      'tipPosition',\n      'tipVelocity',\n      'tool',\n      'carpPosition',\n      'mcpPosition',\n      'pipPosition',\n      'dipPosition',\n      'btipPosition',\n      'bases',\n      'type'\n      // leaving out touchDistance, touchZone\n    ]]},\n    {interactionBox: [\n      'center', 'size'\n    ]}\n  ];\n\n  this.setFrames(options.frames || [])\n}\n\n\nRecording.prototype = {\n\n  setFrames: function (frames) {\n    this.frameData = frames;\n    this.frameIndex = 0;\n    this.frameCount = frames.length;\n    this.leftCropPosition = 0;\n    this.rightCropPosition = this.frameCount;\n    this.setMetaData();\n  },\n\n  addFrame: function(frameData){\n    this.frameData.push(frameData);\n  },\n\n  currentFrame: function () {\n    return this.frameData[this.frameIndex];\n  },\n\n  nextFrame: function () {\n    var frameIndex = this.frameIndex + 1;\n    // || 1 to prevent `mod 0` error when finishing recording before setFrames has been called.\n    frameIndex = frameIndex % (this.rightCropPosition || 1);\n    if ((frameIndex < this.leftCropPosition)) {\n      frameIndex = this.leftCropPosition;\n    }\n    return this.frameData[frameIndex];\n  },\n\n\n  advanceFrame: function () {\n    this.frameIndex++;\n\n    if (this.frameIndex >= this.rightCropPosition && !this.options.loop) {\n      this.frameIndex--;\n      // there is currently an issue where angular watching the right handle position\n      // will cause this to fire prematurely\n      // when switching to an earlier recording\n      return false\n    }\n\n\n    this.frameIndex = this.frameIndex % (this.rightCropPosition || 1);\n\n    if ((this.frameIndex < this.leftCropPosition)) {\n      this.frameIndex = this.leftCropPosition;\n    }\n\n    return true\n  },\n\n  // resets to beginning if at end\n  readyPlay: function(){\n    this.frameIndex++;\n    if (this.frameIndex >= this.rightCropPosition) {\n      this.frameIndex = this.frameIndex % (this.rightCropPosition || 1);\n\n      if ((this.frameIndex < this.leftCropPosition)) {\n        this.frameIndex = this.leftCropPosition;\n      }\n    }else{\n      this.frameIndex--;\n    }\n  },\n\n  cloneCurrentFrame: function(){\n    return JSON.parse(JSON.stringify(this.currentFrame()));\n  },\n\n\n  // this method would be well-moved to its own object/class -.-\n  // for every point, lerp as appropriate\n  // note: currently hand and finger props are hard coded, but things like stabilizedPalmPosition should be optional\n  // should have this be set from the packingStructure or some such, but only for vec3s.\n  createLerpFrameData: function(t){\n    // http://stackoverflow.com/a/5344074/478354\n    var currentFrame = this.currentFrame(),\n        nextFrame = this.nextFrame(),\n        handProps   = ['palmPosition', 'stabilizedPalmPosition', 'sphereCenter', 'direction', 'palmNormal', 'palmVelocity'],\n        fingerProps = ['mcpPosition', 'pipPosition', 'dipPosition', 'tipPosition', 'direction'],\n        frameData = this.cloneCurrentFrame(),\n        numHands = frameData.hands.length,\n        numPointables = frameData.pointables.length,\n        len1 = handProps.length,\n        len2 = fingerProps.length,\n        prop, hand, pointable;\n\n    for (var i = 0; i < numHands; i++){\n      hand = frameData.hands[i];\n\n      for (var j = 0; j < len1; j++){\n        prop = handProps[j];\n\n        if (!currentFrame.hands[i][prop]){\n          continue;\n        }\n\n        if (!nextFrame.hands[i]){\n          continue;\n        }\n\n        Leap.vec3.lerp(\n          hand[prop],\n          currentFrame.hands[i][prop],\n          nextFrame.hands[i][prop],\n          t\n        );\n\n//        console.assert(hand[prop]);\n      }\n\n    }\n\n    for ( i = 0; i < numPointables; i++){\n      pointable = frameData.pointables[i];\n\n      for ( j = 0; j < len2; j++){\n        prop = fingerProps[j];\n\n        if (!currentFrame.pointables[i][prop]){\n          continue;\n        }\n\n        if (!nextFrame.hands[i]){\n          continue;\n        }\n\n        Leap.vec3.lerp(\n          pointable[prop],\n          currentFrame.pointables[i][prop],\n          nextFrame.pointables[i][prop],\n          0\n        );\n//          console.assert(t >= 0 && t <= 1);\n//          if (t > 0) debugger;\n\n      }\n\n    }\n\n    return frameData;\n  },\n\n  // returns ms\n  timeToNextFrame: function () {\n    var elapsedTime = (this.nextFrame().timestamp - this.currentFrame().timestamp) / 1000;\n    if (elapsedTime < 0) {\n      elapsedTime = this.timeBetweenLoops; //arbitrary pause at slightly less than 30 fps.\n    }\n//    console.assert(!isNaN(elapsedTime));\n    return elapsedTime;\n  },\n\n\n  blank: function(){\n    return this.frameData.length === 0;\n  },\n\n  // sets the crop-point of the current recording to the current position.\n  leftCrop: function () {\n    this.leftCropPosition = this.frameIndex\n  },\n\n  // sets the crop-point of the current recording to the current position.\n  rightCrop: function () {\n    this.rightCropPosition = this.frameIndex\n  },\n\n  // removes every other frame from the array\n  // Accepts an optional `factor` integer, which is the number of frames\n  // discarded for every frame kept.\n  cullFrames: function (factor) {\n    console.log('cull frames', factor);\n    factor || (factor = 1);\n    for (var i = 0; i < this.frameData.length; i++) {\n      this.frameData.splice(i, factor);\n    }\n    this.setMetaData();\n  },\n\n  // Returns the average frames per second of the recording\n  frameRate: function () {\n    if (this.frameData.length == 0) {\n      return 0\n    }\n    return this.frameData.length / (this.frameData[this.frameData.length - 1].timestamp - this.frameData[0].timestamp) * 1000000;\n  },\n\n  // returns frames without any circular references\n  croppedFrameData: function () {\n    return this.frameData.slice(this.leftCropPosition, this.rightCropPosition);\n  },\n\n\n  setMetaData: function () {\n\n    var newMetaData = {\n      formatVersion: 2,\n      generatedBy: 'LeapJS Playback 0.2.0',\n      frames: this.rightCropPosition - this.leftCropPosition,\n      protocolVersion: this.options.requestProtocolVersion,\n      serviceVersion: this.options.serviceVersion,\n      frameRate: this.frameRate().toPrecision(2),\n      modified: (new Date).toString()\n    };\n\n    this.metadata || (this.metadata = {});\n\n    for (var key in newMetaData) {\n      this.metadata[key] = newMetaData[key];\n    }\n  },\n\n  // returns an array\n  // the first item is the keys of the following items\n  // nested arrays are expected to have idententical siblings\n  packedFrameData: function(){\n    var frameData = this.croppedFrameData(),\n      packedFrames = [],\n      frameDatum;\n\n    packedFrames.push(this.packingStructure);\n\n    for (var i = 0, len = frameData.length; i < len; i++){\n      frameDatum = frameData[i];\n\n      packedFrames.push(\n        this.packArray(\n          this.packingStructure,\n          frameDatum\n        )\n      );\n\n    }\n\n    return packedFrames;\n  },\n\n  // recursive method\n  // creates a structure of frame data matching packing structure\n  // there may be an issue here where hands/pointables are wrapped in one more array than necessary\n  packArray: function(structure, data){\n    var out = [], nameOrHash;\n\n    for (var i = 0, len1 = structure.length; i < len1; i++){\n\n      // e.g., nameOrHash is either 'id' or {hand: [...]}\n      nameOrHash = structure[i];\n\n      if ( typeof  nameOrHash === 'string'){\n\n        out.push(\n          data[nameOrHash]\n        );\n\n      }else if (Object.prototype.toString.call(nameOrHash) == \"[object Array]\") {\n        // nested array, such as hands or fingers\n\n        for (var j = 0, len2 = data.length; j < len2; j++){\n          out.push(\n            this.packArray(\n              nameOrHash,\n              data[j]\n            )\n          );\n        }\n\n      } else { // key-value (nested object) such as interactionBox\n\n//        console.assert(nameOrHash);\n\n        for (var key in nameOrHash) break;\n\n//        console.assert(key);\n//        console.assert(nameOrHash[key]);\n//        console.assert(data[key]);\n\n        out.push(this.packArray(\n          nameOrHash[key],\n          data[key]\n        ));\n\n      }\n\n    }\n\n    return out;\n  },\n\n  // expects the first array element to describe the following arrays\n  // this algorithm copies frames to a new array\n  // could there be merit in something which would do an in-place substitution?\n  unPackFrameData: function(packedFrames){\n    var packingStructure = packedFrames[0];\n    var frameData = [],\n        frameDatum;\n\n    for (var i = 1, len = packedFrames.length; i < len; i++) {\n      frameDatum = packedFrames[i];\n      frameData.push(\n        this.unPackArray(\n          packingStructure,\n          frameDatum\n        )\n      );\n\n    }\n\n    return frameData;\n  },\n\n  // data is a frame or subset of frame\n  // returns a frame object\n  // this is the structure of the array\n  // gets unfolded to key-value pairs\n  // e.g.:\n  //  this.packingStructure = [\n  //    'id',\n  //    'timestamp',\n  //    {hands: [[\n  //      'id',\n  //      'direction',\n  //      'palmNormal',\n  //      'palmPosition',\n  //      'palmVelocity'\n  //    ]]},\n  //    {pointables: [[\n  //      'direction',\n  //      'handId',\n  //      'length',\n  //      'stabilizedTipPosition',\n  //      'tipPosition',\n  //      'tipVelocity',\n  //      'tool'\n  //    ]]},\n  //    {interactionBox: [\n  //      'center', 'size'\n  //    ]}\n  //  ];\n  unPackArray: function(structure, data){\n    var out = {}, nameOrHash;\n\n    for (var i = 0, len1 = structure.length; i < len1; i++){\n\n     // e.g., nameOrHash is either 'id' or {hand: [...]}\n     nameOrHash = structure[i];\n\n     if ( typeof  nameOrHash === 'string'){\n\n       out[nameOrHash] = data[i];\n\n     }else if (Object.prototype.toString.call(nameOrHash) == \"[object Array]\") {\n       // nested array, such as hands or fingers\n       // nameOrHash [\"id\", \"direction\", \"palmNormal\", \"palmPosition\", \"palmVelocity\"]\n       // data [ [ 31, [vec3], [vec3], ...] ]\n\n       var subArray = [];\n\n       for (var j = 0, len2 = data.length; j < len2; j++){\n         subArray.push(\n           this.unPackArray(\n             nameOrHash,\n             data[j]\n           )\n         );\n       }\n       return subArray;\n\n     } else { // key-value (nested object) such as interactionBox\n\n       for (var key in nameOrHash) break;\n\n       out[key] = this.unPackArray(\n         nameOrHash[key],\n         data[i]\n       );\n\n     }\n\n    }\n\n    return out;\n  },\n\n  toHash: function () {\n    this.setMetaData();\n    return {\n      metadata: this.metadata,\n      frames: this.packedFrameData()\n    }\n  },\n\n  // Returns the cropped data as JSON or compressed\n  // http://pieroxy.net/blog/pages/lz-string/index.html\n  export: function (format) {\n    var json = JSON.stringify(this.toHash());\n\n    if (format == 'json') return json;\n\n    return LZString.compressToBase64(json);\n  },\n\n  save: function(format){\n    var filename;\n\n    filename = this.metadata.title ? this.metadata.title.replace(/\\s/g, '') : 'leap-playback-recording';\n\n    if (this.metadata.frameRate) {\n      filename += \"-\" + (Math.round(this.metadata.frameRate)) + \"fps\";\n    }\n\n    if (format === 'json') {\n\n      saveAs(new Blob([this.export('json')], {\n        type: \"text/JSON;charset=utf-8\"\n      }), filename + \".json\");\n\n    } else {\n\n      saveAs(new Blob([this.export('lz')], {\n        type: \"application/x-gzip;charset=utf-8\"\n      }),  filename + \".json.lz\");\n\n    }\n\n  },\n\n  decompress: function (data) {\n    return LZString.decompressFromBase64(data);\n  },\n\n  loaded: function(){\n    return !!(this.frameData && this.frameData.length)\n  },\n\n\n  // optional callback once frames are loaded, will have a context of player\n  loadFrameData: function (callback) {\n    var xhr = new XMLHttpRequest(),\n        url = this.url,\n        recording = this,\n        contentLength = 0;\n\n    xhr.onreadystatechange = function () {\n      if (xhr.readyState === xhr.DONE) {\n        if (xhr.status === 200 || xhr.status === 0) {\n          if (xhr.responseText) {\n\n            recording.finishLoad(xhr.responseText, callback);\n\n          } else {\n            console.error('Leap Playback: \"' + url + '\" seems to be unreachable or the file is empty.');\n          }\n        } else {\n          console.error('Leap Playback: Couldn\\'t load \"' + url + '\" (' + xhr.status + ')');\n        }\n      }\n    };\n\n    xhr.addEventListener('progress', function(oEvent){\n\n      if ( recording.options.loadProgress ) {\n\n        if (oEvent.lengthComputable) {\n          var percentComplete = oEvent.loaded / oEvent.total;\n          recording.options.loadProgress( recording, percentComplete, oEvent );\n        }\n\n      }\n\n    });\n\n    this.loading = true;\n\n    xhr.open(\"GET\", url, true);\n    xhr.send(null);\n  },\n\n  finishLoad: function(responseData, callback){\n\n    var url = this.url;\n\n    if (url.split('.')[url.split('.').length - 1] == 'lz') {\n      responseData = this.decompress(responseData);\n    }\n\n    responseData = JSON.parse(responseData);\n\n    if (responseData.metadata.formatVersion == 2) {\n      responseData.frames = this.unPackFrameData(responseData.frames);\n    }\n\n    this.metadata = responseData.metadata;\n\n    console.log('Recording loaded:', this.metadata);\n\n    this.loading = false;\n\n    if (callback) {\n      callback.call(this, responseData.frames);\n    }\n\n  },\n\n  loadCompressedRecording: function(compressedData, callback) {\n    var decompressedData = this.decompress(compressedData);\n    decompressedData = JSON.parse(decompressedData);\n    if (decompressedData.metadata.formatVersion == 2) {\n      decompressedData.frames = this.unPackFrameData(decompressedData.frames);\n    }\n\n    this.metadata = decompressedData.metadata;\n\n    console.log('Recording loaded:', this.metadata);\n\n    this.loading = false;\n\n    if (callback) {\n      callback.call(this, decompressedData.frames);\n    }\n  }\n\n};\n(function () {\n  var CONNECT_LEAP_ICON = '<img class=\"playback-connect-leap\" style=\"margin: 0px 2px -2px 0px; max-width: 100%;\" src=\"data:image/gif;base64,R0lGODlh9AHmAPf/AOnxtbS0tc3eVTMzNM3NztvnhtbX1/Hy86ioqezs7Z6entzd3r7UJdHhZcnKzOjo6sXZO319fkJCQurq6xMTFPj65q2treHh4vT42uXl5/Lz9JCQkfP09FxcXebm54yMjsvMzSgoKdfleLGxsUtLTPDx8cHCwlNTVSIiI6CgoYSEhAUFBpmZmtHS1Li5ucHDxNHR0err7HZ2duDrl8XFxvP09vv98/Dx8trb3MjIyN7e3x4eHmZmZj4+PrzTHtDQ0uvs7dra2uzt7ZWVldfY2cPExtbX2AsLDImJiff4+MbHysjIyoCBgsXGyHp6er6+vsDVKm5ucOTk5XFxc83O0MbGx2FhYm1tbsDWLKWlpu70xRkZGkVFRtPU1pydoM/Q0bKztKamqCQkJeLi5O/w8Glpab/AwtjY2f7+/WtrbcfIytjZ26qrrDc4OdHS0nBxc7/VJ5KTlI6Oj9LS0/v8/b7UI3JzdMPDxIqKi5aWl7y9vi4uL8fHx3BwcNvc3pKSk62usCsrLN/f4Ly8vZydnp2dndXV1snJycXGym5vcefn6IuMjYWFhYODhiMjJCYmJ+fo6UhISR8fH/7+/hsbHP39/ejo6cHWLu/v8Lq7vPv7++nq6+3u7q+wsby9wL6/wvj4+Pz8/Pr6+vLy8+bn6O7u7vj4+e3u7/f3+PT19fn5+ff39/T09Pb29+jo6MHWL/b29vLy8vT09e7v8L2+v/Pz9O7u7/39/vHy9L2+wbi6ve/v7+no6fz9/fn6+vj5+fv7/Pr7+////v7//8XGx/X19vX29vb39+7v7/z8/enp6uPk5fr6+/n5+g8PENTU1Hh4eYeHh05OT+fo6JGSk0BAQOTl6CAgIS8vML+/wHNzc5eYmLa3t+Xm54OEhfn4+Y+PkFdXV1hZWv3++IiIiJGRkZubm3t8ff7+/35/gOjp6ru8vmRkZMTFyLO0tWJiY6eoqycnKGxsbkNDQ77TIl5eX6Kjo+Xm6QcHBwgICZSUlvLz8y0tLv///wAAAP///yH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4zLWMwMTEgNjYuMTQ1NjYxLCAyMDEyLzAyLzA2LTE0OjU2OjI3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M2IChNYWNpbnRvc2gpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjQyMUExNDAzQjE2NzExRTNBMUE1RTA3Qjc0NDg0NDMxIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjQyMUExNDA0QjE2NzExRTNBMUE1RTA3Qjc0NDg0NDMxIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NDIxQTE0MDFCMTY3MTFFM0ExQTVFMDdCNzQ0ODQ0MzEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NDIxQTE0MDJCMTY3MTFFM0ExQTVFMDdCNzQ0ODQ0MzEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4B//79/Pv6+fj39vX08/Lx8O/u7ezr6uno5+bl5OPi4eDf3t3c29rZ2NfW1dTT0tHQz87NzMvKycjHxsXEw8LBwL++vby7urm4t7a1tLOysbCvrq2sq6qpqKempaSjoqGgn56dnJuamZiXlpWUk5KRkI+OjYyLiomIh4aFhIOCgYB/fn18e3p5eHd2dXRzcnFwb25tbGtqaWhnZmVkY2JhYF9eXVxbWllYV1ZVVFNSUVBPTk1MS0pJSEdGRURDQkFAPz49PDs6OTg3NjU0MzIxMC8uLSwrKikoJyYlJCMi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\">';\n  var MOVE_HAND_OVER_LEAP_ICON = '<img class=\"playback-move-hand\" style=\"margin: 0px 2px -2px 0px; max-width: 100%;\" src=\"data:image/gif;base64,R0lGODlh9AHtAPf/AJ2dnfT09KWlpZWVlejo6bGxsRwcHHl5eYmJiRMTFOrq66GhoYWFhcHCxObm54GBgdjY2GFhYcXGydPT0+Dg4OPj4319fQsLC0ZGRuTk5GlpaVVVVV5eXpGRkXFxcd7e3kFBQXV1ddbW1lJSUsDAwNvb221tbk1OTgMDAykpKaurqzw9PdTU1FlZWdzc3JiYmMjKzLu7u8jIyJubnPLy9M7Ozr2/wUlJSTo6OsLCwmRkZDY2NtDQ0DIyMr29vaytsKysrC4uLra2ttHS1CUlJtXX2MrKy6+vr5qamiEhIczMzM3O0LS0tMTExMbGxsbIyt7e4I2Njby8vOTl5qioqMPEx+rr7KqqrOjo6np6fNTV17i4uMzNzo+Pj3Z3ePHx8rm7veDh4uzt7r/AwoeHh8PDxM/Q0sTFx42OkMDBw+fo6bW3utjZ2vHy8tHR0sjJyru8v+Xl5d3d3dzc3mNjZJ+fn2pra+np6t/f4OLj5NPT1V9fYFdXV8HCxsDBxbO0tq6vsqqsrk9PT0tLS5KTlGdnZ4uMjn1+gHd4e1JTUzs7PEJCQzMzMysrK+fn6P7+/v////39/fPz8+7u7/z8/Pv7+/f39/b29vr6+vj4+Pn5+e7u7vLy8u/v7+3t7ezs7PDw8Ozs7fHx8fDw8fb29/Ly8/X19fr6+/z8/fn5+tvc3e/v8HNzdKmpqvf3+CMjJPDx8fP09OPk5ZmZmvj5+Xt8flBQUP39/mtsbvLz8+/w8Nra3NXW15+govr7+x8fH7m5uicnJ+fn6ezt7Zqcn7Kzs7S0s1hYWLe4uvz9/aanqq2trf3+/ouLi2NkZqOjo5aXmqKkppeYmmBgYPv7/JSVl4ODg4eHihcXFw8PD/7//9HS0kBAQOHh4mhoa0RERDAwMPf4+AcHB+vr7NfX11xcXKenp5manJqameXm6ExMTcjHyfv8/G9vb/j4+UdHRywsLHN0dj4+PsrLzTQ0NObm6Obn6efm6Ly9v39/fzc4OL2+v+3s7fb39wAAAP///yH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4zLWMwMTEgNjYuMTQ1NjYxLCAyMDEyLzAyLzA2LTE0OjU2OjI3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M2IChNYWNpbnRvc2gpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjQyMUExNDA3QjE2NzExRTNBMUE1RTA3Qjc0NDg0NDMxIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjQyMUExNDA4QjE2NzExRTNBMUE1RTA3Qjc0NDg0NDMxIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NDIxQTE0MDVCMTY3MTFFM0ExQTVFMDdCNzQ0ODQ0MzEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NDIxQTE0MDZCMTY3MTFFM0ExQTVFMDdCNzQ0ODQ0MzEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4B//79/Pv6+fj39vX08/Lx8O/u7ezr6uno5+bl5OPi4eDf3t3c29rZ2NfW1dTT0tHQz87NzMvKycjHxsXEw8LBwL++vby7urm4t7a1tLOysbCvrq2sq6qpqKempaSjoqGgn56dnJuamZiXlpWUk5KRkI+OjYyLiomIh4aFhIOCgYB/fn18e3p5eHd2dXRzcnFwb25tbGtqaWhnZmVkY2JhYF9eXVxbWllYV1ZVVFNSUVBPTk1MS0pJSEdGRURDQkFAPz49PDs6OTg3NjU0MzIxMC8uLSwrKikoJyYlJCMi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\" />';\n\n\n  function Player(controller, options) {\n    var player = this;\n    options || (options = {});\n\n//    this.frameData = [];\n\n    this.options = options;\n    this.recording = options.recording;\n\n    this.controller = controller;\n    this.resetTimers();\n    this.setupLoops();\n    this.controller.connection.on('ready', function () {\n      player.setupProtocols();\n    });\n\n    this.userHasControl = false;\n\n\n    if (options.recording) {\n      if (Object.prototype.toString.call(options.recording) == '[object String]') {\n        options.recording = {\n          url: options.recording\n        }\n      }\n      this.setRecording(options.recording);\n    }\n\n    document.addEventListener(\"DOMContentLoaded\", function(event) {\n      document.body.addEventListener('keydown', function (e) {\n        if (e.which === player.options.pauseHotkey) {\n          player.toggle();\n        }\n      }, false);\n    });\n\n  }\n\n  Player.prototype = {\n    resetTimers: function (){\n      this.timeSinceLastFrame = 0;\n      this.lastFrameTime = null;\n    },\n\n    setupLoops: function () {\n      var player = this;\n\n      // Loop with explicit frame timing\n      this.stepFrameLoop = function (timestamp) {\n        if (player.state != 'playing') return;\n\n        player.sendFrameAt(timestamp || performance.now());\n\n        requestAnimationFrame(player.stepFrameLoop);\n      };\n\n\n    },\n\n    // This is how we intercept frame data early\n    // By hooking in before Frame creation, we get data exactly as the frame sends it.\n    setupProtocols: function () {\n      var player = this;\n      // This is the original normal protocol, used while in record mode but not recording.\n      this.stopProtocol = this.controller.connection.protocol;\n\n      // This consumes all frame data, making the device act as if not streaming\n      this.playbackProtocol = function (data) {\n        // The old protocol still needs to emit events, so we use it, but intercept Frames\n        var eventOrFrame = player.stopProtocol(data);\n        if (eventOrFrame instanceof Leap.Frame) {\n\n          if (player.pauseOnHand) {\n            if (data.hands.length > 0) {\n              player.userHasControl = true;\n              player.controller.emit('playback.userTakeControl');\n              player.setGraphic();\n              player.idle();\n            } else if (data.hands.length == 0) {\n              if (player.userHasControl && player.resumeOnHandLost) {\n                player.userHasControl = false;\n                player.controller.emit('playback.userReleaseControl');\n                player.setGraphic('wave');\n              }\n\n            }\n          }\n\n          // prevent the actual frame from getting through\n          return {type: 'playback'}\n        } else {\n          return eventOrFrame;\n        }\n      };\n\n      // This pushes frame data, and watches for hands to auto change state.\n      // Returns the eventOrFrame without modifying it.\n      this.recordProtocol = function (data) {\n        var eventOrFrame = player.stopProtocol(data);\n        if (eventOrFrame instanceof Leap.Frame) {\n          player.recordFrameHandler(data);\n        }\n        return eventOrFrame;\n      };\n\n      // Copy methods/properties from the default protocol over\n      for (var property in this.stopProtocol) {\n        if (this.stopProtocol.hasOwnProperty(property)) {\n          this.playbackProtocol[property] = this.stopProtocol[property]\n          this.recordProtocol[property] = this.stopProtocol[property]\n        }\n      }\n\n      // todo: this is messy. Should cover all cases, not just active playback!\n      if (this.state == 'playing') {\n        this.controller.connection.protocol = this.playbackProtocol\n      }\n    },\n\n\n\n    // Adds playback = true to artificial frames\n    sendFrameAt: function (now) {\n\n      if (this.lastFrameTime){\n        // chrome bug, see: https://code.google.com/p/chromium/issues/detail?id=268213\n        // http://jsfiddle.net/pehrlich/35pTx/\n        // console.assert(this.lastFrameTime < now);\n        if (now < this.lastFrameTime){\n          // this fix will cause an extra animation frame before the lerp frame advances. no big.\n          this.lastFrameTime = now;\n        }else{\n          this.timeSinceLastFrame += (now - this.lastFrameTime);\n        }\n      }\n\n      this.lastFrameTime = now;\n\n//      console.assert(!isNaN(this.timeSinceLastFrame));\n\n\n      var timeToNextFrame;\n\n      // handle frame dropping, etc\n      while ( this.timeSinceLastFrame > ( timeToNextFrame = this.recording.timeToNextFrame() ) ){\n        this.timeSinceLastFrame -= timeToNextFrame;\n        if (!this.recording.advanceFrame()){\n          this.pause();\n          this.controller.emit('playback.playbackFinished', this);\n          return\n        }\n      }\n\n      this.sendFrame(\n        this.recording.createLerpFrameData(this.timeSinceLastFrame / timeToNextFrame)\n      );\n\n    },\n\n    sendFrame: function(frameData){\n      if (!frameData) throw \"Frame data not provided\";\n\n      var frame = new Leap.Frame(frameData);\n\n      // send a deviceFrame to the controller:\n      // this frame gets picked up by the controllers own animation loop.\n\n      this.controller.processFrame(frame);\n      return true\n    },\n\n    sendImmediateFrame: function(frameData){\n      if (!frameData) throw \"Frame data not provided\";\n\n      var frame = new Leap.Frame(frameData);\n\n      // sends an animation frame to the controller\n\n      this.controller.processFinishedFrame(frame);\n      return true\n    },\n\n    setFrameIndex: function (frameIndex) {\n      if (frameIndex != this.recording.frameIndex) {\n        this.recording.frameIndex = frameIndex % this.recording.frameCount;\n        this.sendFrame(this.recording.currentFrame());\n      }\n    },\n\n\n    // used after record\n    stop: function () {\n      this.idle();\n\n      delete this.recording;\n\n      this.recording = new Recording({\n        timeBetweenLoops:       this.options.timeBetweenLoops,\n        loop:                   this.options.loop,\n        requestProtocolVersion: this.controller.connection.opts.requestProtocolVersion,\n        serviceVersion:         this.controller.connection.protocol.serviceVersion\n      });\n\n      this.controller.emit('playback.stop', this);\n    },\n\n    // used after play\n    pause: function () {\n      // todo: we should change this idle state to paused or leave it as playback with a pause flag\n      // state should correspond always to protocol handler (through a setter)?\n      this.state = 'idle';\n      this.hideOverlay();\n      this.controller.emit('playback.pause', this);\n    },\n\n    idle: function () {\n      this.state = 'idle';\n      this.controller.connection.protocol = this.stopProtocol;\n    },\n\n    toggle: function () {\n      if (this.state == 'idle') {\n        this.play();\n      } else if (this.state == 'playing') {\n        this.pause();\n      }\n    },\n\n    // switches to record mode, which will be begin capturing data when a hand enters the frame,\n    // and stop when a hand leaves\n    // Todo: replace frameData with a full fledged recording, including metadata.\n    record: function () {\n      this.clear();\n      this.stop();\n      this.state = 'recording';\n      this.controller.connection.protocol = this.recordProtocol;\n      this.setGraphic('connect');\n      this.controller.emit('playback.record', this)\n    },\n\n    // if there is existing frame data, sends a frame with nothing in it\n    clear: function () {\n      if (!this.recording || this.recording.blank()) return;\n      var finalFrame = this.recording.cloneCurrentFrame();\n      finalFrame.hands = [];\n      finalFrame.fingers = [];\n      finalFrame.pointables = [];\n      finalFrame.tools = [];\n      this.sendImmediateFrame(finalFrame);\n    },\n\n    recordPending: function () {\n      return this.state == 'recording' && this.recording.blank()\n    },\n\n    isRecording: function () {\n      return this.state == 'recording' && !this.recording.blank()\n    },\n\n    finishRecording: function () {\n      // change to the playbackHandler which suppresses frames:\n      this.controller.connection.protocol = this.playbackProtocol;\n      this.recording.setFrames(this.recording.frameData);\n      this.controller.emit('playback.recordingFinished', this)\n    },\n\n\n    loaded: function () {\n      return this.recording.loaded();\n    },\n\n    loading: function(){\n      return this.recording.loading;\n    },\n\n\n    /* Plays back the provided frame data\n     * Params {object|boolean}:\n     *  - frames: previously recorded frame json\n     * - loop: whether or not to loop playback.  Defaults to true.\n     */\n    play: function () {\n      if (this.state === 'playing') return;\n      if ( this.loading() || this.recording.blank() ) return;\n\n      this.state = 'playing';\n      this.controller.connection.protocol = this.playbackProtocol;\n\n      var player = this;\n\n      // prevent the normal controller response while playing\n      this.controller.connection.removeAllListeners('frame');\n      this.controller.connection.on('frame', function (frame) {\n        // resume play when hands are removed:\n        if (player.resumeOnHandLost && player.autoPlay && player.state == 'idle' && frame.hands.length == 0) {\n          player.play();\n        }\n\n        // The default LeapJS callback processes the frame, which is what we do now:\n        player.controller.processFrame(frame);\n      });\n\n      // Kick off\n      this.resetTimers();\n      this.recording.readyPlay();\n      this.stepFrameLoop();\n\n      this.controller.emit('playback.play', this);\n    },\n\n    // this method replaces connection.handleData when in record mode\n    // It accepts the raw connection data which is used to make a frame.\n    recordFrameHandler: function (frameData) {\n      // Would be better to check controller.streaming() in showOverlay, but that method doesn't exist, yet.\n      this.setGraphic('wave');\n      if (frameData.hands.length > 0) {\n        this.recording.addFrame(frameData);\n        this.hideOverlay();\n      } else if ( !this.recording.blank() ) {\n        this.finishRecording();\n      }\n    },\n\n\n    // Accepts a hash with any of\n    // URL, recording, metadata, compressedRecording\n    // once loaded, the recording is immediately activated\n    setRecording: function (options) {\n      var player = this;\n\n      // otherwise, the animation loop may try and play non-existant frames:\n      this.pause();\n\n      // this is called on the context of the recording\n      var loadComplete = function (frames) {\n\n        this.setFrames(frames);\n\n        if (player.recording != this){\n          console.log('recordings changed during load');\n          return\n        }\n\n        if (player.autoPlay) {\n          player.play();\n          if (player.pauseOnHand && !player.controller.streaming() ) {\n            player.setGraphic('connect');\n          }\n        }\n\n        player.controller.emit('playback.recordingSet', this);\n      };\n\n      this.recording = options;\n\n      // Here we turn the existing argument in to a recording\n      // this allows frames to be added to the existing object via ajax\n      // saving ajax requests\n      if (!(options instanceof Recording)){\n\n        this.recording.__proto__ = Recording.prototype;\n        Recording.call(this.recording, {\n          timeBetweenLoops: this.options.timeBetweenLoops,\n          loop:             this.options.loop,\n          loadProgress: function(recording, percentage, oEvent){\n            player.controller.emit('playback.ajax:progress', recording, percentage, oEvent);\n          }\n        });\n\n      }\n\n\n      if ( this.recording.loaded() ) {\n\n        loadComplete.call(this.recording, this.recording.frameData);\n\n      } else if (options.url) {\n\n        this.controller.emit('playback.ajax:begin', this, this.recording);\n\n        // called in the context of the recording\n        this.recording.loadFrameData(function(frames){\n          loadComplete.call(this, frames);\n          player.controller.emit('playback.ajax:complete', player, this);\n        });\n\n      } else if (options.compressedRecording) {\n        this.recording.loadCompressedRecording(options.compressedRecording, function(frames){\n          loadComplete.call(this, frames);\n        });\n      }\n\n\n      return this;\n    },\n\n\n    hideOverlay: function () {\n      if (!this.overlay) return;\n      this.overlay.style.display = 'none';\n    },\n\n\n    // Accepts either \"connect\", \"wave\", or undefined.\n    setGraphic: function (graphicName) {\n      if (!this.overlay) return;\n      if (this.graphicName == graphicName) return;\n\n      this.graphicName = graphicName;\n      switch (graphicName) {\n        case 'connect':\n          this.overlay.style.display = 'block';\n          this.overlay.innerHTML = CONNECT_LEAP_ICON;\n          break;\n        case 'wave':\n          this.overlay.style.display = 'block';\n          this.overlay.innerHTML = MOVE_HAND_OVER_LEAP_ICON;\n          break;\n        case undefined:\n          this.overlay.innerHTML = '';\n          break;\n      }\n    }\n\n  };\n\n  // will only play back if device is disconnected\n  // Accepts options:\n  // - frames: [string] URL of .json frame data\n  // - autoPlay: [boolean true] Whether to turn on and off playback based off of connection state\n  // - overlay: [boolean or DOM element] Whether or not to show the overlay: \"Connect your Leap Motion Controller\"\n  //            if a DOM element is passed, that will be shown/hidden instead of the default message.\n  // - pauseOnHand: [boolean true] Whether to stop playback when a hand is in field of view\n  // - resumeOnHandLost: [boolean true] Whether to resume playback after the hand leaves the frame\n  // - requiredProtocolVersion: clients connected with a lower protocol number will not be able to take control of the\n  // - timeBetweenLoops: [number, ms] delay between looping playback\n  // controller with their device.  This option, if set, ovverrides autoPlay\n  // - pauseHotkey: [number or false, default: 32 (spacebar)] - keycode for pause, bound to body\n  var playback = function (scope) {\n    var controller = this;\n    var autoPlay = scope.autoPlay;\n    if (autoPlay === undefined) autoPlay = true;\n\n    var pauseOnHand = scope.pauseOnHand;\n    if (pauseOnHand === undefined) pauseOnHand = true;\n\n    var resumeOnHandLost = scope.resumeOnHandLost;\n    if (resumeOnHandLost === undefined) resumeOnHandLost = true;\n\n    var timeBetweenLoops = scope.timeBetweenLoops;\n    if (timeBetweenLoops === undefined) timeBetweenLoops = 50;\n\n    var requiredProtocolVersion = scope.requiredProtocolVersion;\n\n    var pauseHotkey = scope.pauseHotkey;\n    if (pauseHotkey === undefined) pauseHotkey = 32; // spacebar\n\n    var loop = scope.loop;\n    if (loop === undefined) loop = true;\n\n    var overlay = scope.overlay;\n    // A better fix would be to set an onload handler for this, rather than disable the overlay.\n    if (overlay === undefined && document.body) {\n      overlay = document.createElement('div');\n      document.body.appendChild(overlay);\n      overlay.style.width = '100%';\n      overlay.style.position = 'absolute';\n      overlay.style.top = '0';\n      overlay.style.left = '-' + window.getComputedStyle(document.body).getPropertyValue('margin');\n      overlay.style.padding = '10px';\n      overlay.style.textAlign = 'center';\n      overlay.style.fontSize = '18px';\n      overlay.style.opacity = '0.8';\n      overlay.style.display = 'none';\n      overlay.style.zIndex = '10';\n      overlay.id = 'connect-leap';\n      overlay.style.cursor = 'pointer';\n      overlay.addEventListener(\"click\", function () {\n        this.style.display = 'none';\n        return false;\n      }, false);\n\n    }\n\n\n    scope.player = new Player(this, {\n      recording: scope.recording,\n      loop: loop,\n      pauseHotkey: pauseHotkey,\n      timeBetweenLoops: timeBetweenLoops\n    });\n\n    // By doing this, we allow player methods to be accessible on the scope\n    // this is the controller\n    scope.player.overlay = overlay;\n    scope.player.pauseOnHand = pauseOnHand;\n    scope.player.resumeOnHandLost = resumeOnHandLost;\n    scope.player.requiredProtocolVersion = requiredProtocolVersion;\n    scope.player.autoPlay = autoPlay;\n\n    var setupStreamingEvents = function () {\n      if (scope.player.pauseOnHand && controller.connection.opts.requestProtocolVersion < scope.requiredProtocolVersion) {\n        console.log('Protocol Version too old (' + controller.connection.opts.requestProtocolVersion + '), disabling device interaction.');\n        scope.player.pauseOnHand = false;\n        return\n      }\n\n      if (autoPlay) {\n        controller.on('streamingStarted', function () {\n          if (scope.player.state == 'recording') {\n            scope.player.pause();\n            scope.player.setGraphic('wave');\n          } else {\n            if (pauseOnHand) {\n              scope.player.setGraphic('wave');\n            } else {\n              scope.player.setGraphic();\n            }\n          }\n        });\n\n        controller.on('streamingStopped', function () {\n          scope.player.play();\n        });\n      }\n      controller.on('streamingStopped', function () {\n        scope.player.setGraphic('connect');\n      });\n    }\n\n    // ready happens before streamingStarted, allowing us to check the version before responding to streamingStart/Stop\n    // we can't call this any earlier, or protcol version won't be available\n    if (!!this.connection.connected) {\n      setupStreamingEvents()\n    } else {\n      this.on('ready', setupStreamingEvents)\n    }\n\n    return {}\n  }\n\n\n  if ((typeof Leap !== 'undefined') && Leap.Controller) {\n    Leap.Controller.plugin('playback', playback);\n  } else if (typeof module !== 'undefined') {\n    module.exports.playback = playback;\n  } else {\n    throw 'leap.js not included';\n  }\n\n}).call(this);\n}( window ));"]},"metadata":{},"sourceType":"script"}